import{P as y,j as t,R as D,h as U,u as L,r as m,Y as I,b as k,c as S,L as F,Z as H,_ as $,T as M,a as K,$ as N,a0 as V,a1 as T,C as Y,B as q,x as w,a2 as E,v as J,w as Q,a3 as z}from"./index-cb7bfd5e.js";import{B as Z}from"./Breadcrumb-6338c30f.js";import{E as X,T as ee}from"./ExportExcelDatis-1a5e3c7f.js";import{f as _}from"./changeTimeIndo-f11d9ea6.js";const O=s=>{const{title:c,text:r,iconClass:l,color:o,onClick:d}=s;return t.jsx(D.Fragment,{children:t.jsx("div",{className:"card shadow-sm rounded-3 border-bottom-3 bg-white py-2 ",style:{borderBottom:"3px solid #000000",transition:"transform 0.2s",height:"75%",borderColor:o},children:t.jsxs("div",{className:"card-body",children:[t.jsx("div",{className:"row",children:t.jsxs("div",{className:"d-flex align-items-center px-1",children:[t.jsx("div",{className:"bg-opacity-25 p-1 rounded-3 d-flex justify-content-center align-items-center",style:{backgroundColor:o},children:t.jsx("i",{className:`${l} fs-3 text-white`})}),t.jsx("h5",{className:"fs-md-5 fs-6 ms-2",children:c})]})}),t.jsx("p",{className:"card-text text-muted mt-1 fw-bold fs-4",children:r})]})})})};O.propTypes={iconClass:y.string,text:y.string,title:y.string,color:y.string};const te=[{title:"TOTAL USER TERDAFTAR",text:"0",color:"#FF9F43",status:1,iconClass:"bx bx-user-pin"},{title:"TOTAL USER AKTIVITAS",text:"0",color:"#009FBD",status:2,iconClass:"bx bxs-user-voice"},{title:"TOTAL PENGUNJUNG",text:"0",color:"#2BC428",status:3,iconClass:"bx bx-user-check"},{title:"TOTAL PENGUNJUNG SAAT INI",text:"0",color:"#F5004F",status:4,iconClass:"bx bxs-user-plus"}],se=[{id:"fullname",name:"NAMA",selector:s=>s.fullname||"-",isText:!0},{id:"username",name:"USERNAME",selector:s=>s.username||"-",isText:!0},{id:"email",name:"EMAIL",selector:s=>s.email||"-"},{id:"wilayah_prov_text",name:"Wilayah Prov",selector:s=>s.wilayah_prov_text||"-"},{id:"wilayah_kab_text",name:"Wilayah Kab",selector:s=>s.wilayah_kab_text||"-"},{id:"eselon_1_text",name:"ESELON I",selector:s=>s.eselon_1_text||"-"},{id:"eselon_2_text",name:"ESELON II",selector:s=>s.eselon_2_text||"-"},{id:"modules_code_text",name:"MODUL",selector:s=>s.modules_code_text||"-"},{id:"roles_code_text",name:"ROLE",selector:s=>s.roles_code_text||"-"},{id:"created_on",name:"TANGGAL DIBUAT",selector:s=>formatDateToIndonesian(s.created_on)||"-"},{id:"created_by",name:"DIBUAT OLEH",selector:s=>s.created_by||"-",isText:!0},{id:"updated_on",name:"TANGGAL DIUBAH",selector:s=>formatDateToIndonesian(s.updated_on)||"-"},{id:"updated_by",name:"DIUBAH OLEH",selector:s=>s.updated_by||"-",isText:!0},{id:"valid",name:"STATUS",selector:s=>s.valid==1?"Aktif":"Tidak Aktif"}],ae={rows:{style:{minHeight:"30px","&:nth-of-type(odd)":{backgroundColor:"#f3f3f3"},"&:nth-of-type(even)":{backgroundColor:"#ffffff"}}},headCells:{style:{backgroundColor:"#2A3042",fontSize:"12px",fontWeight:"bold",color:"white",margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"160px",maxWidth:"160px"}},cells:{style:{padding:"8px 16px"}}},ne=({filter:s,setFilter:c,clickSearch:r})=>{const{list_dropdown_roles:l}=U(a=>a.Usman),o=L();m.useEffect(()=>{o(I())},[]);const d=m.useMemo(()=>{var a;return Array.from(new Map((a=l==null?void 0:l.data)==null?void 0:a.map(i=>[i.code,i])).values())},[l]);return t.jsx("div",{className:"p-2 rounded bg-secondary-subtle",children:t.jsx(k,{children:t.jsxs(S,{md:6,lg:4,children:[t.jsx(F,{htmlFor:"validationCustom01",className:"col-form-label py-0",children:"Nama Role"}),t.jsx(H,{name:"roles_code",placeholder:"Nama Role",getOptionValue:a=>a.code,getOptionLabel:a=>a.title,onChange:a=>{c({...s,roles_code:a}),r(a)},options:d,className:"select2-selection",styles:$,isClearable:!0})]})})})},A=new M,ie=async({fetchData:s,query:c,refExport:r,defLimit:l=1e3,getResult:o,injectQuery:d})=>{if(!o&&!await A.confirmationDownloadData())return;A.customShowLoading({msg:"Sedang Menyiapkan Data..."});const a={...c,limit:l},i=await s({...a,...d});let u=[...i.data];const f=i.total_count,h=Number(a.limit),x=Math.ceil(f/h);for(let p=2;p<=x;p++){const b={...a,page:String(p)},v=await s({...b,...d});u=[...u,...v.data]}if(o)return A.close(),u;r.current.downloadExcel(u),A.close()},le=[{link:"/",label:"Beranda"},{link:"/user-management/tabel-user",label:"User Management"},{link:"/",label:"Dashboard User Management"}],me=()=>{const s=L(),[c,r]=m.useState({limit:10,page:1}),[l,o]=m.useState({}),d=m.useRef(null),a=K(),[i,u]=m.useState({}),f=async e=>{try{return await z(e)}catch(n){w(n)}},h=async e=>{try{x.showLoading();const n=await f(e);u(n)}catch(n){w(n)}finally{x.close()}},x=new M,p=()=>{ie({fetchData:f,query:c,refExport:d})},{active_user:b}=U(e=>e.Usman),v=te.map(e=>{var n,g,j,C;return e.status===1?{...e,text:N((n=b.data)==null?void 0:n.total_users.toString())||0}:e.status===2?{...e,text:N((g=b.data)==null?void 0:g.session_active.toString())||0}:e.status===3?{...e,text:N((j=b.data)==null?void 0:j.total_visitor.toString())||0}:e.status===4?{...e,text:N((C=b.data)==null?void 0:C.online_visitor.toString())||0}:e}),R=async e=>{if(!await x.confirmSubmit(`Apakah Anda Yakin ${e!=null&&e.valid?"Mengaktifkan":"Menonaktifkan"} Data Ini?`,"Saya Yakin"))return;const g=E({id:e==null?void 0:e.id,deleted:0,valid:+(e==null?void 0:e.valid)?0:1});try{x.showLoading(),await J(g),Q(`Sukses ${e!=null&&e.valid?"Mengaktifkan":"Menonaktifkan"} Data`),h({})}catch(j){w(j)}finally{x.close()}},W=e=>{a("/user-management/user/change-pwd/"+e.id,{state:{username:e.username}})};m.useEffect(()=>{s(I()),h({}),s(V())},[]);const B=m.useMemo(()=>[{name:t.jsx("div",{className:"fw-semibold ",children:"AKSI"}),minWidth:"150px",cell:e=>t.jsxs("div",{className:"d-flex column-gap-2",children:[t.jsx(T,{title:"Edit",placement:"top",children:t.jsx("div",{onClick:()=>a(`/user-management/edit/${e.id}`),className:"rounded cursor-pointer bg-warning p-1",children:t.jsx("i",{className:"bx bx-edit text-white fs-3"})})}),t.jsx(T,{title:`${+(e==null?void 0:e.valid)?"Blokir Akun":"Pengaktifan Akun"}`,placement:"top",children:t.jsx("div",{onClick:()=>R(e),className:`rounded cursor-pointer ${+(e==null?void 0:e.valid)?"bg-danger":"bg-success"} p-1`,children:t.jsx("i",{className:`bx ${+(e==null?void 0:e.valid)?"bx-block":"bxs-badge-check"} text-white fs-4`})})}),t.jsx(T,{title:"Ubah Password",placement:"top",children:t.jsx("div",{onClick:()=>W(e),className:"rounded cursor-pointer bg-primary p-1",children:t.jsx("i",{className:"bx bx-key text-white fs-3"})})})]}),ignoreRowClick:!0,allowOverflow:!0,button:!0},{name:t.jsx("div",{className:"fw-semibold ",children:"NAMA"}),minWidth:"150px",selector:e=>e.fullname||"-",sortable:!0,cell:e=>t.jsx("div",{children:e.fullname||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"USERNAME"}),minWidth:"150px",selector:e=>e.username||"-",sortable:!0,cell:e=>t.jsx("div",{children:e.username||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"AKSES MODUL"}),width:"350px",selector:e=>e.modules_code_text||"-",cell:e=>t.jsx("div",{children:e.modules_code_text||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"ROLE"}),minWidth:"150px",selector:e=>e.roles_code_text||"-",cell:e=>t.jsx("div",{children:e.roles_code_text||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"TANGGAL DIBUAT"}),minWidth:"150px",selector:e=>_(e.created_on)||"-",cell:e=>t.jsx("div",{children:_(e.created_on)||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"DIBUAT OLEH"}),minWidth:"150px",selector:e=>e.created_by||"-",cell:e=>t.jsx("div",{children:e.created_by||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"TANGGAL DIUBAH"}),minWidth:"150px",selector:e=>_(e.updated_on)||"-",cell:e=>t.jsx("div",{children:_(e.updated_on)||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"DIUBAH OLEH"}),minWidth:"150px",selector:e=>e.updated_by||"-",cell:e=>t.jsx("div",{children:e.updated_by||"-"})},{name:t.jsx("div",{className:"fw-semibold ",children:"STATUS AKUN"}),minWidth:"150px",sortable:!0,selector:e=>e.valid,cell:e=>t.jsx("div",{className:`px-2 py-1 rounded-3 bg-opacity-50 fw-bold ${e.valid==1?"bg-success":"bg-danger"}`,style:{minWidth:"80px",maxWidth:"120px",textAlign:"center"},children:e.valid==1?"Aktif":"Diblokir"})},{name:t.jsx("div",{className:"fw-semibold ",children:"AKTIVITAS"}),minWidth:"150px",sortable:!0,selector:e=>e.online,cell:e=>t.jsx("div",{className:`px-2 py-1 rounded-3 bg-opacity-50 fw-semibold ${e.online==!0?" bg-success":"bg-danger"}`,style:{minWidth:"80px",maxWidth:"120px",textAlign:"center"},children:e.online==!0?"Online":"Offline"})}]),G=e=>{const n=E({r_roles_code:(e==null?void 0:e.code)||"",limit:10,page:1});r(n),h(n)},P=e=>{const n={...c,page:e};r(n),h(n)};return t.jsx(D.Fragment,{children:t.jsxs("div",{className:"page-content",children:[t.jsx(Z,{content:le,title:"Tabel User"}),t.jsxs(Y,{fluid:!0,children:[t.jsx(k,{children:t.jsx(S,{xl:"12",children:t.jsx(k,{children:v.map((e,n)=>t.jsx(S,{xs:"12",sm:"6",lg:"3",children:t.jsx(O,{title:e.title,text:e.text,color:e.color,iconClass:e.iconClass})},"_card_"+n))})})}),t.jsxs("div",{className:"shadow-md rounded-3 bg-white p-5 mb-5",children:[t.jsx(ne,{filter:l,setFilter:o,clickSearch:G}),t.jsxs("div",{className:"d-flex mt-4 mb-3 justify-content-between align-items-center",children:[t.jsx("div",{className:"fs-3 fw-semibold",children:"Data Tabel User"}),t.jsxs("div",{className:"pb-0 mb-0 d-flex column-gap-2",children:[t.jsx(q,{color:"primary",onClick:()=>a("/user-management/user/create"),children:"Tambah User"}),t.jsx("button",{type:"button",className:"btn btn-success shadow-lg",style:{minWidth:"150px",maxWidth:"150px",width:"150px"},onClick:p,children:"Export to Excel"}),t.jsx("div",{className:"d-none",children:t.jsx(X,{ref:d,name:"Data Table User - Excel",header:se})})]})]}),t.jsx(ee,{disSubHeader:!0,dataTotal:(i==null?void 0:i.total_count)||0,pagination:!0,customStyles:ae,data:(i==null?void 0:i.data)||[],columns:B,pageNow:P,selectedColumns:[],customClass:"pb-5"})]})]})]})})};export{me as default};
