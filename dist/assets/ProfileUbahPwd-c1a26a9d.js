import{p as k,q as p,r as n,a as y,A as B,j as s,R as P,n as S,o as F,s as U,b as m,L as u,N as h,I as x,B as b,O as w,Q as j,t as d,S as M,w as z,x as L,u as E,i as I,C as R}from"./index-d70a1868.js";import{M as T}from"./Modals-43a7b6ce.js";const $=k().shape({old_pass:p().required("Wajib Diisi Tidak Boleh Kosong"),new_pass:p().required("Wajib Diisi Tidak Boleh Kosong"),repassword:p().required("Wajib Diisi Tidak Boleh Kosong")}),q=()=>{const[l,v]=n.useState(!1),_=y(),N=n.useMemo(()=>JSON.parse(localStorage.getItem("userSession")).user_detail),a=B({enableReinitialize:!0,initialValues:{old_pass:"",new_pass:"",repassword:""},validationSchema:$,onSubmit:r=>{r.new_pass===r.repassword&&i()}}),i=()=>{v(!l),document.body.classList.add("no_padding")},f=async()=>{var g;i(),console.log("success");const r={username:N.username,old_pass:a.values.old_pass,new_pass:a.values.new_pass};try{const c=await M(r);console.log("res ",c),z("Sukses Mengganti Password, Harap Login Ulang"),setTimeout(()=>{_("/logout")},1e3)}catch(c){let o=(g=c.response)==null?void 0:g.data;o.error&&o.error==="parameter {old_pass} tidak sesuai"?o="Password Lama Tidak Sesuai":o=o.message,L(o||"Internal Server Error")}},[e,C]=n.useState({}),t=r=>{C({...e,[r]:!e[r]})};return s.jsxs(P.Fragment,{children:[s.jsx(S,{className:"rounded-5",children:s.jsxs(F,{className:"container",children:[s.jsxs(U,{className:"needs-validation mt-4",children:[s.jsxs(m,{className:"mb-3",children:[s.jsx(u,{htmlFor:"validationCustom03",className:"col-md-2 col-form-label",children:"Password Lama"}),s.jsxs("div",{className:"col-md-10",children:[s.jsxs(h,{children:[s.jsx(x,{placeholder:"Password Lama",type:e!=null&&e.old_pass?"text":"password",name:"old_pass",className:`form-control ${a.touched.old_pass&&a.errors.old_pass?"is-invalid":""}`,id:"validationCustom01",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.old_pass}),s.jsx(b,{className:"bg-white text-black border-start-0 border-secondary border-opacity-25",onClick:()=>t("old_pass"),children:e.old_pass?s.jsx(w,{size:20}):s.jsx(j,{size:20})})]}),a.touched.old_pass&&a.errors.old_pass?s.jsx(d,{className:"d-block",type:"invalid",children:a.errors.old_pass}):null]})]}),s.jsxs(m,{className:"mb-3",children:[s.jsx(u,{htmlFor:"validationCustom03",className:"col-md-2 col-form-label",children:"Password Baru"}),s.jsxs("div",{className:"col-md-10",children:[s.jsxs(h,{children:[s.jsx(x,{placeholder:"Password Baru",type:e!=null&&e.new_pass?"text":"password",name:"new_pass",className:`form-control ${a.touched.new_pass&&a.errors.new_pass?"is-invalid":""}`,id:"validationCustom01",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.new_pass}),s.jsx(b,{className:"bg-white text-black border-start-0 border-secondary border-opacity-25",onClick:()=>t("new_pass"),children:e.new_pass?s.jsx(w,{size:20}):s.jsx(j,{size:20})})]}),a.touched.new_pass&&a.errors.new_pass?s.jsx(d,{className:"d-block",type:"invalid",children:a.errors.new_pass}):null]})]}),s.jsxs(m,{className:"mb-3",children:[s.jsx(u,{htmlFor:"validationCustom03",className:"col-md-2 col-form-label",children:"Ulangi Password Baru"}),s.jsxs("div",{className:"col-md-10",children:[s.jsxs(h,{children:[s.jsx(x,{placeholder:"Ulangi Password Baru",type:e!=null&&e.repassword?"text":"password",name:"repassword",className:`form-control ${a.touched.repassword&&a.errors.repassword?"is-invalid":""}`,id:"validationCustom01",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.repassword}),s.jsx(b,{className:"bg-white text-black border-start-0 border-secondary border-opacity-25",onClick:()=>t("repassword"),children:e.repassword?s.jsx(w,{size:20}):s.jsx(j,{size:20})})]}),a.touched.repassword&&a.errors.repassword?s.jsx(d,{className:"d-block",type:"invalid",children:a.errors.repassword}):null,a.touched.repassword&&a.values.new_pass!=a.values.repassword?s.jsx(d,{className:"d-block",type:"invalid",children:"Password Tidak Sesuai"}):null]})]})]}),s.jsx("div",{className:"actions clearfix justify-content-end d-flex",children:s.jsx("button",{onClick:a.handleSubmit,className:"btn bg-primary text-white",children:"Simpan"})})]})}),s.jsx(T,{modalBackdrop:l,modalPopup:i,approve:()=>f()})]})},A=[{link:"/",label:"Beranda"},{link:"#",label:"Ubah Password"}],W=()=>{document.title="Profil Ubah Password | AHU RI";const l=E();return n.useEffect(()=>{l(I(A))},[]),s.jsxs(R,{fluid:!0,className:"page-content px-3 pt-3",children:[s.jsx("div",{className:"mb-3",children:s.jsx("h1",{className:"text-primary fs-4 fw-bold text-uppercase m-0",children:"Ubah Kata Sandi"})}),s.jsx(q,{})]})};export{W as default};
