import{j as a,b as c,c as n,c0 as A,aG as f,bY as l,r as u,C as I,bU as y,g as B,a as R,A as H,T as U}from"./index-d70a1868.js";import{b as W,c as S}from"./api-925f121c.js";import{D as z,T as G,A as O}from"./TaskAltOutlined-5f40f5af.js";const J=({formik:e})=>a.jsxs(c,{children:[a.jsxs(c,{children:[a.jsxs(n,{children:[a.jsx(A,{title:"Informasi Pribadi"}),a.jsxs(f,{className:"form-horizontal",children:[a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"namaLengkapPemohon",placeholder:"Tulis nama lengkap",title:"Nama Lengkap",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"kewarganegaraanAsal",title:"kewarganegaraan Asal",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"tempatLahir",title:"Tempat Lahir",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"tanggalLahir",title:"Tanggal Lahir",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"jenisKelamin",title:"Jenis Kelamin",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"agama",title:"Agama",readonly:!0,placeholder:"!"})})]}),a.jsx(c,{children:a.jsx(l,{formik:e,name:"pekerjaan",title:"pekerjaan",readonly:!0,placeholder:"!"})})]})]}),a.jsxs(n,{children:[a.jsx(A,{title:"Informasi Pernikahan"}),a.jsxs(f,{className:"form-horizontal",children:[a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"statusPerkawinan",title:"Status Perkawinan",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"tanggalPernikahan",title:"Tanggal Pernikahan",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"nomorAktaNikah",title:"Nomor Buku Nikah / Akta Nikah",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"6",children:a.jsx(l,{formik:e,name:"nomorSkim",title:"Nomor SKIM (Surat Keterangan Keimigrasian)",readonly:!0,placeholder:"!"})})]})]})]})]}),a.jsx(c,{children:a.jsxs(n,{children:[a.jsx(A,{title:"Data Alamat"}),a.jsxs(f,{className:"form-horizontal",children:[a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"provinsi",placeholder:"!",title:"Provinsi",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"kabupaten",placeholder:"!",title:"Kabupaten/Kota",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"kecamatan",placeholder:"!",title:"Kecamatan",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"kelurahan",placeholder:"!",title:"Kelurahan",readonly:!0})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"nomorHp",placeholder:"!",title:"Nomor HP",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"email",placeholder:"!",title:"Email",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"2",children:a.jsx(l,{formik:e,name:"rt",placeholder:"!",title:"RT",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"2",children:a.jsx(l,{formik:e,name:"rw",placeholder:"!",title:"RW",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"2",children:a.jsx(l,{formik:e,name:"kodePos",placeholder:"!",title:"Kode Pos",readonly:!0})})]}),a.jsx(n,{children:a.jsx(l,{formik:e,name:"alamatRumah",placeholder:"!",title:"Alamat Rumah",readonly:!0})})]})]})})]}),$={namaLengkapPemohon:"User 1",kewarganegaraanAsal:"Amerika Serikat",tempatLahir:"Jakarta",tanggalLahir:"1990-01-01",jenisKelamin:"Laki-laki",agama:"Islam",pekerjaan:"Wiraswasta",statusPerkawinan:"Menikah",tanggalPernikahan:"2015-06-15",nomorAktaNikah:"BN123456",nomorSkim:"SKIM-2023-001",provinsi:"DKI Jakarta",kabupaten:"Jakarta Selatan",kecamatan:"Kebayoran Baru",kelurahan:"Gandaria Utara",rt:"001",rw:"005",kodePos:"12140",alamatRumah:"Jl. Mawar No. 10, Gandaria Utara",nomorHp:"+6281234567890",email:"user1@example.com",namaLenkapPasangan:"Pasangan User 1",nikPasangan:"317509xxxxxxxxxx",nomorHpPasangan:"+6281398765432",emailPasangan:"pasangan@example.com",tempatLahirPasangan:"Bandung",tanggalLahirPasangan:"1992-03-21",pekerjaanPasangan:"Dosen",kewarganegaraanPasangan:"Indonesia",jenisKelaminPasangan:"Perempuan",agamaPasangan:"Kristen"},Y=({formik:e})=>a.jsx(a.Fragment,{children:a.jsxs(n,{children:[a.jsx(A,{title:"Informasi Data Pasangan WNI"}),a.jsxs(f,{className:"form-horizontal",children:[a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"namaLenkapPasangan",placeholder:"Tulis nama lengkap",title:"Nama Lengkap",readonly:!0})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"nikPasangan",title:"NIK",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"nomorHpPasangan",title:"Nomor HP",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"emailPasangan",title:"Email",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"tanggalLahirPasangan",title:"Tanggal Lahir",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"pekerjaanPasangan",title:"Pekerjaan",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"kewarganegaraanPasangan",title:"kewarganegaraan",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"jenisKelaminPasangan",title:"Jenis Kelamin",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"agamaPasangan",title:"Agama Pasangan",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"negaraLahirPasangan",title:"Negara",readonly:!0,placeholder:"!"})})]}),a.jsxs(c,{children:[a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"kabupatenPasangan",title:"kabupaten/Kota",readonly:!0,placeholder:"!"})}),a.jsx(n,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(l,{formik:e,name:"provinsiPasangan",title:"Provinsi",readonly:!0,placeholder:"!"})})]})]})]})}),q={fotokopiAktaKelahiran:{file_type:1,label:"Fotokopi akta kelahiran pemohon yang sudah diterjemahkan ke Bahasa Indonesia oleh penerjemah resmi dan dilegalisasi."},fotokopiKitap:{file_type:2,label:"Fotokopi KITAP (Kartu Izin Tinggal Tetap) yang sudah dilegalisasi."},fotokopiAktaKelahiranPasangan:{file_type:3,label:"Fotokopi akta kelahiran pasangan (suami/istri) yang sudah dilegalisasi ."},fotokopiKtpPasangan:{file_type:4,label:"Fotokopi KTP pasangan (suami/istri) yang sudah dilegalisasi."},fotokopiAktaPerkawinan:{file_type:5,label:"Fotokopi akta perkawinan/buku nikah yang diterjemahkan ke Bahasa Indonesia dan dilegalisasi.."},suratKeteranganImigrasi:{file_type:6,label:"Asli surat keterangan dari Imigrasi yang menyatakan pemohon sudah tinggal di Indonesia minimal 5 tahun berturut-turut atau 10 tahun tidak berturut-turut.."},sckcAsli:{file_type:7,label:"Asli SKCK dari Mabes Polri yang masih berlaku."},suratPerwakilanNegara:{file_type:8,label:"Asli surat dari perwakilan negara asal yang menyatakan pemohon akan kehilangan kewarganegaraan lamanya jika menjadi WNI."},pasfoto:{file_type:9,label:"Pas foto terbaru ukuran 4x6 cm, berwarna, latar belakang merah, berpakaian rapi dan sopan."},suratKeteranganSehat:{file_type:10,label:"Asli surat keterangan sehat jasmani dan rohani dari rumah sakit pemerintah."},buktiPembayaran:{file_type:11,label:"Asli bukti pembayaran permohonan untuk menjadi WNI."},suratPermohonanTertulis:{file_type:12,label:"Asli surat permohonan tertulis dalam Bahasa Indonesia, ditandatangani dan bermaterai, ditujukan ke Menteri Hukum melalui Ditjen AHU."},suratPernyataanAlasan:{file_type:13,label:"Asli surat pernyataan alasan menjadi WNI, ditulis tangan, ditandatangani, dan bermaterai."},suratPernyataanBerbahasa:{file_type:14,label:"Asli surat pernyataan bisa berbahasa Indonesia, ditulis tangan, ditandatangani, dan bermaterai."},suratPernyataanNama:{file_type:15,label:"Asli surat pernyataan bisa berbahasa Indonesia, ditulis tangan, ditandatangani, dan bermaterai."},suratPernyataanKesetiaan:{file_type:16,label:"Asli surat pernyataan kesetiaan pada NKRI, Pancasila, UUD 1945, dan kesediaan menjalankan kewajiban sebagai WNI secara tulus, ditulis tangan, ditandatangani, dan bermaterai."}},N={fotokopiAktaKelahiran:{validField:"akta_lahir_pemohon_valid",catatanField:"catatan_akta_lahir_pemohon"},fotokopiKitap:{validField:"kitap_valid",catatanField:"catatan_kitap"},fotokopiAktaKelahiranPasangan:{validField:"akta_lahir_pasangan_valid",catatanField:"catatan_akta_lahir_pasangan"},fotokopiKtpPasangan:{validField:"ktp_pasangan_valid",catatanField:"catatan_ktp_pasangan"},fotokopiAktaPerkawinan:{validField:"akta_kawin_valid",catatanField:"catatan_akta_kawin"},suratKeteranganImigrasi:{validField:"skim_valid",catatanField:"catatan_skim"},sckcAsli:{validField:"skck_valid",catatanField:"catatan_skck"},suratPerwakilanNegara:{validField:"sk_negara_valid",catatanField:"catatan_sk_negara"},pasfoto:{validField:"pas_foto_valid",catatanField:"catatan_pas_foto"},suratKeteranganSehat:{validField:"sk_sehat_valid",catatanField:"catatan_sk_sehat"},buktiPembayaran:{validField:"bukti_pnbp_valid",catatanField:"catatan_pnbp"},suratPermohonanTertulis:{validField:"surat_permohonan_valid",catatanField:"catatan_surat_permohonan"},suratPernyataanAlasan:{validField:"surat_alasan_wni_valid",catatanField:"catatan_surat_alasan_wni"},suratPernyataanBerbahasa:{validField:"surat_pernyataan_bahasa_valid",catatanField:"catatan_pernyataan_bahasa"},suratPernyataanNama:{validField:"surat_pernyataan_nama_sk_valid",catatanField:"catatan_pernyataan_nama_sk"},suratPernyataanKesetiaan:{validField:"surat_pernyataan_setia_nkri_valid",catatanField:"catatan_pernyataan_setia_nkri"}},C=e=>{const t=N[e];return t?{validKey:t.validField,catatanKey:t.catatanField}:(console.warn(`No mapping found for fileKey: ${e}`),{validKey:`${e}_valid`,catatanKey:`catatan_${e}`})},Q=({label:e,data:t,fileKey:p,verifikasiData:r,onUpdate:x})=>{const{validKey:o,catatanKey:m}=C(p),h=()=>{t!=null&&t.url&&window.open(t.url,"_blank")},s=k=>{x(o,k)},i=k=>{x(m,k.target.value||null)},d=r[o],_=r[m];return a.jsxs("div",{className:"border rounded p-3 mb-3",children:[a.jsx("h6",{className:"mb-2",children:e}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsx("div",{className:"mb-3",children:a.jsx(y,{text:"Lihat Dokumen",bgColor:"transparent",textColor:"#041662",border:"1px solid #EfEfEf",onClick:h})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"form-label small text-muted",children:"Status Validasi:"}),a.jsxs("div",{className:"btn-group d-block",role:"group",children:[a.jsx("button",{type:"button",className:`btn btn-sm me-2 ${d===!0?"btn-success":"btn-outline-success"}`,onClick:()=>s(!0),style:{minWidth:"80px"},children:"✓ Sesuai"}),a.jsx("button",{type:"button",className:`btn btn-sm ${d===!1?"btn-danger":"btn-outline-danger"}`,onClick:()=>s(!1),style:{minWidth:"100px"},children:"✗ Tidak Sesuai"})]})]}),!1]}),a.jsxs("div",{className:"col-md-6",children:[a.jsx("label",{className:"form-label small text-muted",children:"Catatan:"}),a.jsx("textarea",{className:"form-control",placeholder:"Tulis catatan...",rows:4,value:_||"",onChange:i})]})]})]})},X=({formik:e,onVerifikasiDataChange:t})=>{const p=e.values.files||[],[r,x]=u.useState(()=>{const s={id_permohonan:e.values.id_permohonan||null};return Object.keys(N).forEach(i=>{const{validKey:d,catatanKey:_}=C(i);s[d]=null,s[_]=null}),s});u.useEffect(()=>{t&&t(r)},[r,t]);const o=Object.entries(q).reduce((s,[i,d])=>(s[d.file_type]={label:d.label,key:i},s),{}),m=Object.values(p.sort((s,i)=>new Date(i.uploaded_at)-new Date(s.uploaded_at)).reduce((s,i)=>(o[i.file_type]&&(s[i.file_type]||(s[i.file_type]=i)),s),{})),h=(s,i)=>{x(d=>({...d,[s]:i}))};return a.jsxs(I,{children:[m.length===0&&a.jsx("div",{className:"alert alert-info",children:"Tidak ada dokumen yang ditemukan untuk diverifikasi."}),m.map(s=>{const i=o[s.file_type];if(!i)return null;const{key:d,label:_}=i;return N[d]?a.jsx(Q,{data:s,label:_,fileKey:d,verifikasiData:r,onUpdate:h},s.id_file):(console.warn(`FileKey ${d} tidak ada di BACKEND_FIELD_MAPPING`),null)})]})};function Z(e,t=!0){const[p,r]=u.useState(!1),[x,o]=u.useState(null),[m,h]=u.useState(null);return u.useEffect(()=>{if(!t||!e)return;(async()=>{console.log("API RUN"),r(!0),o(null);try{const i=await W(e);h(i.data)}catch(i){o(i)}finally{r(!1)}})()},[e,t]),{data:m,loading:p,error:x}}const aa=e=>({id_permohonan:e.id_permohonan||"",namaLengkapPemohon:e.nama_lengkap_pemohon||"",kewarganegaraanAsal:e.kewarganegaraan_asal_pemohon_text||"",tempatLahir:e.negara_lahir_pemohon_text||"",tanggalLahir:e.tgl_lahir_pemohon||"",jenisKelamin:e.jenis_kelamin_pemohon||"",agama:e.agama_pemohon||"",pekerjaan:e.pekerjaan_pemohon_text||"",statusPerkawinan:e.status_kawin||"",tanggalPernikahan:e.tgl_kawin||"",nomorAktaNikah:e.no_buku_nikah||"",nomorSkim:e.no_skim||"",statusAktivitas:e.status_aktivitas,provinsi:e.provinsi_pemohon_text||"",kabupaten:e.kab_kota_pemohon_text||"",kecamatan:e.kec_pemohon_text||"",kelurahan:e.desa_kel_pemohon_text||"",rt:e.rt||"",rw:e.rw||"",kodePos:e.kode_pos||"",alamatRumah:e.alamat_pemohon||"",nomorHp:e.no_telp_pemohon||"",email:e.email_pemohon||"",namaLenkapPasangan:e.nama_pasangan||"",nikPasangan:e.nik_pasangan||"",nomorHpPasangan:e.no_telp_pasangan||"",emailPasangan:e.email_pasangan||"",negaraLahirPasangan:e.negara_lahir_pasangan_text||"-",provinsiPasangan:e.provinsi_lahir_pasangan_text||"",kabupatenPasangan:e.kab_kota_lahir_pasangan_text||"",tanggalLahirPasangan:e.tgl_lahir_pasangan||"",pekerjaanPasangan:e.pekerjaan_pasangan_text||"",kewarganegaraanPasangan:e.kewarganegaraan_pasangan_text||"",jenisKelaminPasangan:e.jenis_kelamin_pasangan||"",agamaPasangan:e.agama_pasangan||"",files:e.files}),ea=e=>{let t;switch(e){case 0:t="Pembelian Voucher";break;case 1:t="Pendaftaran Permohonan";break;case 2:t="konseptor";break;case 3:t="sub-koordinator";break;case 4:t="koordinator";break;case 5:t="direktur";break;case 6:t="SK Terbit";break;default:t="Status tidak dikenali"}return t},sa=()=>{const e=B(),[t,p]=u.useState(0),[r,x]=u.useState(null),[o,m]=u.useState(!1),h=R(),s=new U,{data:i,loading:d,error:_}=Z(e.id);console.log("DATA DETAIL VERIFIKASI",i);const k=u.useMemo(()=>i?aa(i):$,[i]),P=H({initialValues:k,enableReinitialize:!0,onSubmit:j=>{console.log("Submit values:",j),s.customWarningMsg("API Belum tersedia")}}),F=ea(k.statusAktivitas);console.log("STATUS AKTIVITAS",F),console.log("mappedValues",k);const D=u.useCallback(j=>{x(j)},[]),K=[a.jsx(J,{formik:P}),a.jsx(Y,{formik:P}),a.jsx(X,{formik:P,onVerifikasiDataChange:D})],T=()=>{t<K.length-1&&p(t+1)},L=()=>{t>0&&p(t-1)},E=()=>{h("/pewarganegaraan/admin/verifikasi")},V=async()=>{if(!r){s.customErrorMsg("Data verifikasi belum tersedia");return}if(Object.entries(r).reduce((g,[b,v])=>(v!=null&&v!==""&&(g[b]=v),g),{}),console.log("Data verifikasi yang akan dikirim:",r),await s.confirmationCreate()){m(!0);try{const g=await S({...r,tipe_verifikator:F});console.log("API RESPONSE PATCH",g),g.message==="Success"&&(s.customSuccessMsg("Verifikasi berhasil disimpan"),setTimeout(()=>{h("/pewarganegaraan/admin/verifikasi")},1500))}catch(g){console.error("Error submitting verifikasi:",g),s.customWarningMsg("Gagal menyimpan verifikasi")}finally{m(!1)}}},M=async()=>{if(await s.confirmationCustom("Apakah anda yakin untuk menolak permohonan","Isi alasan penolakan agar dapat disampaikan kepada pemohon.")){m(!0);try{console.log("Data penolakan:",r),(await S({...r,tipe_verifikator:F})).message==="Success"&&(s.customSuccessMsg("Verifikasi berhasil ditolak"),setTimeout(()=>{h("/pewarganegaraan/admin/verifikasi")},1500))}catch(g){console.error("Error submitting verifikasi:",g),s.customWarningMsg("Gagal menyimpan verifikasi")}finally{m(!1)}}},w=u.useMemo(()=>r?!Object.keys(r).filter(b=>b.endsWith("_valid")).some(b=>r[b]===void 0||r[b]===null):!1,[r]);return a.jsxs(I,{className:"page-content bg-white mb-5",fluid:!0,children:[a.jsx("h3",{children:"Formulir Permohonan"}),d?a.jsx("p",{children:"Loading"}):a.jsx(f,{className:"rounded-3 border border-2 p-3",children:a.jsxs("form",{onSubmit:P.handleSubmit,children:[K[t],a.jsxs(f,{display:"flex",justifyContent:"flex-end",mt:4,children:[t===0&&a.jsx(y,{text:"Kembali",onClick:E,bgColor:"#e0e0e0",textColor:"#333",disabled:o}),t>0&&a.jsx(y,{text:"Kembali",onClick:L,disabled:t===0||o,bgColor:"#e0e0e0",textColor:"#333"}),t===K.length-1?a.jsxs(a.Fragment,{children:[a.jsx(y,{text:o?"Memproses...":"Tolak",type:"button",onClick:M,rightIcon:!o&&a.jsx(z,{fontSize:"small"}),bgColor:"#CF3533",hoverColor:"#BE1122",textColor:"#fff",disabled:o}),a.jsx(y,{text:o?"Memproses...":"Verifikasi",type:"button",onClick:V,rightIcon:!o&&a.jsx(G,{fontSize:"small"}),bgColor:w?"#1F7C4D":"#6c757d",hoverColor:w?"#1F6C4D":"#5a6268",textColor:"#fff",disabled:o,title:w?"":"Harap lengkapi verifikasi semua dokumen"})]}):a.jsx(y,{text:"Selanjutnya",type:"button",onClick:T,rightIcon:a.jsx(O,{}),bgColor:"#041662",textColor:"#fff",disabled:o})]})]})})]})};export{sa as default};
