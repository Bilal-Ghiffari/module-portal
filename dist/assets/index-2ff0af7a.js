import{p as J,q as _,cm as oe,c8 as Ee,dD as Qe,r as o,bE as Re,T as be,dm as ye,j as e,cA as ma,cB as Ie,b8 as g,b as L,c as m,b_ as ha,aG as b,dq as _e,c2 as le,bs as re,bn as me,cz as he,aw as pe,ax as xe,ay as W,az as C,bI as ze,aA as ge,b4 as De,cn as pa,bU as ve,dE as xa,bB as ga,cV as ja,bD as ba,bw as ne,bO as K,R as _a,dF as de,bQ as Ke,aH as ka,c0 as Ge,b3 as Ne,dG as Ze,dH as ea,dI as aa,dJ as na,a1 as fa,bN as ya,dK as wa,a as va,A as Sa,bV as Na,bW as Fa,bX as Pa,b$ as Ea}from"./index-1205c25f.js";import{A as ia}from"./LoadingAHU-9a7f25dd.js";import{F as z,s as Le,c as Ca,a as X,b as f,S as Fe,d as O,M as Te,A as He,C as Ra,e as Ta,v as Aa,f as ta,g as Ia,h as $e,i as ra,j as Da,D as sa,k as la,l as oa,m as Ae,n as Se,o as da,p as Ka,L as Me,q as Wa,r as qa,t as Ba,u as Va,w as Ma,x as Oa,y as La}from"./CheckCircleOutline-d79bd05c.js";import{D as Ja}from"./DialogActions-4f943394.js";import{F as za}from"./FormControlLabel-46beffc6.js";import{d as Ha,a as $a}from"./Download-1507d7a3.js";import{M as Ce}from"./Modal-cfc25378.js";import"./lodash-ce456aab.js";import"./Stack-806edb9c.js";const Ua={jenis_identitas:"pemberi",jenis_transaksi:"pendaftaran",jenis_pendaftaran:"",id_jenis_korporasi:"",sub_jenis_korporasi:"",id_badan_hukum:"",kewarganegaraan:"",jenis_kelamin:"",jenis_penggunaan:"",pengguna_produktif:"",nama:"",nik:"",npwp:"",no_sk:"",no_pengesahan:"",no_paspor:"",no_tlpon:"",id_negara_asal:"",email:"",alamat:"",id_provinsi:"",id_kebupaten:"",id_kecamatan:"",id_kelurahan:"",rt:"",rw:"",kode_pos:""},Ye=/^\d{3}$/,Ga=/^\d{5}$/,Ya=/^(^\+62|62|^0)(\d{9,12})$/,Xa=()=>({id_negara_asal:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&n===2||a==="perseorangan"&&i==="WNA",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),alamat:_().required("Alamat wajib diisi").min(5,"Alamat terlalu pendek").max(50,"Alamat maksimal 30 karakter"),id_provinsi:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Provinsi wajib diisi"),otherwise:a=>a.notRequired()}),id_kabupaten:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Kabupaten wajib diisi"),otherwise:a=>a.notRequired()}),id_kecamatan:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("kecamatan wajib diisi"),otherwise:a=>a.notRequired()}),id_kelurahan:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("kelurahan wajib diisi"),otherwise:a=>a.notRequired()}),rt:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("RT wajib diisi").matches(Ye,"RT harus terdiri dari 3 digit").length(3,"RT harus terdiri dari 3 digit"),otherwise:a=>a.notRequired()}),rw:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("RW wajib diisi").matches(Ye,"RW harus terdiri dari 3 digit").length(3,"RW harus terdiri dari 3 digit"),otherwise:a=>a.notRequired()}),kode_pos:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Kode Pos wajib diisi").matches(Ga,"Format Kode Pos tidak valid"),otherwise:a=>a.notRequired()})}),Qa=J({jenis_identitas:_().oneOf(["pemberi"],"Jenis identitas tidak valid"),jenis_transaksi:_().oneOf(["pendaftaran"],"Jenis transaksi tidak valid"),jenis_pendaftaran:_().required("Wajib diisi"),id_jenis_korporasi:oe().when("jenis_pendaftaran",{is:"kooperasi",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),sub_jenis_korporasi:_().when("jenis_pendaftaran",{is:"kooperasi",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),id_badan_hukum:_().when("id_jenis_korporasi",{is:"indonesia",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),kewarganegaraan:_().when("jenis_pendaftaran",{is:"perseorangan",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),nama:_().required("Wajib diisi"),jenis_kelamin:_().when("jenis_pendaftaran",{is:"perseorangan",then:a=>a.required(),otherwise:a=>a.notRequired("Jenis kelamin Wajib diisi")}),email:_().required("Email wajib diisi").email("Format email tidak valid").max(30,"Email maksimal 30 karakter"),no_tlpon:_().required("Nomor Telepon wajib diisi").matches(Ya,"Format Nomor Telepon tidak valid").min(10,"Nomor Telepon minimal 10 digit").max(14,"Nomor Telepon maksimal 14 digit"),nik:_().when(["jenis_pendaftaran","kewarganegaraan"],{is:(a,i)=>a==="perseorangan"&&i==="WNI",then:a=>a.required("NIK wajib diisi").length(16,"NIK harus 16 digit"),otherwise:a=>a.notRequired()}),npwp:_().when(["jenis_pendaftaran","id_jenis_korporasi","kewarganegaraan"],{is:(a,i,n)=>n!=="WNA"&&!(a==="kooperasi"&&i===2),then:a=>a.required("NPWP wajib diisi"),otherwise:a=>a.notRequired()}),no_sk:_().when(["jenis_pendaftaran","id_jenis_korporasi"],{is:(a,i)=>!(a==="kooperasi"&&i===2)&&a!=="perseorangan",then:a=>a.required("Nomor SK wajib diisi"),otherwise:a=>a.notRequired()}),no_paspor:_().when(["jenis_pendaftaran","kewarganegaraan"],{is:(a,i)=>a==="perseorangan"&&i==="WNA",then:a=>a.required("No Passport Wajib diisi"),otherwise:a=>a.notRequired()}),...Xa()}),Za={jenis_identitas:"pemberi",jenis_transaksi:"pendaftaran",jenis_pendaftaran:"",id_jenis_korporasi:"",sub_jenis_korporasi:"",id_badan_hukum:"",kewarganegaraan:"",jenis_kelamin:"",jenis_penggunaan:"",pengguna_produktif:"",nama:"",nik:"",npwp:"",no_sk:"",no_pengesahan:"",no_paspor:"",no_tlpon:"",id_negara_asal:"",email:"",alamat:"",id_provinsi:"",id_kebupaten:"",id_kecamatan:"",id_kelurahan:"",rt:"",rw:"",kode_pos:""},Xe=/^\d{3}$/,en=/^\d{5}$/,an=/^(^\+62|62|^0)(\d{9,12})$/,nn=()=>({id_negara_asal:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&n===2||a==="perseorangan"&&i==="WNA",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),alamat:_().required("Alamat wajib diisi").min(5,"Alamat terlalu pendek").max(50,"Alamat maksimal 30 karakter"),id_provinsi:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Provinsi wajib diisi"),otherwise:a=>a.notRequired()}),id_kabupaten:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Kabupaten wajib diisi"),otherwise:a=>a.notRequired()}),id_kecamatan:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("kecamatan wajib diisi"),otherwise:a=>a.notRequired()}),id_kelurahan:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("kelurahan wajib diisi"),otherwise:a=>a.notRequired()}),rt:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("RT wajib diisi").matches(Xe,"RT harus terdiri dari 3 digit").max(3,"RT maksimal 3 digit"),otherwise:a=>a.notRequired()}),rw:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("RW wajib diisi").matches(Xe,"RW harus terdiri dari 3 digit").max(3,"RW maksimal 3 digit"),otherwise:a=>a.notRequired()}),kode_pos:_().when(["jenis_pendaftaran","kewarganegaraan","id_jenis_korporasi"],{is:(a,i,n)=>a==="kooperasi"&&(n===1||n===3)||a==="perseorangan"&&i==="WNI",then:a=>a.required("Kode Pos wajib diisi").matches(en,"Format Kode Pos tidak valid"),otherwise:a=>a.notRequired()})}),tn=J({jenis_identitas:_().oneOf(["pemberi"],"Jenis identitas tidak valid"),jenis_transaksi:_().oneOf(["pendaftaran"],"Jenis transaksi tidak valid"),jenis_pendaftaran:_().required("Wajib diisi"),id_jenis_korporasi:oe().when("jenis_pendaftaran",{is:"kooperasi",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),sub_jenis_korporasi:_().when("jenis_pendaftaran",{is:"kooperasi",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),id_badan_hukum:_().when("id_jenis_korporasi",{is:"indonesia",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),kewarganegaraan:_().when("jenis_pendaftaran",{is:"perseorangan",then:a=>a.required("Wajib diisi"),otherwise:a=>a.notRequired()}),nama:_().required("Wajib diisi"),nama_debitur:_().optional().nullable(),nama_kantor:_().optional().nullable(),jenis_kelamin:_().when("jenis_pendaftaran",{is:"perseorangan",then:a=>a.required(),otherwise:a=>a.notRequired("Jenis kelamin Wajib diisi")}),email:_().required("Email wajib diisi").email("Format email tidak valid").max(30,"Email maksimal 30 karakter"),no_tlpon:_().required("Nomor Telepon wajib diisi").matches(an,"Format Nomor Telepon tidak valid").min(10,"Nomor Telepon minimal 10 digit").max(14,"Nomor Telepon maksimal 14 digit"),nik:_().when(["jenis_pendaftaran","kewarganegaraan"],{is:(a,i)=>a==="perseorangan"&&i==="WNI",then:a=>a.required("NIK wajib diisi").length(16,"NIK harus 16 digit"),otherwise:a=>a.notRequired()}),npwp:_().when(["jenis_pendaftaran","id_jenis_korporasi","kewarganegaraan"],{is:(a,i,n)=>n!=="WNA"&&!(a==="kooperasi"&&i===2),then:a=>a.required("NPWP wajib diisi"),otherwise:a=>a.notRequired()}),no_sk:_().when(["jenis_pendaftaran","id_jenis_korporasi"],{is:(a,i)=>!(a==="kooperasi"&&i===2)&&a!=="perseorangan",then:a=>a.required("Nomor SK wajib diisi"),otherwise:a=>a.notRequired()}),no_paspor:_().when(["jenis_pendaftaran","kewarganegaraan"],{is:(a,i)=>a==="perseorangan"&&i==="WNA",then:a=>a.required("No Passport Wajib diisi"),otherwise:a=>a.notRequired()}),...nn()}),rn={nomor_akta_notaris:"",tgl_akta:"",id_notaris:"",nama_notaris:"",nama_perjanjian:"",no_perjanjian:"",tgl_perjanjian:"",tgl_mulai_perjanjian:"",tgl_akhir_perjanjian:"",perjanjian_pokok:[{kurs:"",nominal:"",nominal_rupiah:"",terbilang_nominal:"",jenis_transaksi:"",id_transaksi:""}]},sn=J({nomor_akta_notaris:_().required("Wajib diisi"),tgl_akta:Ee().required("Wajib diisi"),id_notaris:_().required("Wajib diisi"),perjanjian_pokok:Qe().of(J({id_perjanjian_pokok:_().required("Wajib diisi"),kurs:_().required("Wajib diisi"),nilai_kurs:_().required("Wajib diisi"),nilai_nominal:oe().required("Wajib diisi"),nilai_nominal_rupiah:oe().required("Wajib diisi"),terbilang_nominal:_().required("Wajib diisi")})).min(1,"Anda harus menambahkan setidaknya satu perjanjian pokok"),nama_perjanjian:_().required("Wajib diisi"),no_perjanjian:_().required("Wajib diisi"),tgl_perjanjian:Ee().required("Wajib diisi"),tgl_mulai_perjanjian:Ee().required("Wajib diisi"),tgl_akhir_perjanjian:Ee().required("Wajib diisi")}),ln={id_jenis_kategori_obyek:"",value_jenis_kategori:[],kurs:"",nilai_kurs:"",nilai_nominal:"",nilai_nominal_rupiah:"",agreement:!1},on=J({id_jenis_kategori_obyek:oe().optional().nullable(),value_jenis_kategori:Qe().of(J().shape({id_atribut_jenis:oe().optional("ID atribut jenis wajib diisi"),value:_().optional("Value wajib diisi")})),kurs:_().optional("Kurs wajib dipilih"),nilai_kurs:oe().optional().positive("Nilai kurs harus lebih besar dari 0"),nilai_nominal:oe().optional().positive("Nilai nominal harus lebih besar dari 0")}),ee={BELUM_BAYAR:"BELUM_BAYAR",SUKSES:"SUKSES",GAGAL:"GAGAL"},dn=()=>{const a=new Date;return`${a.getFullYear()}${(a.getMonth()+1).toString().padStart(2,"0")}${a.getDate().toString().padStart(2,"0")}${Math.floor(Math.random()*1e6).toString().padStart(6,"0")}`},cn={status:ee.BELUM_BAYAR,kode_voucher:dn(),nama_pemohon:"",email_pemohon:"",nomor_hp:"",wilayah:"",tagihan:0,tanggal_transaksi:"",tanggal_expired:"",jenis_identitas:"pemberi",jenis_transaksi:"pendaftaran"},un=J({status:_().oneOf(Object.values(ee),"Status pembayaran tidak valid").required("Status pembayaran wajib diisi")}),te={validationSchemas:{identitasPemberi:Qa,identitasPenerima:tn,informasiJaminan:sn,ObyekJaminan:on,Payment:un},initialValues:{identitasPemberi:Ua,identitasPenerima:Za,informasiJaminan:rn,ObyekJaminan:ln,Payment:cn}},We={0:{fieldName:"onboarding",initialValues:{},validationSchema:J({})},1:{fieldName:"identity_pemberi",initialValues:{identity_pemberi:te.initialValues.identitasPemberi},validationSchema:J({identity_pemberi:te.validationSchemas.identitasPemberi})},2:{fieldName:"identity_penerima",initialValues:{identity_penerima:te.initialValues.identitasPenerima},validationSchema:J({identity_penerima:te.validationSchemas.identitasPenerima})},3:{fieldName:"information_jaminan",initialValues:{information_jaminan:te.initialValues.informasiJaminan},validationSchema:J({information_jaminan:te.validationSchemas.informasiJaminan})},4:{fieldName:"object_jaminan",initialValues:{object_jaminan:te.initialValues.ObyekJaminan},validationSchema:J({object_jaminan:te.validationSchemas.ObyekJaminan})},5:{fieldName:"konfirmasi_data",initialValues:{},validationSchema:J({})},6:{fieldName:"payment",initialValues:{payment:te.initialValues.Payment},validationSchema:J({payment:te.validationSchemas.Payment})}},mn=Object.values(We).reduce((a,i)=>({...a,...i.initialValues}),{}),Je=Object.fromEntries(Object.entries(We).map(([a,i])=>[a,i.validationSchema])),we=Object.entries(We).map(([a,i])=>Object.keys(i.initialValues)),hn=a=>Je[a]||J({}),ke=(a,i={})=>{const n=new be,[r,t]=o.useState(!1),[u,l]=o.useState(null),[p,d]=o.useState(null),{onDataChange:h=()=>{}}=i,s=o.useCallback(async()=>{var P,v,S;t(!0),l(null);try{const j=localStorage.getItem("id_pendaftaran");if(!j)throw new Error("ID Pendaftaran tidak ditemukan");const y=await z.getFidusiaPendaftaranKonfirmasiDetail(j);y.data&&(d(y.data),a.setValues({identity_pemberi:{...y.data.pemberi,jenis_pendaftaran:y.data.jenis_pendaftaran},information_jaminan:{nomor_akta_notaris:y.data.nomor_akta_notaris,tgl_akta:y.data.tgl_akta,id_notaris:y.data.id_notaris,nama_notaris:y.data.nama_notaris,nama_perjanjian:y.data.nama_perjanjian,no_perjanjian:y.data.no_perjanjian,tgl_perjanjian:y.data.tgl_perjanjian,tgl_mulai_perjanjian:y.data.tgl_mulai_perjanjian,tgl_akhir_perjanjian:y.data.tgl_akhir_perjanjian},payment:{kode_voucher:a.values.payment.kode_voucher,nama_pemohon:y.data.pemberi.nama,email_pemohon:y.data.pemberi.email,nomor_hp:y.data.pemberi.no_tlpon,wilayah:((P=y.data.payment)==null?void 0:P.wilayah)||"",tagihan:1e3,tanggal_transaksi:Re(y.data.created_at).format("YYYY-MM-DD"),tanggal_expired:Re(y.data.created_at).format("YYYY-MM-DD"),jenis_identitas:"pemberi",jenis_transaksi:"pendaftaran",status:((v=y.data.payment)==null?void 0:v.status)||ee.BELUM_BAYAR}}),h({identity_pemberi:y.data.pemberi||{},identity_penerima:y.data.penerima||[],information_jaminan:{nomor_akta_notaris:y.data.nomor_akta_notaris,tgl_akta:y.data.tgl_akta,id_notaris:y.data.id_notaris,nama_notaris:y.data.nama_notaris,nama_perjanjian:y.data.nama_perjanjian,no_perjanjian:y.data.no_perjanjian,tgl_perjanjian:y.data.tgl_perjanjian,tgl_mulai_perjanjian:y.data.tgl_mulai_perjanjian,tgl_akhir_perjanjian:y.data.tgl_akhir_perjanjian,perjanjian_pokok:y.data.perjanjian_pokok},object_jaminan:((S=y.data.obyek_jaminan)==null?void 0:S.map(M=>({...M,agreement:""})))||[]}))}catch(j){l(j),console.error("Fetch error:",j)}finally{t(!1)}},[h]),c=o.useCallback(async P=>{var v,S;try{t(!0);const j=await z.postFidusiaPendaftaranPenerima(P);return j&&j.message==="Success"?(await s(),n.successUpdate("Penerima Fidusia berhasil ditambahkan"),!0):(n.customWarningMsg("Terjadi kesalahan saat menyimpan"),!1)}catch(j){return console.error("Error saving recipient:",j),n.customWarningMsg(((S=(v=j.response)==null?void 0:v.data)==null?void 0:S.message)||"Terjadi kesalahan saat menyimpan"),!1}finally{t(!1)}},[s]),k=o.useCallback(async P=>{try{t(!0);const v=await z.deleteFidusiaPendaftaranPenerima(P);return v&&v.message==="Success"?(await s(),n.successUpdate("Data berhasil dihapus"),!0):(n.customWarningMsg("Gagal menghapus data"),!1)}catch(v){return console.error("Error deleting recipient:",v),n.customWarningMsg(v.message),!1}finally{t(!1)}},[s]),x=o.useCallback(async(P,v,S)=>{try{t(!0);const j=await z.postFidusiaPendaftaranInformasi(P);if(j&&j.message==="Success")return await s(),n.successUpdate(v?"Data berhasil diupdate":"Data berhasil ditambahkan"),!0;throw new Error("Gagal menyimpan data, silakan coba lagi.")}catch(j){throw console.error("Kesalahan saat menyimpan:",j),n.customWarningMsg(j.message),j}finally{t(!1)}},[s]),F=o.useCallback(async(P,v)=>{try{t(!0);const S=await z.deleteFidusiaPendaftaranInformasi(P);if(S&&S.message==="Success")return await s(),console.log("tempFormik",v),n.successUpdate("Data berhasil dihapus"),!0;throw new Error("Gagal menghapus data; silakan coba lagi.")}catch(S){throw console.error("Kesalahan saat menghapus:",S),n.customWarningMsg(S.message),S}finally{t(!1)}},[s]);return{loading:r,setLoading:t,error:u,data:p,onFetchLoadFidusiaPendaftaran:s,onSavePenerimaFidusia:c,onDeletePenerimaFidusia:k,onSaveInformasiPerjanjian:x,onDeleteInformasiPerjanjian:F}},pn=a=>{const i={1:a?z.patchFidusiaPendaftaranPemberi:z.postFidusiaPendaftaranPemberi,3:z.patchFidusiaPendaftaran,6:z.patchFidusiaPendaftaran};return async(r,t,u)=>{var s;const l=i[r],p=(s=u[r])==null?void 0:s.fieldName;if(!l||!p)return await Le(1e3),{data:{id_pendaftaran:a?JSON.parse(a):null},message:"Success"};const d=Ca(t.values[p]),h=c=>({id_pendaftaran:Number(a)||"",...r===1&&{step:1},...r===3&&{step:3},...r===6&&{step:6,status_permohonan:"selesai",status_transaksi:"berhasil"},...c});try{return await l(h(d))}catch(c){throw console.error("Error fetching data:",c),c}}},xn=pn,gn={async checkExistingPendaftaran({formik:a,setActiveStep:i,setLoading:n}){const r=localStorage.getItem("id_pendaftaran");if(!r){this.startNewPendaftaran(a,i);return}try{n(!0),await this.confirmContinueOrNew(r,a,i)&&i(u=>u+1)}catch(t){console.error("Error checking pendaftaran:",t),this.showErrorAlert("Gagal memeriksa pendaftaran. Silakan coba lagi.")}finally{n(!1)}},async confirmContinueOrNew(a,i,n){return new Promise(r=>{ye.fire({title:"Pendaftaran Existing Ditemukan",text:"Ada pendaftaran yang sedang berlangsung. Apa yang ingin Anda lakukan?",icon:"question",showCancelButton:!0,confirmButtonText:"Lanjutkan Pendaftaran",cancelButtonText:"Buat Pendaftaran Baru",reverseButtons:!0,customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content"}}).then(async t=>{t.isConfirmed?(await this.loadExistingPendaftaran(a,i),r(!0)):t.dismiss===ye.DismissReason.cancel?(this.startNewPendaftaran(i,n),r(!0)):r(!1)})})},async loadExistingPendaftaran(a,i){try{this.showSuccessAlert("Berhasil memuat data pendaftaran sebelumnya")}catch(n){console.error("Error loading existing pendaftaran:",n),this.showErrorAlert("Gagal memuat data pendaftaran")}},startNewPendaftaran(a,i){localStorage.removeItem("id_pendaftaran"),i(n=>n+1),a.setValues({identity_pemberi:{},identity_penerima:[],information_jaminan:{},object_jaminan:[]}),this.showInfoAlert("Memulai pendaftaran baru")},showSuccessAlert(a){ye.fire({icon:"success",title:"Sukses",text:a,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},showErrorAlert(a){ye.fire({icon:"error",title:"Error",text:a,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},showInfoAlert(a){ye.fire({icon:"info",title:"Informasi",text:a,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},jn=({formik:a,setActiveStep:i,label:n})=>{const[r,t]=o.useState(!1);function u(){gn.checkExistingPendaftaran({formik:a,setActiveStep:i,setLoading:t})}return e.jsxs("div",{className:"bg-white",children:[r&&e.jsxs(ma,{sx:{position:"absolute",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1,borderRadius:"8px",display:"flex",flexDirection:"column",gap:1},open:r,children:[e.jsx(Ie,{color:"primary"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:"Memuat data..."})]}),e.jsx("div",{className:"d-flex flex-column w-100 py-4",children:e.jsxs(L,{className:"w-100",style:{maxWidth:"800px",padding:"0px 50px"},children:[e.jsxs(m,{xs:"12",className:"mb-2",children:[e.jsx("h4",{className:"fw-bold",style:{color:"#041662"},children:n}),e.jsx("hr",{className:"mt-0 mb-3"})]}),e.jsx(m,{xs:"12",className:"mb-4",children:e.jsx("p",{style:{fontSize:"0.95rem",lineHeight:"1.6"},children:"Anda akan memulai proses permohonan pendaftaran fidusia.Pastikan Anda telah menyiapkan dokumen dan informasi yang dibutuhkan sebelum melanjutkan."})}),e.jsx(m,{xs:"12",className:"mb-4",children:e.jsxs("button",{onClick:u,style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#041662",color:"#fff",border:"none",padding:"10px 16px",borderRadius:"6px",fontSize:"14px"},children:[e.jsx("span",{children:"Mulai Pendaftaran"})," ",e.jsx(ha,{size:10})]})})]})})]})},bn=({formik:a,disabled:i=!1})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Alamat Pemberi Fidusia"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsx(L,{children:e.jsx(_e,{formik:a,disabled:i,provinsiKey:"identity_pemberi.id_provinsi",kabupatenKey:"identity_pemberi.id_kabupaten",kecamatanKey:"identity_pemberi.id_kecamatan",kelurahanKey:"identity_pemberi.id_kelurahan",showNegara:!1,required:!0})}),e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_pemberi.rt",title:"RT",placeholder:"Tulis nomor RT",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_pemberi.rw",title:"RW",placeholder:"Tulis nomor RW",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_pemberi.kode_pos",title:"Kode Pos",placeholder:"Tulis kode pos",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"12",lg:"12",xl:"6",children:e.jsx(f,{formik:a,name:"identity_pemberi.alamat",title:"Alamat Lengkap",placeholder:"Tulis alamat lengkap",type:"textarea",required:!0})})]})]})]}),_n=({formik:a})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Alamat Pemberi Fidusia (Luar Negeri)"}),e.jsx(b,{className:"form-horizontal",children:e.jsx(L,{children:e.jsx(m,{xs:"12",md:"12",lg:"12",xl:"12",children:e.jsx(f,{formik:a,name:"identity_pemberi.alamat",title:"Alamat Lengkap",placeholder:"Tulis alamat lengkap",type:"textarea",required:!0})})})})]}),kn=({formik:a,identityPemberi:i})=>{var t;const n=(t=i.kewarganegaraan)==null?void 0:t.toLowerCase(),r=i.id_jenis_korporasi;return n==="wni"||r===1||r===3?e.jsx(bn,{formik:a}):n==="wna"||r===2?e.jsx(_n,{formik:a}):e.jsx(Fe,{count:3,infoMessage:"Pilih Jenis Sub Pendaftaran terlebih dahulu"})},fn=({formik:a,identityPemberi:i})=>{const n=i.id_jenis_korporasi;return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Pemberi Fidusia - Koperasi"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama",title:"Nama Pemberi",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.npwp",title:"NPWP",placeholder:"Tulis nomor NPWP",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.email",title:"Email",type:"email",placeholder:"Tulis alamat email aktif",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_tlpon",title:"Nomor Telepon",placeholder:"Tulis nomor handphone aktif",required:!0})}),n===3&&e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_pengesahan",title:"No Pengesahan",placeholder:"Tulis nomor Pengesahan"})}),n!==3&&e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_sk",title:"No. SK",placeholder:"Tulis nomor SK"})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama_kantor",title:"Nama Kantor Cabang",placeholder:"Tulis nama kantor cabang"})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama_debitur",title:"Nama Debitur",placeholder:"Tulis nama debitur"})})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]})},yn=({formik:a,identityPemberi:i})=>{var r;const n=(r=i.kewarganegaraan)==null?void 0:r.toLowerCase();return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Pemberi Fidusia - Perseorangan"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama",title:"Nama Pemberi",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(O,{formik:a,name:"identity_pemberi.jenis_kelamin",title:"Jenis Kelamin",placeholder:"jenis kelamin",options:[{label:"Laki-laki",value:"Laki-Laki"},{label:"Perempuan",value:"Perempuan"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.email",title:"Email",type:"email",placeholder:"Tulis email aktif",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_tlpon",title:"Nomor Telepon",placeholder:"Tulis nomor handphone aktif",required:!0})}),n==="wna"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(_e,{formik:a,negaraKey:"identity_pemberi.id_negara_asal",showNegara:!0,showProvinsi:!1,showKabupaten:!1,showKecamatan:!1,showKelurahan:!1,required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_paspor",title:"Nomor Paspor",placeholder:"Tulis nomor paspor",required:!0})})]}),n==="wni"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.npwp",title:"NPWP",placeholder:"Tulis nomor NPWP",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nik",title:"NIK",placeholder:"Tulis nomor NIK",required:!0})})]}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama_debitur",title:"Nama Debitur",placeholder:"Tulis nama debitur"})})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]})},wn=({formik:a})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Pemberi Fidusia - Korporasi Asing"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama",title:"Nama Pemberi",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_pengesahan",title:"Nomor Pengesahan",placeholder:"Nomor Pengesahan",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.no_tlpon",title:"Nomor Telepon",placeholder:"Nomor Telepon",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_pemberi.email",title:"Email",placeholder:"Email",required:!0,type:"email"})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(_e,{formik:a,negaraKey:"identity_pemberi.id_negara_asal",showNegara:!0,showProvinsi:!1,showKabupaten:!1,showKecamatan:!1,showKelurahan:!1,required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(f,{formik:a,name:"identity_pemberi.nama_debitur",title:"Nama Debitur",placeholder:"Nama Debitur"})})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]}),vn=({formik:a,identityPemberi:i})=>{var t;const n=(t=i.jenis_pendaftaran)==null?void 0:t.toLowerCase(),r=i.id_jenis_korporasi;if(!n)return e.jsx(Fe,{count:3,infoMessage:"Pilih Jenis Pendaftaran terlebih dahulu"});switch(n){case"perseorangan":return e.jsx(yn,{formik:a,identityPemberi:i});case"kooperasi":switch(r){case 2:return e.jsx(wn,{formik:a,identityPemberi:i});case 1:return e.jsx(fn,{formik:a,identityPemberi:i});default:return e.jsx("div",{children:e.jsx("p",{children:"Pilih Jenis Korporasi terlebih dahulu"})})}default:return e.jsx("div",{children:e.jsx("p",{children:"Jenis Pendaftar tidak diketahui"})})}},Sn=({formik:a,identityPemberi:i,optionJenisKorporasi:n,optionsubJenisKorporasi:r,optionJenisBadanHukum:t})=>{const u=i.jenis_pendaftaran,l=i.id_jenis_korporasi;return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Jenis Pemberi Fidusia"}),e.jsx(b,{className:"form-horizontal",children:e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_pemberi.jenis_pendaftaran",title:"Jenis Pendaftaran",placeholder:"jenis pendaftaran",options:[{label:"Korporasi",value:"kooperasi"},{label:"Perseorangan",value:"perseorangan"}],required:!0})}),u==="kooperasi"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:{...a,setFieldValue:(p,d)=>{a.setFieldValue(p,Number(d))}},name:"identity_pemberi.id_jenis_korporasi",title:"Jenis Korporasi",placeholder:"jenis korporasi",options:n,required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_pemberi.sub_jenis_korporasi",title:"Jenis Sub Korporasi",placeholder:"sub korporasi",options:r})}),l!==2&&e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:{...a,setFieldValue:(p,d)=>{a.setFieldValue(p,Number(d))}},name:"identity_pemberi.id_badan_hukum",title:"Jenis Badan Hukum",placeholder:"jenis badan hukum",options:t,required:!0})})]}),u==="perseorangan"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_pemberi.kewarganegaraan",title:"Kewarganegaraan",placeholder:"kewarganegaraan",options:[{label:"WNI",value:"WNI"},{label:"WNA",value:"WNA"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_pemberi.jenis_penggunaan",title:"Jenis Penggunaan",placeholder:"jenis penggunaan",options:[{label:"Produktif",value:"Produktif"},{label:"Konsumtif",value:"Konsumtif"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_pemberi.pengguna_produktif",title:"Jenis Sub Penggunaan",placeholder:"(Opsional)",options:[{label:"Usaha Mikro",value:"usaha_mikro"},{label:"Usaha Kecil",value:"usaha_kecil"},{label:"Usaha Menengah",value:"usaha_menengah"},{label:"Usaha Lainnya",value:"usaha_lainnya"}]})})]})]})})]})},Nn=({formik:a,disabled:i=!1})=>{const{values:n}=a,r=n.identity_pemberi,[t,u]=o.useState([]),[l]=o.useState([{label:"Bank",value:"bank"},{label:"Lembaga Keuangan Bukan Bank",value:"lembaga_keuangan_bukan_bank"},{label:"Lainnya",value:"lainnya"}]),[p,d]=o.useState([]),h=o.useRef(),s=o.useRef(),c=o.useRef(),k=o.useCallback(j=>{a.setFieldValue("identity_pemberi",{...j.identity_pemberi,jenis_pendaftaran:j.identity_pemberi.jenis_pendaftar})},[]),{loading:x,setLoading:F,error:P,data:v,onFetchLoadFidusiaPendaftaran:S}=ke(a,{onDataChange:k});return o.useEffect(()=>{(async()=>{try{await S()}catch(y){console.error("Error fetching initial data:",y),toastifyService.customWarningMsg("Error fetching data")}})()},[S]),o.useEffect(()=>{Te.getOptionJenisKorporasi().then(u)},[]),o.useEffect(()=>{t&&Te.getOptionBadanHukum(r==null?void 0:r.id_jenis_korporasi).then(d)},[r==null?void 0:r.id_jenis_korporasi]),o.useEffect(()=>{const j=r==null?void 0:r.jenis_pendaftaran;h.current&&h.current!==j&&(j==="perseorangan"?(a.setFieldValue("identity_pemberi.id_jenis_korporasi",""),a.setFieldValue("identity_pemberi.sub_jenis_korporasi",""),a.setFieldValue("identity_pemberi.id_badan_hukum",""),a.setFieldValue("identity_pemberi.jenis_penggunaan",""),a.setFieldValue("identity_pemberi.pengguna_produktif","")):j==="kooperasi"&&(a.setFieldValue("identity_pemberi.kewarganegaraan",""),a.setFieldValue("identity_pemberi.jenis_kelamin",""))),h.current=j},[r==null?void 0:r.jenis_pendaftaran]),o.useEffect(()=>{const j=r==null?void 0:r.id_jenis_korporasi;s.current&&s.current!==j&&j==="asing"&&(a.setFieldValue("identity_pemberi.npwp",""),a.setFieldValue("identity_pemberi.no_sk",""),a.setFieldValue("identity_pemberi.no_pengesahan","")),s.current=j},[r==null?void 0:r.id_jenis_korporasi]),o.useEffect(()=>{const j=r==null?void 0:r.kewarganegaraan;c.current&&c.current!==j&&(j==="WNA"?(a.setFieldValue("identity_pemberi.npwp",""),a.setFieldValue("identity_pemberi.nik",""),a.setFieldValue("identity_pemberi.id_negara_asal","")):j==="WNI"&&a.setFieldValue("identity_pemberi.id_negara_asal","")),c.current=j},[r==null?void 0:r.kewarganegaraan]),x||!r?e.jsx(ia,{open:x,message:"Memuat Data"}):e.jsxs(e.Fragment,{children:[e.jsx(Sn,{formik:a,identityPemberi:r,optionJenisKorporasi:t,optionsubJenisKorporasi:l,optionJenisBadanHukum:p}),e.jsx(le,{}),e.jsx(vn,{formik:a,identityPemberi:r}),e.jsx(le,{}),e.jsx(kn,{formik:a,identityPemberi:r,disabled:i})]})},Fn=({formik:a})=>e.jsx(Nn,{formik:a}),Pn=({formik:a,disabled:i=!1})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Alamat Penerima Fidusia"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsx(L,{children:e.jsx(_e,{formik:a,disabled:i,provinsiKey:"identity_penerima.id_provinsi",kabupatenKey:"identity_penerima.id_kabupaten",kecamatanKey:"identity_penerima.id_kecamatan",kelurahanKey:"identity_penerima.id_kelurahan",showNegara:!1,required:!0})}),e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_penerima.rt",title:"RT",placeholder:"Tulis nomor RT",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_penerima.rw",title:"RW",placeholder:"Tulis nomor RW",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"2",children:e.jsx(f,{formik:a,name:"identity_penerima.kode_pos",title:"Kode Pos",placeholder:"Tulis kode pos",type:"number",required:!0})}),e.jsx(m,{xs:"12",md:"12",lg:"12",xl:"6",children:e.jsx(f,{formik:a,name:"identity_penerima.alamat",title:"Alamat Lengkap",placeholder:"Tulis alamat lengkap",type:"textarea",required:!0})})]})]})]}),En=({formik:a,disabled:i=!1})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Alamat Penerima Fidusia (Luar Negeri)"}),e.jsx(b,{className:"form-horizontal",children:e.jsx(L,{children:e.jsx(m,{xs:"12",md:"12",lg:"12",xl:"12",children:e.jsx(f,{formik:a,name:"identity_penerima.alamat",title:"Alamat Lengkap",placeholder:"Tulis alamat lengkap",type:"textarea",required:!0})})})})]}),Cn=({formik:a,identityPenerima:i})=>{var t;const n=(t=i.kewarganegaraan)==null?void 0:t.toLowerCase(),r=i.id_jenis_korporasi;return n==="wni"||r===1||r===3?e.jsx(Pn,{formik:a}):n==="wna"||r===2?e.jsx(En,{formik:a}):e.jsx(Fe,{count:3,infoMessage:"Pilih Jenis Sub Pendaftaran terlebih dahulu"})},Rn=({formik:a,identityPenerima:i})=>{var r;const n=(r=i.kewarganegaraan)==null?void 0:r.toLowerCase();return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Penerima Fidusia - Perseorangan"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.nama",title:"Nama Penerima",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(O,{formik:a,name:"identity_penerima.jenis_kelamin",title:"Jenis Kelamin",placeholder:"jenis kelamin",options:[{label:"Laki-laki",value:"Laki-Laki"},{label:"Perempuan",value:"Perempuan"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.email",title:"Email",type:"email",placeholder:"Tulis email aktif",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_tlpon",title:"Nomor Telepon",placeholder:"Tulis nomor handphone aktif",required:!0})}),n==="wna"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(_e,{formik:a,negaraKey:"identity_penerima.id_negara_asal",showNegara:!0,showProvinsi:!1,showKabupaten:!1,showKecamatan:!1,showKelurahan:!1,required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_paspor",title:"Nomor Paspor",placeholder:"Tulis nomor paspor",required:!0})})]}),n==="wni"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.npwp",title:"NPWP",placeholder:"Tulis nomor NPWP",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.nik",title:"NIK",placeholder:"Tulis nomor NIK",required:!0})})]})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]})},Tn=({formik:a,identityPenerima:i})=>{const n=i.id_jenis_korporasi;return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Penerima Fidusia - Koperasi ID"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.nama",title:"Nama Pemberi",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.npwp",title:"NPWP",placeholder:"Tulis nomor NPWP",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.email",title:"Email",type:"email",placeholder:"Tulis alamat email aktif",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_tlpon",title:"Nomor Telepon",placeholder:"Tulis nomor handphone aktif",required:!0})}),n===3&&e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_pengesahan",title:"No Pengesahan",placeholder:"Tulis nomor Pengesahan"})}),n!==3&&e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_sk",title:"No. SK",placeholder:"Tulis nomor SK"})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.nama_kantor",title:"Nama Kantor Cabang",placeholder:"Tulis nama kantor cabang"})})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]})},An=({formik:a})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Informasi Penerima Fidusia - Korporasi Asing"}),e.jsxs(b,{className:"form-horizontal",children:[e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.nama",title:"Nama Pemberi",placeholder:"Tulis nama lengkap",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_pengesahan",title:"Nomor Pengesahan",placeholder:"Nomor Pengesahan",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.no_tlpon",title:"Nomor Telepon",placeholder:"Nomor Telepon",required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"4",xl:"3",children:e.jsx(f,{formik:a,name:"identity_penerima.email",title:"Email",placeholder:"Email",required:!0,type:"email"})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(_e,{formik:a,negaraKey:"identity_penerima.id_negara_asal",showNegara:!0,showProvinsi:!1,showKabupaten:!1,showKecamatan:!1,showKelurahan:!1,required:!0})})]}),e.jsx("p",{className:"text-warning mt-2",style:{fontSize:"0.85rem"},children:"* Isi jika Nama Debitur bukan Pemberi Fidusia"})]})]}),In=({formik:a,identityPenerima:i})=>{var t;const n=(t=i.jenis_pendaftaran)==null?void 0:t.toLowerCase(),r=i.id_jenis_korporasi;if(!n)return e.jsx(Fe,{count:3,infoMessage:"Pilih Jenis Pendaftaran terlebih dahulu"});switch(n){case"perseorangan":return e.jsx(Rn,{formik:a,identityPenerima:i});case"kooperasi":switch(r){case 2:return e.jsx(An,{formik:a,identityPenerima:i});case 1:return e.jsx(Tn,{formik:a,identityPenerima:i});default:return e.jsx("div",{children:e.jsx("p",{children:"Pilih Jenis Korporasi terlebih dahulu"})})}default:return e.jsx("div",{children:e.jsx("p",{children:"Jenis Pendaftar tidak diketahui"})})}},Dn=({formik:a,identityPenerima:i,optionJenisKorporasi:n,optionsubJenisKorporasi:r,optionJenisBadanHukum:t})=>{const u=i.jenis_pendaftaran,l=i.id_jenis_korporasi;return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Jenis Penerima Fidusia"}),e.jsx(b,{className:"form-horizontal",children:e.jsxs(L,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_penerima.jenis_pendaftaran",title:"Jenis Pendaftaran",placeholder:"jenis pendaftaran",options:[{label:"Korporasi",value:"kooperasi"},{label:"Perseorangan",value:"perseorangan"}],required:!0})}),u==="kooperasi"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:{...a,setFieldValue:(p,d)=>{a.setFieldValue(p,Number(d))}},name:"identity_penerima.id_jenis_korporasi",title:"Jenis Korporasi",placeholder:"jenis korporasi",options:n,required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_penerima.sub_jenis_korporasi",title:"Jenis Sub Korporasi",placeholder:"sub korporasi",options:r})}),l!==2&&e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:{...a,setFieldValue:(p,d)=>{a.setFieldValue(p,Number(d))}},name:"identity_penerima.id_badan_hukum",title:"Jenis Badan Hukum",placeholder:"jenis badan hukum",options:t,required:!0})})]}),u==="perseorangan"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_penerima.kewarganegaraan",title:"Kewarganegaraan",placeholder:"kewarganegaraan",options:[{label:"WNI",value:"WNI"},{label:"WNA",value:"WNA"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_penerima.jenis_penggunaan",title:"Jenis Penggunaan",placeholder:"jenis penggunaan",options:[{label:"Produktif",value:"Produktif"},{label:"Konsumtif",value:"Konsumtif"}],required:!0})}),e.jsx(m,{xs:"12",md:"6",lg:"6",xl:"6",children:e.jsx(O,{formik:a,name:"identity_penerima.pengguna_produktif",title:"Jenis Sub Penggunaan",placeholder:"(Opsional)",options:[{label:"Usaha Mikro",value:"usaha_mikro"},{label:"Usaha Kecil",value:"usaha_kecil"},{label:"Usaha Menengah",value:"usaha_menengah"},{label:"Usaha Lainnya",value:"usaha_lainnya"}]})})]})]})})]})},Kn=({data:a=[],onEditRow:i,onDeleteRow:n})=>{const[r,t]=o.useState(""),u=a.map((d,h)=>({no:h+1,...d})),l=[{id:"no",label:"No",align:"center"},{id:"nama",label:"Nama",align:"center"},{id:"email",label:"Email",align:"center"},{id:"no_tlpon",label:"No Telepon",align:"center"},{id:"actions",label:"Actions",align:"end",cell:d=>e.jsx(b,{sx:{display:"flex",gap:1},children:e.jsx(De,{color:"secondary",onClick:()=>n(d.id_tr_fds_identitas),"aria-label":"delete",size:"small",children:e.jsx(He,{})})})}],p=o.useMemo(()=>{if(!r)return u;const d=r.toLowerCase();return u.filter(h=>Object.values(h).some(s=>s==null?void 0:s.toString().toLowerCase().includes(d)))},[u,r]);return e.jsxs(re,{sx:{width:"100%",overflow:"hidden",marginBottom:2},children:[e.jsx(b,{sx:{p:2,display:"flex",alignItems:"center"},children:e.jsx(me,{variant:"outlined",placeholder:"Cari...",size:"small",value:r,onChange:d=>t(d.target.value),sx:{marginRight:2}})}),e.jsx(he,{children:e.jsxs(pe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(xe,{children:e.jsx(W,{children:l.map(d=>e.jsx(C,{align:d.align,children:e.jsx(ze,{children:d.label})},d.id))})}),e.jsx(ge,{children:p.length===0?e.jsx(W,{children:e.jsx(C,{colSpan:l.length,align:"center",children:e.jsxs(b,{sx:{p:2,textAlign:"center"},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Data Tidak Ditemukan"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:"Tidak ada data yang sesuai dengan pencarian Anda. Silakan tambahkan data baru."})]})})}):p.map(d=>e.jsx(W,{hover:!0,children:l.map(h=>{const s=h.cell?h.cell(d):d[h.id];return e.jsx(C,{align:h.align,children:s},h.id)})},d.id))},"table-body-penerima")]})})]})},Wn=a=>{const i=localStorage.getItem("id_pendaftaran"),n={id_pendaftaran:Number(i)||"",...a};return Object.fromEntries(Object.entries(n).filter(([r,t])=>t!==""))},qn=({formik:a,disabled:i=!1,dataSource:n,onUpdateData:r})=>{const t=new be,[u,l]=o.useState(!1),{values:p}=a,d=p.identity_penerima,[h,s]=o.useState([]),[c,k]=o.useState(!1),x=o.useCallback(N=>{r(N),s(N.identity_penerima||[])},[]),{onSavePenerimaFidusia:F,onDeletePenerimaFidusia:P}=ke(a,{onDataChange:x});o.useEffect(()=>{s(n.identity_penerima||[])},[n]);const[v,S]=o.useState([]),[j]=o.useState([{label:"Bank",value:"bank"},{label:"Lembaga Keuangan Bukan Bank",value:"lembaga_keuangan_bukan_bank"},{label:"Lainnya",value:"lainnya"}]),[y,M]=o.useState([]);o.useEffect(()=>{Te.getOptionJenisKorporasi().then(S)},[]),o.useEffect(()=>{d!=null&&d.id_jenis_korporasi&&Te.getOptionBadanHukum(d==null?void 0:d.id_jenis_korporasi).then(M)},[d==null?void 0:d.id_jenis_korporasi]);const H=async N=>{t.confirmationDelete().then(async w=>{w&&await P(N)})},A=()=>{a.setFieldValue("identity_penerima",{penerima:[],jenis_pendaftaran:"",id_jenis_korporasi:"",sub_jenis_korporasi:"",id_badan_hukum:"",kewarganegaraan:"",jenis_kelamin:"",jenis_penggunaan:"",pengguna_produktif:"",nama:"",nik:"",npwp:"",no_sk:"",no_pengesahan:"",no_paspor:"",no_tlpon:"",email:"",alamat:"",id_provinsi:"",id_kabupaten:"",id_kecamatan:"",id_kelurahan:"",rt:"",rw:"",kode_pos:""})},ie=async()=>{var N,w;try{k(!0);const I=await Aa(a);if(Object.keys(I.errors).length>0){ta(a,I.errors);return}const se={id:Ia(),...d},ce=Wn(se);await F(ce)&&(l(!1),A())}catch(I){console.error("Error saving recipient:",I),t.customWarningMsg(((w=(N=I.response)==null?void 0:N.data)==null?void 0:w.message)||"Terjadi kesalahan saat menyimpan")}finally{k(!1)}};return e.jsxs(b,{children:[e.jsx(pa,{title:"Informasi Penerima Fidusia",buttonText:"+ Tambah",onButtonClick:()=>{l(!0),A()}}),e.jsx(Kn,{data:h,formik:a,onDeleteRow:H,loading:c}),u&&e.jsxs(b,{sx:{border:"1px solid #e0e0e0",borderRadius:2,p:2,mb:2},children:[e.jsx(Dn,{formik:a,identityPenerima:d,optionJenisKorporasi:v,optionsubJenisKorporasi:j,optionJenisBadanHukum:y}),e.jsx(le,{}),e.jsx(In,{formik:a,identityPenerima:d}),e.jsx(le,{}),e.jsx(Cn,{formik:a,identityPenerima:d,disabled:i}),e.jsxs(b,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:[e.jsx(ve,{text:"Batal",bgColor:"transparent",border:"1px solid #E7E7E7",textColor:"#041662",onClick:()=>{l(!1),A()},leftIcon:e.jsx(Ra,{fontSize:"14"})}),e.jsx(ve,{loading:c,onClick:ie,text:"Simpan",leftIcon:e.jsx(Ta,{fontSize:"14"})})]})]})]})},Bn=({formik:a,dataSource:i,onUpdateData:n})=>e.jsx(qn,{formik:a,dataSource:i,onUpdateData:n}),Vn=({formik:a,notarisOptions:i,errorMessage:n,onCloseError:r})=>{const t=new Date,u=t.toISOString().split("T")[0],l=new Date(t);l.setDate(t.getDate()-30);const p=l.toISOString().split("T")[0];return e.jsxs(e.Fragment,{children:[e.jsx($e,{open:!!n,autoHideDuration:6e3,onClose:r,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ra,{onClose:r,severity:"error",sx:{width:"100%"},children:n})}),e.jsx(X,{title:"Akta Notaris Jaminan Fidusia"}),e.jsxs("div",{className:"alert alert-warning small",role:"alert",children:[e.jsx("strong",{children:"PERHATIAN"})," ",e.jsx("br",{}),"PP 21 TAHUN 2015 TENTANG TATA CARA PENDAFTARAN JAMINAN FIDUSIA DAN BIAYA PEMBUATAN AKTA JAMINAN FIDUSIA Pasal 4.",e.jsx("br",{}),"Permohonan pendaftaran Jaminan Fidusia sebagaimana dimaksud dalam Pasal 3 diajukan dalam jangka waktu paling lama 30 (tiga puluh) hari terhitung sejak tanggal pembuatan akta Jaminan Fidusia."]}),e.jsxs(L,{children:[e.jsx(m,{md:"4",children:e.jsx(f,{formik:a,name:"information_jaminan.nomor_akta_notaris",title:"Nomor Akta",placeholder:"Tulis nomor akta",required:!0})}),e.jsx(m,{md:"4",children:e.jsx(Da,{formik:a,type:"date",name:"information_jaminan.tgl_akta",title:"Tanggal Akta",placeholder:"Pilih tanggal akta",required:!0,minDate:p,maxDate:u})}),e.jsx(m,{md:"4",children:e.jsx(xa,{formik:{...a,setFieldValue:(d,h)=>{a.setFieldValue(d,Number(h))}},fieldName:"information_jaminan.id_notaris",data:i,label:"Nama Notaris / Kedudukan",required:!0,onChange:d=>{a.setFieldValue(information_jaminan.id_notaris,Number(d==null?void 0:d.value)),a.setFieldValue(`${information_jaminan.id_notaris}_nama_notaris`,d==null?void 0:d.label)}})})]})]})},Mn=({open:a,loading:i,onClose:n,onSave:r,formik:t,currencyData:u})=>{const[l,p]=o.useState(""),[d,h]=o.useState(0),s=()=>{r(l,d),n(),c()},c=()=>{p(""),h("")};return e.jsxs(ga,{open:a,onClose:n,maxWidth:"sm",fullWidth:!0,PaperProps:{style:{borderRadius:"16px"}},disableEscapeKeyDown:!0,disableBackdropClick:!0,children:[e.jsx(ja,{sx:{textAlign:"center",fontWeight:600},children:"Tambah Nilai"}),e.jsxs(ba,{children:[e.jsx(g,{variant:"body2",sx:{marginBottom:2,textAlign:"center",color:"#6c757d"},children:"Silakan tambah nilai jaminan"}),e.jsx("div",{style:{marginBottom:"20px"},children:e.jsx(sa,{isMulti:!1,formik:t,fieldName:"information_jaminan.kurs",data:u,value:l,label:"Pilih KURS",required:!0,isDisabled:!1,onChange:k=>{p(k),t.setFieldValue("information_jaminan.kurs",k)}})}),e.jsx("div",{style:{marginBottom:"20px"},children:e.jsx(me,{label:"Nominal",type:"number",value:d,onChange:k=>h(k.target.value),fullWidth:!0,required:!0,sx:{mb:2},InputProps:{style:{borderRadius:"12px",padding:"10px 16px"}}})})]}),e.jsxs(Ja,{sx:{justifyContent:"center",padding:"20px"},children:[e.jsx(ne,{onClick:n,color:"primary",variant:"outlined",sx:{width:"30%",marginRight:"10px",fontSize:"14px",textTransform:"none",color:"#041662",borderColor:"#041662"},children:"Kembali"}),e.jsx(ne,{disabled:i,onClick:s,color:"primary",variant:"contained",sx:{width:"30%",fontSize:"14px",textTransform:"none",backgroundColor:"#041662",color:"#fff"},children:"Simpan"})]})]})},On=({data:a=[],formik:i,showSelect:n=!0,exchangeRates:r,onEditRow:t,onDeleteRow:u,calculateNominalRupiah:l,kurs:p})=>{const[d,h]=o.useState(""),s=a.map((x,F)=>({no:F+1,...x})),c=[{id:"no",label:"No",align:"center"},{id:"kurs",label:"KURS",align:"center"},{id:"nilai_nominal",label:"Nominal",align:"center",cell:x=>e.jsx(me,{variant:"outlined",size:"small",onChange:F=>{const P=parseFloat(F.target.value)||0,v=a.map(S=>S.id===x.id?{...S,nilai_nominal:P,nilai_nominal_rupiah:l(S.kurs,P)}:S);i.setFieldValue("information_jaminan.perjanjian_pokok",v)},value:x.nilai_nominal,type:"number"})},{id:"nilai_nominal_rupiah",label:"Nominal Rupiah",align:"center",cell:x=>{const F=x.nilai_nominal_rupiah!==void 0?x.nilai_nominal_rupiah:l(x.kurs,x.nominal,r);return la(F)}},{id:"terbilang_nominal",label:"Sebutan",align:"center"},{id:"actions",label:"Actions",align:"center",cell:x=>e.jsx(b,{sx:{display:"flex",gap:1},children:e.jsx(De,{color:"secondary",onClick:()=>u(x.id_perjanjian_pokok,a),"aria-label":"delete",size:"small",children:e.jsx(He,{})})})}],k=o.useMemo(()=>{if(!d)return s;const x=d.toLowerCase();return s.filter(F=>Object.values(F).some(P=>P==null?void 0:P.toString().toLowerCase().includes(x)))},[s,d]);return e.jsxs(re,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(b,{sx:{p:2,display:"flex",alignItems:"center"},children:e.jsx(me,{variant:"outlined",placeholder:"Cari...",size:"small",value:d,onChange:x=>h(x.target.value),sx:{marginRight:2}})}),e.jsx(he,{children:e.jsxs(pe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(xe,{children:e.jsx(W,{children:c.map(x=>e.jsx(C,{align:x.align,children:e.jsx(ze,{children:x.label})},x.id))})}),e.jsx(ge,{children:k.map(x=>e.jsx(W,{hover:!0,children:c.map(F=>{const P=F.cell?F.cell(x):x[F.id];return e.jsx(C,{align:F.align,children:P},F.id)})},x.id))})]})})]})},Ln=({formik:a,exchangeRates:i,errorMessage:n,dataSource:r,onUpdateData:t,onCloseError:u})=>{const l=new be,[p,d]=o.useState(null),[h,s]=o.useState(!1),[c,k]=o.useState([]),x=o.useMemo(()=>Object.keys(i).map(N=>({label:N,value:i[N]})),[i]),F=o.useCallback(N=>{var w;t(N),k(((w=N.information_jaminan)==null?void 0:w.perjanjian_pokok)||[])},[]),{loading:P,setLoading:v,onSaveInformasiPerjanjian:S,onDeleteInformasiPerjanjian:j}=ke(a,{onDataChange:F});o.useEffect(()=>{var N;k(((N=r.information_jaminan)==null?void 0:N.perjanjian_pokok)||[])},[r]);const y=async()=>{try{const N=a.values.information_jaminan||{};return a.setFieldValue("information_jaminan",N),!0}catch(N){console.error("Error resetting form fields:",N)}},M=async(N,w)=>{try{if(v(!0),!N)throw new Error("Pilih mata uang");if(w<=0)throw new Error("Nominal tidak valid");const I=localStorage.getItem("id_pendaftaran"),se=Ae(N.label,w,i),ce={id_pendaftaran:Number(I)||"",kurs:N.label,nilai_kurs:i[N.label],nilai_nominal:Number(w),nilai_nominal_rupiah:se,terbilang_nominal:Se(se)},fe=await S(ce,p,c);s(!1),d(null),await y()}catch(I){v(!1),console.error("Kesalahan:",I),l.customWarningMsg(I.message)}finally{v(!1)}},H=async N=>{if(await l.confirmationDelete())try{await j(N),await y()}catch(I){console.error("Error deleting row:",I)}},A=()=>{s(!0),y()},ie=N=>{d(N),s(!0)};return e.jsxs(b,{sx:{mt:3,mb:3},children:[e.jsx($e,{open:!!n,autoHideDuration:6e3,onClose:u,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ra,{onClose:u,severity:"error",sx:{width:"100%"},children:n})}),e.jsx(g,{variant:"h5",sx:{mb:2},children:"Informasi Perjanjian Pokok"}),e.jsx(oa,{title:"Informasi Perjanjian Pokok",buttonText:"+ Tambah",onButtonClick:A}),e.jsx(On,{data:c,formik:a,exchangeRates:i,onEditRow:ie,onDeleteRow:H,calculateNominalRupiah:Ae}),e.jsxs(K,{container:!0,spacing:3,sx:{mt:3},children:[e.jsx(K,{item:!0,xs:12,sm:6,md:6,children:e.jsx(f,{formik:a,name:"information_jaminan.nama_perjanjian",title:"Nama / Jenis Perjanjian",placeholder:"Tulis nama / jenis perjanjian",required:!0,fullWidth:!0,sx:{mb:2}})}),e.jsx(K,{item:!0,xs:12,sm:6,md:6,children:e.jsx(f,{formik:a,name:"information_jaminan.no_perjanjian",title:"Nomor Perjanjian",placeholder:"Tulis nomor perjanjian",required:!0,fullWidth:!0,sx:{mb:2}})}),e.jsx(K,{item:!0,xs:12,sm:6,md:6,children:e.jsx(m,{xs:"12",md:"12",lg:"12",xl:"12",children:e.jsx(f,{formik:a,name:"information_jaminan.tgl_perjanjian",title:"Tanggal Perjanjian",placeholder:"Pilih tanggal perjanjian",type:"date",required:!0,fullWidth:!0,sx:{mb:2}})})}),e.jsx(K,{item:!0,xs:6,sm:3,md:3,children:e.jsx(f,{formik:a,name:"information_jaminan.tgl_mulai_perjanjian",title:"Jangka Waktu Mulai",placeholder:"Tulis jangka waktu mulai",type:"date",required:!0,fullWidth:!0,sx:{mb:2}})}),e.jsx(K,{item:!0,xs:6,sm:3,md:3,children:e.jsx(f,{formik:a,name:"information_jaminan.tgl_akhir_perjanjian",title:"Jangka Waktu Selesai",placeholder:"Tulis jangka waktu selesai",type:"date",required:!0,fullWidth:!0,sx:{mb:2}})})]}),e.jsx(Mn,{open:h,loading:P,onClose:()=>s(!1),onSave:M,editingRow:p,formik:a,currencyData:x})]})},Jn=_a.memo(({formik:a,dataSource:i,onUpdateData:n})=>{const[r,t]=o.useState({}),[u,l]=o.useState([]),[p,d]=o.useState(null),h=o.useCallback(async()=>{try{const[c,k]=await Promise.all([da(),z.getFidusiaNotaris()]);t(c.data.rates);const x=k.data.map(F=>({value:F.id,label:F.nama||"Nama Notaris Tidak Tersedia"}));l(x)}catch(c){console.error("Gagal mengambil data awal:",c),d("Gagal mengambil data; silakan coba lagi.")}},[]);o.useEffect(()=>{h()},[h]);const s=o.useCallback(()=>{d(null)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(Vn,{formik:a,notarisOptions:u,onCloseError:s,errorMessage:p}),e.jsx(Ln,{formik:a,dataSource:i,onUpdateData:n,exchangeRates:r,errorMessage:p,onCloseError:s})]})}),zn=[{label:"OBJEK BERSERIAL NOMOR",value:"obyek_berseri_nomor"},{label:"OBJEK TIDAK BERSERIAL NOMOR",value:"obyek_tidak_berseri_nomor"}],ca=[{value:"0-50000000",label:"Sampai Rp 50.000.000",harga:"50.000"},{value:"50000001-100000000",label:"Diatas Rp 50.000.000 Sampai Dengan Rp 100.000.000",harga:"100.0000"},{value:"100000001-250000000",label:"Diatas Rp 100.000.000 Sampai Dengan Rp 250.000.000",harga:"200.0000"},{value:"250000001-500000000",label:"Diatas Rp 250.000.000 Sampai Dengan Rp 500.000.000",harga:"450.0000"},{value:"500000001-1000000000",label:"Diatas Rp 500.000.000 Sampai Dengan Rp 1.000.000.000",harga:"850.0000"},{value:"1000000001-100000000000",label:"Diatas Rp 1.000.000.000 Sampai Dengan Rp 100.000.000.000",harga:"1.800.000"},{value:"100000000001-500000000000",label:"Diatas Rp 100.000.000.000 Sampai Dengan Rp 500.000.000.000",harga:"3.500.000"},{value:"500000000001-1000000000000",label:"Diatas Rp 500.000.000.000 Sampai Dengan Rp 1.000.000.000.000",harga:"6.800.000"},{value:"1000000000001-max",label:"Diatas Rp 1.000.000.000.000",harga:"13.000.000"}],ae=({label:a,isEdit:i=!0,onEdit:n,padding:r=1,disabled:t=!1})=>e.jsxs(b,{sx:{backgroundColor:"#EFF7FF",padding:1,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,height:"48px",width:"100%"},children:[e.jsx(g,{sx:{color:"#041662",fontFamily:"Poppins",fontWeight:500,fontSize:"14px",lineHeight:"24px"},children:a}),i&&e.jsx(ne,{variant:"outlined",startIcon:e.jsx(Ka,{}),onClick:n,disabled:t,sx:{color:"#041662",borderColor:"#041662",textTransform:"none",padding:"4px 12px",height:"32px",fontSize:"12px","&:hover":{backgroundColor:"rgba(4, 22, 98, 0.1)",borderColor:"#041662"}},children:"Ubah"})]}),ua=(a,i)=>{const[n,r]=o.useState(a);return o.useEffect(()=>{const t=setTimeout(()=>{r(a)},i);return()=>{clearTimeout(t)}},[a,i]),n},Hn=({objectJaminan:a})=>(Math.max(...a.map(i=>i.value_jenis_kategori.length)),e.jsxs(b,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,color:"#041662",marginBottom:2},children:"Jenis Obyek Jaminan"}),a.map((i,n)=>e.jsxs(b,{sx:{marginBottom:4},children:[e.jsx(g,{variant:"subtitle1",sx:{fontWeight:500,color:"#333",marginBottom:1},children:e.jsx(ae,{label:`Obyek Jaminan ${n+1}`,isEdit:!1})}),e.jsx(he,{component:re,elevation:0,variant:"outlined",children:e.jsxs(pe,{size:"small",children:[e.jsx(xe,{children:e.jsxs(W,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(C,{sx:{fontWeight:600},children:"Informasi Obyek"}),e.jsx(C,{sx:{fontWeight:600},children:"Detail"})]})}),e.jsxs(ge,{children:[e.jsxs(W,{children:[e.jsx(C,{children:"Kategori Obyek"}),e.jsx(C,{children:i.kategori_obyek})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Sub Kategori Obyek"}),e.jsx(C,{children:i.jenis_kategori_obyek})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Kurs"}),e.jsx(C,{children:i.kurs})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Nominal"}),e.jsx(C,{children:de(Number(i.nilai_nominal))})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Nominal Rupiah"}),e.jsxs(C,{children:["Rp ",de(Number(i.nilai_nominal_rupiah))]})]})]})]})}),e.jsx(Ke,{sx:{my:2}}),e.jsx(he,{component:re,elevation:0,variant:"outlined",children:e.jsxs(pe,{children:[e.jsx(xe,{children:e.jsx(W,{sx:{backgroundColor:"#f5f5f5"},children:i.value_jenis_kategori.map(r=>e.jsx(C,{sx:{fontWeight:600,textAlign:"center"},children:r.nama||`Atribut ${r.id_atribut_jenis}`},r.id))})}),e.jsx(ge,{children:e.jsx(W,{children:i.value_jenis_kategori.map(r=>e.jsx(C,{sx:{textAlign:"center"},children:r.value||"-"},r.id))})})]})})]},i.id)),(!a||a.length===0)&&e.jsx(g,{variant:"body1",color:"textSecondary",align:"center",children:"Tidak ada data objek jaminan yang tersedia."})]})),je=({data:a,title:i,modul:n,col:r=2,spacing:t=2,variant:u="body2"})=>{const l=()=>e.jsx(K,{item:!0,xs:12,children:a.map((h,s)=>{var c;return e.jsxs(b,{sx:{display:"flex",alignItems:"center",marginBottom:1},children:[e.jsx(g,{variant:u,component:"div",sx:{width:"40%",paddingRight:1,marginRight:r===1?"10px":0,display:"flex",alignItems:"center",mb:1},children:h.label}),e.jsx("span",{style:{marginLeft:5,marginRight:10,color:"rgba(0,0,0,0.6)"},children:":"}),e.jsx(g,{variant:u,component:"div",sx:{width:"60%"},children:h.label==="File Juknis"?e.jsx(Me,{href:(c=h.value)==null?void 0:c.url,target:"_blank",rel:"noopener noreferrer",children:h.value}):h.value||"-"})]},s)})}),p=h=>{const s=Math.ceil(h.length/2);return[h.slice(0,s),h.slice(s)]},d=()=>{const[h,s]=p(a);return e.jsxs(e.Fragment,{children:[e.jsx(K,{item:!0,xs:12,sm:6,children:h.map((c,k)=>{var x;return e.jsxs(b,{sx:{display:"flex",alignItems:"center",marginBottom:1},children:[e.jsx(g,{variant:u,component:"div",sx:{width:r===1?"40%":"50%",paddingRight:1,marginRight:r===1?"10px":0,display:"flex",alignItems:"center",mb:1},children:c.label}),e.jsx("span",{style:{marginLeft:5,marginRight:10,color:"rgba(0,0,0,0.6)"},children:":"}),e.jsx(g,{variant:u,component:"div",sx:{width:"50%"},children:c.label==="File Juknis"?e.jsx(Me,{href:(x=c.value)==null?void 0:x.url,target:"_blank",rel:"noopener noreferrer",children:c.value}):c.value||"-"})]},k)})}),e.jsx(K,{item:!0,xs:12,sm:6,children:s.map((c,k)=>{var x;return e.jsxs(b,{sx:{display:"flex",alignItems:"center",marginBottom:1},children:[e.jsx(g,{variant:u,component:"div",sx:{width:r===1?"30%":"50%",paddingRight:1,marginRight:r===1?"10px":0,display:"flex",alignItems:"center"},children:c.label}),e.jsx("span",{style:{marginLeft:5,marginRight:10,color:"rgba(0,0,0,0.6)"},children:":"}),e.jsx(g,{variant:u,component:"div",sx:{width:"50%"},children:c.label==="File Juknis"?e.jsx(Me,{href:(x=c.value)==null?void 0:x.url,target:"_blank",rel:"noopener noreferrer",children:c.value}):c.value||"-"})]},k)})})]})};return e.jsxs(b,{sx:{width:"100%",padding:1},children:[i&&e.jsx(g,{variant:"h6",gutterBottom:!0,sx:{marginBottom:2,fontWeight:"bold"},children:i}),e.jsx(K,{container:!0,spacing:t,sx:{display:"flex"},children:r===1?l():d()})]})};Re.locale("id");const $n=(a=[])=>a.reduce((i,n)=>i+(n.nilai_nominal_rupiah||0),0),Un=a=>{for(const i of ca){const[n,r]=i.value.split("-").map(t=>t==="max"?1/0:Number(t));if(a>=n&&a<=r)return{kategori:i.label,hargaVoucher:i.harga}}return{kategori:"",hargaVoucher:"0"}},Gn=({formik:a,setActiveStep:i})=>{const[n,r]=o.useState({identityPemberi:{},identityPenerima:[],informationJaminan:{},objectJaminan:[]}),{identityPemberi:t,identityPenerima:u,informationJaminan:l,objectJaminan:p}=n,{loading:d,error:h,data:s,onFetchLoadFidusiaPendaftaran:c}=ke(a,{onDataChange:w=>{r({identityPemberi:w.identity_pemberi||{},identityPenerima:w.identity_penerima||[],informationJaminan:w.information_jaminan||{},objectJaminan:w.object_jaminan||[]})}}),k=o.useMemo(()=>$n(p),[p]),x=ua(k,300),{kategori:F,hargaVoucher:P}=o.useMemo(()=>Un(x),[x]),v=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(k);o.useMemo(()=>{a.setFieldValue("total_nominal_rupiah",k),a.setFieldValue("harga_voucher",P),a.setFieldValue("kategori_penjaminan",F)},[k,P,F]),o.useEffect(()=>{(async()=>{try{await c()}catch(I){console.error("Failed to fetch data:",I)}})()},[c]);const S=[{label:"Jenis Pendaftaran",value:(t==null?void 0:t.jenis_pendaftar)||"-"},{label:"Jenis Korporasi",value:(t==null?void 0:t.jenis_korporasi_text)||"-"},{label:"Jenis Sub Korporasi",value:(t==null?void 0:t.sub_jenis_korporasi)||"-"},{label:"Jenis Badan Hukum",value:(t==null?void 0:t.badan_hukum_text)||"-"}],j=[{label:"Nama Pemberi",value:(t==null?void 0:t.nama)||"-"},{label:"NPWP",value:(t==null?void 0:t.npwp)||"-"},{label:"Nomor Surat Keputusan",value:(t==null?void 0:t.no_sk)||"-"},{label:"Nama Kantor Cabang",value:(t==null?void 0:t.nama_kantor)||"-"},{label:"Email",value:(t==null?void 0:t.email)||"-"},{label:"Nomor Telepon",value:(t==null?void 0:t.no_tlpon)||"-"},{label:"Nama Debitur",value:(t==null?void 0:t.nama_debitur)||"-"}],y=[{label:"Alamat",value:(t==null?void 0:t.alamat)||"-"},{label:"Provinsi",value:(t==null?void 0:t.provinsi_text)||"-"},{label:"Kabupaten/Kota",value:(t==null?void 0:t.kabupaten_text)||"-"},{label:"Kecamatan",value:(t==null?void 0:t.kecamatan_text)||"-"},{label:"Kelurahan",value:(t==null?void 0:t.kelurahan_text)||"-"},{label:"RT",value:(t==null?void 0:t.rt)||"-"},{label:"RW",value:(t==null?void 0:t.rw)||"-"},{label:"Kode Pos",value:(t==null?void 0:t.kode_pos)||"-"}],M=[{label:"Nomor Akta",value:(l==null?void 0:l.nomor_akta_notaris)||"-"},{label:"Nama Notaris/Kedudukan",value:(l==null?void 0:l.nama_notaris)||"-"},{label:"Tanggal Akta",value:l!=null&&l.tgl_akta?Re(l.tgl_akta).format("DD MMMM YYYY"):"-"}],H=[{label:"Nama/Jenis Perjanjian",value:(l==null?void 0:l.nama_perjanjian)||"-"},{label:"Nomor Perjanjian",value:(l==null?void 0:l.no_perjanjian)||"-"},{label:"Tanggal Perjanjian",value:(l==null?void 0:l.tgl_perjanjian)||"-"},{label:"Jangka Waktu Perjanjian",value:`${(l==null?void 0:l.tgl_mulai_perjanjian)||"-"} s/d ${(l==null?void 0:l.tgl_akhir_perjanjian)||"-"}`}],A=(l==null?void 0:l.perjanjian_pokok)||[],ie=p||[],N=w=>{i(w)};return e.jsxs(L,{children:[e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Jenis Pemberi Fidusia",onEdit:()=>N(1)}),e.jsx(je,{data:S})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Informasi Pemberi Fidusia",onEdit:()=>N(1)}),e.jsx(je,{data:j})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Alamat Pemberi Fidusia",onEdit:()=>N(1)}),e.jsx(je,{data:y})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Informasi Penerima Fidusia",onEdit:()=>N(2)}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"NPWP"}),e.jsx("th",{children:"No Telepon"}),e.jsx("th",{children:"Jenis Korporasi"})]})}),e.jsx("tbody",{children:u==null?void 0:u.map((w,I)=>e.jsxs("tr",{children:[e.jsx("td",{children:(w==null?void 0:w.nama)||"-"}),e.jsx("td",{children:(w==null?void 0:w.npwp)||"-"}),e.jsx("td",{children:(w==null?void 0:w.no_tlpon)||"-"}),e.jsx("td",{children:(w==null?void 0:w.sub_jenis_korporasi)||"-"})]},I))})]})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Akta Notaris Jaminan Fidusia",onEdit:()=>N(3)}),e.jsx(je,{data:M,col:1})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:" Perjanjian Pokok",onEdit:()=>N(3)}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kurs"}),e.jsx("th",{children:"Nominal"}),e.jsx("th",{children:"Nominal Rupiah"}),e.jsx("th",{children:"Sebutan"})]})}),e.jsx("tbody",{children:A==null?void 0:A.map((w,I)=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"5%"},children:w.kurs||"-"}),e.jsx("td",{children:w.nilai_nominal||"-"}),e.jsxs("td",{style:{width:"30%"},children:["Rp ",de(Number(w.nilai_nominal_rupiah))||"-"]}),e.jsx("td",{style:{width:"40%"},children:Se(w.nilai_nominal_rupiah)||"-"})]},I))})]}),e.jsx(je,{data:H})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:"Jenis Objek Jaminan",onEdit:()=>N(4)}),e.jsx(Hn,{objectJaminan:n.objectJaminan})]}),e.jsxs(m,{xs:"12",md:"12",className:"mb-4",children:[e.jsx(ae,{label:" Nilai Penjaminan",onEdit:()=>N(4)}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kurs"}),e.jsx("th",{children:"Nominal"}),e.jsx("th",{children:"Nominal Rupiah"}),e.jsx("th",{children:"Sebutan"})]})}),e.jsx("tbody",{children:ie==null?void 0:ie.map((w,I)=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"5%"},children:w.kurs||"-"}),e.jsx("td",{children:w.nilai_nominal||"-"}),e.jsxs("td",{style:{width:"30%"},children:["Rp ",de(Number(w.nilai_nominal_rupiah))||"-"]}),e.jsx("td",{style:{width:"40%"},children:Se(w.nilai_nominal_rupiah)||"-"})]},I))})]}),e.jsx(je,{data:H}),e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(g,{variant:"body1",color:"text.primary",sx:{fontWeight:500},children:"Total Nilai Penjaminan"}),e.jsx(g,{variant:"h5",color:"primary",sx:{fontWeight:700,color:"#041662",letterSpacing:"-0.5px"},children:v})]}),e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:1.5,marginBottom:1.5,paddingTop:1.5,paddingBottom:1.5,borderTop:"1px solid #E5E7EB",borderBottom:"1px solid #E5E7EB"},children:[e.jsx(g,{variant:"body1",color:"text.primary",sx:{fontWeight:500},children:"Harga Voucher"}),e.jsxs(g,{variant:"h6",sx:{fontWeight:600,color:"#12B76A",letterSpacing:"-0.5px"},children:["Rp ",P]})]})]})]})},Yn=({formik:a,fontSize:i,checked:n,onChange:r})=>{const t=u=>{const l=u.target.checked;r&&r(l),a.setFieldValue("object_jaminan.aggrement",l)};return e.jsx(za,{control:e.jsx(ka,{checked:n,onChange:t,color:"primary"}),label:e.jsx("span",{style:{fontSize:i},children:"Saya setuju dengan syarat & ketentuan"})})},Xn=({formik:a,aggrement:i,onAggrementChange:n})=>{const[r,t]=o.useState(""),u=l=>{n(l),t(l?"":"Anda harus menyetujui syarat & ketentuan.")};return e.jsxs("div",{style:{marginLeft:"2rem"},children:[r&&e.jsx("p",{style:{color:"red"},children:r}),e.jsx(Yn,{formik:a,fontSize:"1rem",value:"object_jaminan.aggrement",onChange:u}),["Seluruh data yang saya isi dalam permohonan Pendaftaran Jaminan Fidusia adalah benar dan menjadi tanggung jawab saya sebagai pemohon.","Kementerian Hukum dan Hak Asasi Manusia Republik Indonesia tidak bertanggung jawab atas kebenaran materiil data yang diajukan, termasuk kesalahan pengisian.","Data elektronik dan penyimpanan dokumen fisik sepenuhnya menjadi tanggung jawab Penerima Fidusia, kuasa, atau wakilnya."].map((l,p)=>e.jsxs("p",{style:{marginLeft:"2rem"},children:[p+1,". ",l]},p))]})},Qn=({formik:a,currencyData:i,onCancel:n,onSave:r,subKategoriOptions:t,atributOptions:u,loadingAtributes:l,loadingPost:p})=>{const{object_jaminan:d}=a.values,[h,s]=o.useState(""),c=d.kategori_obyek,k=d.id_jenis_kategori_obyek,x=d.nilai_nominal,F=()=>!c||!k||!h||!x?!1:d.value_jenis_kategori.every(S=>S&&S.value.trim()!==""),P=()=>{if(!F()){toastifyService.customWarningMsg("Harap isi semua field yang diperlukan.");return}const v=d.value_jenis_kategori.map((j,y)=>({id_atribut_jenis:y+1,value:j.value}));r({kategori_obyek:c,id_jenis_kategori_obyek:k,valueJenisKategori:v,nilai_nominal:x,kurs:h})};return e.jsxs(e.Fragment,{children:[e.jsxs(K,{container:!0,spacing:2,children:[e.jsx(K,{item:!0,xs:12,md:6,children:e.jsx(O,{formik:a,name:"object_jaminan.kategori_obyek",title:"Kategori Objek *",placeholder:"Pilih kategori objek",select:!0,fullWidth:!0,options:zn,onChange:v=>{a.setFieldValue("object_jaminan.kategori_obyek",v.target.value),a.setFieldValue("object_jaminan.id_jenis_kategori_obyek","")},required:!0})}),c&&e.jsx(K,{item:!0,xs:12,md:6,children:e.jsx(O,{formik:a,name:"object_jaminan.id_jenis_kategori_obyek",title:"Sub Kategori Objek *",placeholder:"Pilih sub kategori objek",select:!0,fullWidth:!0,options:t,onChange:v=>{a.setFieldValue("object_jaminan.id_jenis_kategori_obyek",Number(v.target.value))},required:!0})})]}),c?k?e.jsxs(e.Fragment,{children:[k&&l?e.jsx(Fe,{count:4}):u.map((v,S)=>{var j;return e.jsx(K,{item:!0,xs:12,md:6,children:e.jsx(f,{formik:a,name:`object_jaminan.value_jenis_kategori.${S}.value`,title:v.label,placeholder:`Masukkan ${v.label}`,fullWidth:!0,required:!0,value:((j=a.values.object_jaminan.value_jenis_kategori[S])==null?void 0:j.value)||"",onChange:y=>{const M=y.target.value;a.setFieldValue(`object_jaminan.value_jenis_kategori.${S}`,{id_atribut_jenis:v.id_atribut_jenis,value:M})}})},v.id_atribut_jenis)}),e.jsxs(K,{container:!0,spacing:2,children:[e.jsx(K,{item:!0,xs:12,md:6,children:e.jsx(sa,{isMulti:!1,formik:a,fieldName:"object_jaminan.kurs",data:i,value:h,label:"Pilih mata uang",required:!0,isDisabled:!1,onChange:v=>{s(v),a.setFieldValue("object_jaminan.kurs",v.label)}})}),e.jsx(K,{item:!0,xs:12,md:6,children:e.jsx(f,{formik:{...a,setFieldValue:(v,S)=>{a.setFieldValue(v,Number(S))}},name:"object_jaminan.nilai_nominal",title:"Jumlah Nilai *",placeholder:"Tulis jumlah nilai",fullWidth:!0})})]})]}):e.jsx(g,{variant:"body1",children:"Harap pilih sub kategori objek setelah memilih kategori."}):e.jsx(g,{variant:"body1",children:"Harap pilih kategori objek terlebih dahulu."}),e.jsxs(K,{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:[e.jsx(ne,{onClick:n,color:"primary",variant:"outlined",sx:{width:"20%",marginRight:"10px",fontSize:"14px",textTransform:"none",color:"#041662",borderColor:"#041662"},children:"Batal"}),e.jsx(ne,{onClick:P,disabled:!F()||p,color:"primary",variant:"contained",sx:{width:"20%",fontSize:"14px",textTransform:"none",backgroundColor:"#041662",color:"#fff","& .MuiButton-startIcon":{display:p?"none":"inline-flex"}},startIcon:e.jsx(Wa,{fontSize:"20px"}),children:p?e.jsx(Ie,{size:24,color:"inherit"}):"Simpan"})]})]})},Zn=({data:a=[],formik:i,onEditRow:n,onDeleteRow:r,calculateNominalRupiah:t})=>{const[u,l]=o.useState(""),p=a.map((s,c)=>({no:c+1,...s})),d=[{id:"no",label:"No",align:"center"},{id:"kurs",label:"KURS",align:"center"},{id:"nilai_nominal",label:"Nominal",align:"center",cell:s=>e.jsx(me,{variant:"outlined",size:"small",onChange:c=>{const k=parseFloat(c.target.value)||0,x=a.map(F=>F.id===s.id?{...F,nilai_nominal:k,nilai_nominal_rupiah:t(F.kurs,k)}:F);i.setFieldValue("information_jaminan.perjanjian_pokok",x)},value:s.nilai_nominal,type:"number"})},{id:"nilai_nominal_rupiah",label:"Nominal Rupiah",align:"center",cell:s=>{const c=s.nilai_nominal_rupiah!==void 0?s.nilai_nominal_rupiah:t(s.kurs,s.nilai_nominal);return la(c)}},{id:"terbilang_nominal",label:"Sebutan",align:"center",cell:s=>{const c=s.nilai_nominal_rupiah!==void 0?s.nilai_nominal_rupiah:t(s.kurs,s.nilai_nominal);return Se(c)+" Rupiah"}},{id:"actions",label:"Actions",align:"end",cell:s=>e.jsx(b,{sx:{display:"flex",gap:1},children:e.jsx(De,{color:"secondary",onClick:()=>r(s.id),"aria-label":"delete",size:"small",children:e.jsx(He,{})})})}],h=o.useMemo(()=>{if(!u)return p;const s=u.toLowerCase();return p.filter(c=>Object.values(c).some(k=>k==null?void 0:k.toString().toLowerCase().includes(s)))},[p,u]);return e.jsxs(re,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(b,{sx:{p:2,display:"flex",alignItems:"center"},children:e.jsx(me,{variant:"outlined",placeholder:"Cari...",size:"small",value:u,onChange:s=>l(s.target.value),sx:{marginRight:2}})}),e.jsx(he,{children:e.jsxs(pe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(xe,{children:e.jsx(W,{children:d.map(s=>e.jsx(C,{align:s.align,children:e.jsx(ze,{children:s.label})},s.id))})}),e.jsx(ge,{children:h.map(s=>e.jsx(W,{hover:!0,children:d.map(c=>{const k=c.cell?c.cell(s):s[c.id];return e.jsx(C,{align:c.align,children:k},c.id)})},s.id))})]})})]})},ei=(a=[])=>a.reduce((i,n)=>i+(n.nilai_nominal_rupiah||0),0),ai=a=>{for(const i of ca){const[n,r]=i.value.split("-").map(t=>t==="max"?1/0:Number(t));if(a>=n&&a<=r)return{kategori:i.label,hargaVoucher:i.harga}}return{kategori:"",hargaVoucher:"0"}},ni=({data:a=[],formik:i,exchangeRates:n,onEditRow:r,onDeleteRow:t,calculateNominalRupiah:u})=>{const l=o.useMemo(()=>ei(a),[a]),p=ua(l,300),{kategori:d,hargaVoucher:h}=o.useMemo(()=>ai(p),[p]),s=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(l);return o.useMemo(()=>{i.setFieldValue("total_nominal_rupiah",l),i.setFieldValue("harga_voucher",h),i.setFieldValue("kategori_penjaminan",d)},[l,h,d]),e.jsxs(e.Fragment,{children:[e.jsx(Ge,{title:"Nilai Penjaminan"}),e.jsx(g,{variant:"body2",sx:{marginBottom:2},children:"Jaminan ini diberikan untuk menjamin pelunasan utang pemberi fidusia sejumlah:"}),e.jsx(Zn,{data:a,formik:i,exchangeRates:n,onEditRow:r,onDeleteRow:t,calculateNominalRupiah:u}),e.jsx(b,{sx:{marginTop:4},children:e.jsx(me,{fullWidth:!0,label:"Kategori Nilai Penjaminan",value:d,InputProps:{disabled:!0},variant:"outlined",placeholder:"Pilih kategori nilai penjaminan"})}),e.jsxs(b,{sx:{marginTop:4,backgroundColor:"#F9FAFB",padding:2,borderRadius:2,border:"1px solid #E5E7EB"},children:[e.jsx(Ge,{title:"Total Harga Voucher",sx:{marginBottom:2}}),e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(g,{variant:"body1",color:"text.primary",sx:{fontWeight:500},children:"Total Nilai Penjaminan"}),e.jsx(g,{variant:"h5",color:"primary",sx:{fontWeight:700,color:"#041662",letterSpacing:"-0.5px"},children:s})]}),e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:1.5,paddingTop:1.5,borderTop:"1px solid #E5E7EB"},children:[e.jsx(g,{variant:"body1",color:"text.primary",sx:{fontWeight:500},children:"Harga Voucher"}),e.jsxs(g,{variant:"h6",sx:{fontWeight:600,color:"#12B76A",letterSpacing:"-0.5px"},children:["Rp ",h]})]})]})]})},ii=({formik:a,onCekObyek:i})=>e.jsxs(b,{sx:{marginBottom:2},children:[e.jsx(b,{sx:{backgroundColor:"#FFF3CD",borderRadius:2,padding:2,marginBottom:2},children:e.jsxs(g,{variant:"body2",color:"warning.main",children:[e.jsx("strong",{children:"PERHATIAN"}),e.jsx("br",{}),"Berdasarkan Undang-Undang Republik Indonesia Nomor 42 Tahun 1999 tentang Jaminan Fidusia Pasal 3, undang-undang ini tidak berlaku terhadap:",e.jsx("ul",{children:["Hak tanggungan yang berkaitan dengan tanah dan bangunan, sepanjang peraturan perundang-undangan yang berlaku mengatur bahwa jaminan atas benda tersebut wajib didaftarkan","Hipotek atas kapal yang terdaftar dengan isi kotak 20m³ (dua puluh meter kubik) atau lebih","Hipotek atas pesawat terbang","Gadai"].map((n,r)=>e.jsx("li",{children:n},r))})]})}),e.jsxs(b,{sx:{backgroundColor:"#FFF3CD",border:"1px solid #DEE2E6",borderRadius:2,padding:2,display:"flex",alignItems:"center"},children:[e.jsx(b,{children:e.jsx(g,{variant:"body2",color:"text.secondary",children:"Silahkan lakukan pengecekan objek terlebih dahulu untuk menghindari pendaftaran fidusia ganda."})}),e.jsx(ne,{variant:"contained",color:"info",startIcon:e.jsx(Ha,{}),onClick:i,sx:{textTransform:"none",paddingX:3,backgroundColor:"#fff",marginLeft:"10px",color:"blue","&:hover":{backgroundColor:"#fff",color:"#000"}},children:"Cek Objek"})]})]}),ti=({objectJaminan:a})=>(Math.max(...a.map(i=>i.value_jenis_kategori.length)),e.jsxs(b,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,color:"#041662",marginBottom:2},children:"Jenis Obyek Jaminan"}),a==null?void 0:a.map((i,n)=>e.jsxs(b,{sx:{marginBottom:4},children:[e.jsx(g,{variant:"subtitle1",sx:{fontWeight:500,color:"#333",marginBottom:1},children:e.jsx(ae,{label:`Obyek Jaminan ${n+1}`,isEdit:!1})}),e.jsx(he,{component:re,elevation:0,variant:"outlined",children:e.jsxs(pe,{size:"small",children:[e.jsx(xe,{children:e.jsxs(W,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(C,{sx:{fontWeight:600},children:"Informasi Obyek"}),e.jsx(C,{sx:{fontWeight:600},children:"Detail"})]})}),e.jsxs(ge,{children:[e.jsxs(W,{children:[e.jsx(C,{children:"Kategori Obyek"}),e.jsx(C,{children:i.kategori_obyek})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Sub Kategori Obyek"}),e.jsx(C,{children:i.jenis_kategori_obyek})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Kurs"}),e.jsx(C,{children:i.kurs})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Nominal"}),e.jsx(C,{children:de(Number(i.nilai_nominal))})]}),e.jsxs(W,{children:[e.jsx(C,{children:"Nominal Rupiah"}),e.jsxs(C,{children:["Rp ",de(Number(i.nilai_nominal_rupiah))]})]})]})]})}),e.jsx(Ke,{sx:{my:2}}),e.jsx(he,{component:re,elevation:0,variant:"outlined",children:e.jsxs(pe,{children:[e.jsx(xe,{children:e.jsx(W,{sx:{backgroundColor:"#f5f5f5"},children:i.value_jenis_kategori.map(r=>e.jsx(C,{sx:{fontWeight:600,textAlign:"center"},children:r.nama||`Atribut ${r.id_atribut_jenis}`},r.id))})}),e.jsx(ge,{children:e.jsx(W,{children:i.value_jenis_kategori.map(r=>e.jsx(C,{sx:{textAlign:"center"},children:r.value||"-"},r.id))})})]})})]},i.id)),(!a||(a==null?void 0:a.length)===0)&&e.jsx(g,{variant:"body1",color:"textSecondary",align:"center",children:"Tidak ada data objek jaminan yang tersedia."})]})),ri=({formik:a,dataSource:i,onUpdateData:n,aggrement:r,onAggrementChange:t})=>{const u=new be,[l,p]=o.useState({}),[d,h]=o.useState(!1),[s,c]=o.useState([]),[k,x]=o.useState([]),[F,P]=o.useState(!1),[v,S]=o.useState(!1),[j,y]=o.useState(0),[M,H]=o.useState([]),A=a.values.object_jaminan,ie=o.useCallback(q=>{n(q),H(q.object_jaminan||[])},[]),{data:N,onFetchLoadFidusiaPendaftaran:w}=ke(a,{onDataChange:ie});o.useEffect(()=>{H(i.object_jaminan||[])},[i]),o.useEffect(()=>{(async()=>{try{const T=await da();p(T.data.rates)}catch(T){console.error("Failed to fetch exchange rates:",T),u.customWarningMsg("Gagal mengambil data kurs. Menggunakan nilai default.")}})()},[]),o.useEffect(()=>{(async()=>{const T=localStorage.getItem("id_pendaftaran");if(T)try{const R=await z.getFidusiaPendaftaranObyekJaminan(T);if(R&&R.data){const $=Array.isArray(R.data)?R.data:[R.data];H($)}}catch(R){console.error("Failed to fetch obyek jaminan:",R),u.customWarningMsg("Gagal mengambil data obyek jaminan.")}})()},[]),o.useEffect(()=>{(async()=>{const T=A==null?void 0:A.kategori_obyek;if(T)try{const R=await z.getFidusiaPendaftaranSubKategori(T);if(R&&R.data){const $=R.data.map(Y=>({value:Y.id,label:Y.nama}));c($)}else c([])}catch(R){console.error("Failed to fetch sub kategoris:",R),c([])}else c([])})()},[A==null?void 0:A.kategori_obyek]),o.useEffect(()=>{(async()=>{P(!0);const T=A==null?void 0:A.id_jenis_kategori_obyek;if(T)try{const R=await z.getFidusiaPendaftaranAtribut(T);if(R&&R.message==="Success"){P(!1);const $=R.data.map(Y=>({value:Y.id,label:Y.nama}));x($)}else x([]);P(!1)}catch(R){P(!1),console.error("Failed to fetch attributes:",R),x([])}else x([])})()},[A==null?void 0:A.id_jenis_kategori_obyek]);const I=o.useMemo(()=>Object.entries(l).map(([q,T])=>({label:q,value:T})),[l]),se=()=>{},ce=()=>{a.setFieldValue("object_jaminan",{id:null,id_pendaftaran:null,id_jenis_kategori_obyek:null,kurs:"",nilai_kurs:"",nilai_nominal:"",nilai_nominal_rupiah:"",terbilang_nominal:"",value_jenis_kategori:[]})},fe=()=>{h(!0),ce()},qe=()=>{h(!1)},Pe=async q=>{S(!0);const{valueJenisKategori:T,nilai_nominal:R,kurs:$}=q;try{if(!$)throw new Error("Pilih mata uang");if(R<=0)throw new Error("Nominal tidak valid");const Y=localStorage.getItem("id_pendaftaran"),E=Ae($.label,R,l),D={id:M.length>0?M.length+1:1,id_pendaftaran:Number(Y)||"",id_jenis_kategori_obyek:A.id_jenis_kategori_obyek,kurs:$.label,nilai_kurs:l[$.label],nilai_nominal:R,nilai_nominal_rupiah:E,terbilang_nominal:Se(E),value_jenis_kategori:T},B=await z.postFidusiaPendaftaranObjectJaminan(D);if(B&&B.message==="Success")await w(),S(!1),H(V=>[...Array.isArray(V)?V:[],D]),u.successUpdate("Penerima Penjamin berhasil ditambahkan"),h(!1);else throw S(!1),new Error("Gagal menyimpan data, silakan coba lagi.")}catch(Y){S(!1),console.error("Error during save:",Y),u.customWarningMsg(Y.message||"Terjadi kesalahan saat menyimpan")}},Be=q=>{},Ue=async q=>{u.confirmationDelete().then(T=>{if(T)return Ve(q)})},Ve=async q=>{try{const T=await z.deleteFidusiaPendaftaranObyek(q);if(T&&T.message==="Success"){await w();const R=M.filter($=>$.id!==q);H(R),a.setFieldValue("information_jaminan.perjanjian_pokok",R),u.successUpdate("Data berhasil dihapus")}else throw new Error("Gagal menghapus data; silakan coba lagi.")}catch(T){console.error("Kesalahan saat menghapus:",T),u.customWarningMsg(T.message)}};return e.jsxs(e.Fragment,{children:[e.jsx(ii,{formik:a,onCekObyek:se}),e.jsx(le,{}),e.jsx(oa,{title:"Jenis Objek Jaminan",buttonText:"+ Tambah",onButtonClick:fe}),e.jsx(le,{}),d&&e.jsx(Qn,{formik:a,onCancel:qe,onSave:Pe,currencyData:I,subKategoriOptions:s,atributOptions:k,loadingAtributes:F,loadingPost:v}),e.jsx(le,{}),e.jsx(ti,{objectJaminan:M}),e.jsx(le,{}),e.jsx(ni,{data:M,formik:a,exchangeRates:l,onEditRow:Be,onDeleteRow:Ue,calculateNominalRupiah:Ae,totalNominalRupiah:j}),e.jsx(le,{}),e.jsx(Xn,{formik:a,aggrement:r,onAggrementChange:t})]})},si=Ne(re)(({theme:a})=>({borderRadius:12,padding:a.spacing(2),backgroundColor:"white",boxShadow:"none",border:`1px solid ${a.palette.divider}`,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"})),li=[{id:"bca",name:"Bank BCA",logo:Ze,type:"Virtual Account"},{id:"mandiri",name:"Bank Mandiri",logo:ea,type:"Virtual Account"},{id:"bri",name:"Bank BRI",logo:aa,type:"Virtual Account"},{id:"bni",name:"Bank BNI",logo:na,type:"Virtual Account"}],oi=({formik:a,selectedMethod:i,setSelectedMethod:n})=>{const r=t=>{console.log("Selecting Payment Method:",t),n(t),a.setFieldValue("payment.method",t)};return e.jsxs(b,{children:[e.jsx(g,{variant:"h5",align:"center",sx:{fontWeight:"bold",mb:2,color:"#1A237E"},children:"Metode Pembayaran"}),e.jsx(g,{variant:"body2",align:"center",color:"text.secondary",sx:{mb:3},children:"Silakan pilih metode pembayaran yang Anda inginkan"}),li.map(t=>e.jsx("div",{className:"form-check",children:e.jsxs(si,{onClick:()=>r(t.id),sx:{mb:2,border:i===t.id?"1px solid #1A237E":"1px solid #E0E0E0"},children:[e.jsxs("div",{className:"d-flex",children:[e.jsx("img",{src:t.logo,alt:t.name,style:{height:40,marginRight:16}}),e.jsxs("div",{children:[e.jsx(g,{variant:"subtitle1",sx:{fontWeight:"bold"},children:t.name}),e.jsx(g,{variant:"caption",color:"text.secondary",children:t.type})]})]}),e.jsx("input",{className:"form-check-input",type:"radio",name:"paymentMethod",id:`paymentMethod-${t.id}`,value:t.id,checked:i===t.id,onChange:()=>r(t.id)}),e.jsx("label",{className:"form-check-label",htmlFor:`paymentMethod-${t.id}`})]})},t.id))]})},Oe=()=>e.jsx(Ke,{sx:{borderBottom:"2px dashed #E7E7E7",width:"100%",my:1.5}}),di=Ne(b)(({theme:a})=>({height:"calc(100vh - 200px)",overflowY:"auto",scrollbarWidth:"none","-ms-overflow-style":"none","&::-webkit-scrollbar":{display:"none"}})),ci=({selectedMethod:a,dataPayment:i,formik:n})=>{const r="896 0822 5432 2312",[t,u]=o.useState({mbanking:!1,ibanking:!1}),[l,p]=o.useState(!1),[d,h]=o.useState(!1),s=x=>{h(!0),navigator.clipboard.writeText(x.replace(/\s/g,"")).then(()=>{p(!0),setTimeout(()=>p(!1),2e3),h(!1)})},c=Ne(b)(({theme:x})=>({display:"flex",alignItems:"center",backgroundColor:x.palette.info.light,color:x.palette.info.contrastText,padding:x.spacing(1),borderRadius:x.shape.borderRadius,marginTop:x.spacing(.5)})),k={bca:Ze,mandiri:ea,bri:aa,bni:na};return e.jsxs(di,{children:[e.jsx(g,{variant:"h5",align:"center",sx:{fontWeight:"bold",mb:1,color:"#1A237E"},children:"Pembayaran Voucher"}),e.jsx(g,{variant:"body2",align:"center",color:"text.secondary",sx:{mb:1},children:"Silakan lakukan pembayaran sebelum batas waktu yang ditentukan"}),e.jsx(b,{sx:{backgroundColor:"#1A237E",color:"white",p:1,borderRadius:"6px 6px 0px 0px"},children:e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(g,{variant:"subtitle2",children:"Total Pembayaran"}),e.jsxs(g,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Rp ",de(n.values.payment.tagihan)]})]})}),e.jsxs(b,{sx:{backgroundColor:"#E3F2FD",p:1,borderRadius:"0px 0px 6px 6px",mb:2},children:[e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(g,{variant:"body2",color:"text.secondary",children:"Bayar Dalam"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:"23 jam 59 menit 51 detik"})]}),e.jsx(g,{variant:"body2",color:"text.secondary",align:"right",children:"Jatuh tempo 06 Jul 2025, 11:22"})]}),e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("img",{src:k[a],alt:a,style:{height:32,width:32,objectFit:"contain"}}),e.jsxs(g,{variant:"subtitle2",sx:{fontWeight:"bold"},children:[a==="bca"?"Bank BCA":a==="mandiri"?"Bank Mandiri":a==="bri"?"Bank BRI":"Bank BNI"," ","(Virtual Account)"]})]}),e.jsx(Oe,{}),e.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(b,{sx:{flexGrow:1},children:[e.jsx(g,{variant:"subtitle2",color:"text.secondary",children:"Nomor Kode Billing"}),e.jsx(g,{variant:"h6",sx:{fontWeight:"bold",color:"#1A237E",letterSpacing:1},children:r})]}),e.jsx(fa,{title:"Salin Kode Billing",arrow:!0,children:e.jsx(De,{onClick:()=>s(r),sx:{color:"#1A237E",transition:"transform 0.2s","&:hover":{transform:"scale(1.1)",backgroundColor:"rgba(26, 35, 126, 0.1)"}},disabled:d,children:d?e.jsx(Ie,{size:24,color:"inherit"}):e.jsx(qa,{})})})]}),e.jsx(Oe,{}),e.jsx(c,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ba,{color:"info"}),e.jsx(g,{variant:"body2",children:"Proses verifikasi kurang dari 10 menit setelah pembayaran berhasil"})]})}),e.jsx($e,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:l,message:"Kode Billing berhasil disalin",autoHideDuration:2e3}),e.jsx(g,{variant:"caption",color:"text.secondary",sx:{mt:.5,mb:1,display:"block",fontStyle:"italic"},children:"Bayar pesanan ke Virtual Account di atas sebelum membuat pesanan kembali dengan Virtual Account agar nomor tetap sama."}),e.jsx(Oe,{}),e.jsxs(b,{sx:{backgroundColor:"#EFF7FF",padding:1,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",mb:t.mbanking?0:2,width:"100%"},onClick:()=>u(x=>({...x,mbanking:!x.mbanking})),children:[e.jsx(g,{sx:{color:"#041662",fontFamily:"Poppins",fontWeight:500,fontSize:"14px",lineHeight:"24px"},children:"Petunjuk Transfer mBanking"}),e.jsx(g,{children:t.mbanking?"▲":"▼"})]}),t.mbanking&&e.jsxs(b,{sx:{p:2,backgroundColor:"#F9F9F9",mb:2},children:[e.jsx(g,{variant:"body2",children:"1. Login ke mBanking-mu. Pilih Payment, kemudian pilih e-Commerce."}),e.jsx(g,{variant:"body2",children:"2. Pilih Penyedia Layanan: AHU Link, dan masukkan nomor Virtual Account."}),e.jsx(g,{variant:"body2",children:"3. Periksa informasi yang tertera di layar."})]}),e.jsxs(b,{sx:{backgroundColor:"#EFF7FF",padding:1,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",mb:t.ibanking?0:2,width:"100%"},onClick:()=>u(x=>({...x,ibanking:!x.ibanking})),children:[e.jsx(g,{sx:{color:"#041662",fontFamily:"Poppins",fontWeight:500,fontSize:"14px",lineHeight:"24px"},children:"Petunjuk Transfer iBanking"}),e.jsx(g,{children:t.ibanking?"▲":"▼"})]}),t.ibanking&&e.jsxs(b,{sx:{p:2,backgroundColor:"#F9F9F9"},children:[e.jsx(g,{variant:"body2",children:"1. Login ke iBanking-mu dan pilih menu Payment."}),e.jsx(g,{variant:"body2",children:"2. Masukkan nomor Virtual Account dan konfirmasi detail pembayaran."}),e.jsx(g,{variant:"body2",children:"3. Periksa kembali detail pesanan, lalu masukkan token dan selesaikan pembayaran."})]})]})},ui=Ne(re)(({theme:a})=>({borderRadius:16,padding:a.spacing(4),textAlign:"center",boxShadow:"0 12px 24px rgba(0,0,0,0.1)",backgroundColor:a.palette.background.default})),mi=Ne(Va)(({theme:a})=>({fontSize:120,color:a.palette.success.main,marginBottom:a.spacing(3)})),hi=({invoiceNumber:a="INV-2025-0001",bankName:i="Bank BCA",onBackToHome:n,dataPayment:r,onHandlePayment:t,formik:u})=>{const[l,p]=o.useState(!1),d=()=>{p(!0),setTimeout(()=>{t("SUKSES"),p(!1),n()},2e3)};return e.jsx(b,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ui,{elevation:3,children:e.jsxs(K,{container:!0,direction:"column",alignItems:"center",spacing:3,children:[e.jsx(K,{item:!0,children:e.jsx(mi,{})}),e.jsx(K,{item:!0,children:e.jsx(g,{variant:"h4",color:"primary",sx:{fontWeight:"bold",mb:2},children:"Pembayaran Berhasil"})}),e.jsx(K,{item:!0,children:e.jsxs(b,{sx:{bgcolor:"background.paper",p:3,borderRadius:2,textAlign:"center"},children:[e.jsxs(g,{variant:"body1",sx:{mb:1},children:["Nomor Invoice: ",a]}),e.jsxs(g,{variant:"h6",color:"primary",sx:{fontWeight:"bold"},children:["Rp.",de(u.values.payment.tagihan)]}),e.jsxs(g,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Dibayar melalui ",i.toUpperCase()]})]})}),e.jsx(K,{item:!0,sx:{width:"100%"},children:e.jsx(ne,{variant:"contained",color:"primary",fullWidth:!0,size:"large",sx:{borderRadius:8,py:1.5,fontWeight:"bold"},onClick:d,disabled:l,children:l?e.jsx(Ie,{size:24,color:"inherit"}):"Kembali ke Pembayaran"})}),e.jsx(K,{item:!0,children:e.jsx(g,{variant:"caption",color:"text.secondary",sx:{textAlign:"center"},children:"Simpan bukti pembayaran sebagai referensi Anda"})})]})})})},pi=({formik:a,onHandleClose:i,onHandlePayment:n})=>{const[r,t]=o.useState(1),[u,l]=o.useState(""),p=o.useCallback(async()=>{try{switch(r){case 1:if(!u){console.warn("Pilih metode pembayaran terlebih dahulu");return}t(2);break;case 2:t(3);break;case 3:const h=await a.validateForm();Object.keys(h).length===0?(a.setTouched(Object.keys(a.initialValues).reduce((s,c)=>(s[c]=!0,s),{})),t(3)):a.setTouched(Object.keys(h).reduce((s,c)=>(s[c]=!0,s),{}));break;default:console.warn("Invalid step")}}catch(h){console.error("Error in form validation:",h)}},[r,u,a]),d=o.useCallback(()=>{r>1&&t(h=>h-1)},[r]);return e.jsxs(e.Fragment,{children:[r===1&&e.jsx(oi,{formik:a,selectedMethod:u,setSelectedMethod:l}),r===2&&e.jsx(ci,{selectedMethod:u,onNext:p,formik:a}),r===3&&e.jsx(hi,{formik:a,bankName:`Bank ${u}`,onBackToHome:i,onHandlePayment:n}),r!==3&&e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",mt:3},children:[e.jsx(ne,{variant:"outlined",onClick:d,sx:{borderColor:"#1A237E",color:"#1A237E"},disabled:r===1,children:"Kembali"}),e.jsx(ne,{variant:"contained",disabled:u==="",sx:{backgroundColor:"#1A237E","&:hover":{backgroundColor:"#283593"}},onClick:p,children:r===1?"Selanjutnya":"Konfirmasi Pembayaran"})]})]})},xi=({show:a,handleClose:i,formik:n,handlePayment:r})=>e.jsxs(Ce,{show:a,onHide:i,dialogClassName:"modal-90w","aria-labelledby":"payment-method-modal",centered:!0,children:[e.jsx(Ce.Header,{closeButton:!0,children:e.jsx(Ce.Title,{id:"payment-method-modal",children:"Pilih Metode Pembayaran"})}),e.jsx(Ce.Body,{children:e.jsx(pi,{formik:n,onHandlePayment:r,onHandleClose:i})})]}),gi=({formik:a})=>{const i=new be,{payment:n}=a.values,[r,t]=o.useState(!1),u=h=>{t(h)},l=async h=>{var s,c;try{const k=h||ee.SUKSES;a.setFieldValue("payment.status",k),k===ee.SUKSES&&(i.customSuccessMsg("Pembayaran berhasil"),u(!1))}catch(k){i.customErrorMsg(((c=(s=k.response)==null?void 0:s.data)==null?void 0:c.message)||"Pembayaran gagal. Silakan coba lagi.")}},p=()=>{try{window.print()}catch{i.customErrorMsg("Gagal mengunduh bukti pembayaran")}},d=o.useMemo(()=>{const h=[{key:"Kode Voucher",value:(n==null?void 0:n.kode_voucher)||"-"},{key:"Nama Pemohon",value:(n==null?void 0:n.nama_pemohon)||"-"},{key:"Email Pemohon",value:(n==null?void 0:n.email_pemohon)||"-"},{key:"Nomor HP",value:(n==null?void 0:n.nomor_hp)||"-"},{key:"Wilayah",value:(n==null?void 0:n.wilayah)||"-"},{key:"Tanggal Transaksi",value:n!=null&&n.tanggal_transaksi?new Date(n==null?void 0:n.tanggal_transaksi).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):""},{key:"Tanggal Expired",value:n!=null&&n.tanggal_expired?new Date(n==null?void 0:n.tanggal_expired).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):""},{key:"Tagihan",value:(n==null?void 0:n.tagihan)||"-"},{key:"Status",value:(n==null?void 0:n.status)||"-"}];return h.map((s,c)=>e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",py:1,borderBottom:c<h.length-1?"1px solid":"none",borderColor:"divider",color:s.key==="Status"?s.value===ee.BELUM_BAYAR?"error.main":s.value===ee.SUKSES?"success.main":"inherit":"inherit",fontWeight:s.key==="Status"&&(s.value===ee.BELUM_BAYAR||s.value===ee.SUKSES)?"bold":"normal"},children:[e.jsx(g,{children:s.key}),e.jsx(g,{children:s.key==="Tagihan"?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s.value||0):s.value})]},c))},[n]);return e.jsxs(e.Fragment,{children:[e.jsx(ae,{label:"Tagihan Pembayaran",isEdit:!1}),e.jsxs(ya,{maxWidth:"sm",children:[e.jsxs(re,{elevation:3,sx:{p:3,borderRadius:2,textAlign:"center"},children:[e.jsx(b,{component:"img",src:wa,alt:"Kemenhumham Logo",sx:{height:100,mb:2,mx:"auto",display:"block"}}),e.jsx(g,{variant:"h5",gutterBottom:!0,children:"DIREKTORAT JENDERAL AHU"}),e.jsx(g,{variant:"subtitle1",color:"green",gutterBottom:!0,children:"BUKTI PEMESANAN NOMOR VOUCHER"}),e.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Pendaftaran Fidusia - Kementerian Hukum dan HAM"}),e.jsx(Ke,{sx:{my:2}}),d]}),e.jsxs(b,{sx:{display:"flex",justifyContent:"center",mt:3,gap:2,mb:4},children:[e.jsx(ne,{variant:"outlined",startIcon:e.jsx($a,{}),onClick:p,sx:{width:"auto",backgroundColor:"#fff",color:"#041662",border:"1px solid #041662"},children:"Download"}),e.jsx(ne,{startIcon:e.jsx(Ma,{}),variant:"contained",color:"primary",fullWidth:!0,disabled:(n==null?void 0:n.status)===ee.SUKSES,onClick:()=>u(!0),sx:{width:"auto",mr:1,backgroundColor:"#041662",color:"#fff",border:"1px solid transparent",px:2,py:1,textTransform:"initial","&:hover":{backgroundColor:"#041992",color:"#fff"}},children:(n==null?void 0:n.status)===ee.BELUM_BAYAR?"Bayar Sekarang":"Sudah Bayar"})]}),e.jsx(xi,{show:r,handleClose:()=>u(!1),formik:a,handlePayment:l})]})]})},ji={identity_penerima:"Identitas Penerima",information_jaminan:"Informasi Jaminan",object_jaminan:"Objek Jaminan",payment:"Pembayaran",perjanjia_pokok:"Perjanjian Pokok"};function Fi({label:a="Permohonan Pendaftaran Fidusia"}){var Y;const i=va(),[n,r]=o.useState(0),[t,u]=o.useState(new Set),[l,p]=o.useState({}),[d,h]=o.useState(new Set),s=new be,c=E=>t.has(E),[k,x]=o.useState(!1),[F,P]=o.useState(!1),v=localStorage.getItem("id_pendaftaran"),S=xn(v||void 0),j=Sa({validateOnBlur:!0,validateOnChange:!0,validateOnMount:!1,initialValues:mn,validationSchema:()=>hn(n),onSubmit:E=>{console.log("🚀 ~ Pendaftaran ~ values:",E),s.confirmationCreate().then(D=>{if(D){const B={...E};i("/fidusia/success",{state:{newEntry:B},replace:!0}),localStorage.removeItem("id_pendaftaran"),Le(2e3)}})}}),[y,M]=o.useState({}),H=o.useCallback(E=>{M(E)},[]),{loading:A,data:ie,error:N,onFetchLoadFidusiaPendaftaran:w}=ke(j,{onDataChange:H});o.useEffect(()=>{(async()=>{try{await w()}catch(D){console.error("Error fetching data:",D)}})()},[w]);const I=E=>{M(E)};o.useEffect(()=>{r(0),p({}),h(new Set)},[a]);const se=E=>{P(E)},ce=async()=>{try{x(!0);const E=we[n],{identity_pemberi:D,identity_penerima:B,information_jaminan:V,object_jaminan:Q}=y;if(n===4&&!F){s.customWarningMsg("Agreement must be checked!");return}const Z=Oa(E,{identity_pemberi:D,identity_penerima:B,information_jaminan:V,object_jaminan:Q});if(console.log("first invalidField",Z),Z){const G=ji[Z]||Z;s.customWarningMsg(`Data ${G} harus diisi terlebih dahulu!`);return}console.log("suekkk>>>");const U=await La(j,n,Je,we);if(console.log("first validationResult",U),U.ignored){console.log("validationResult.ignored",U),await fe();return}U.isValid?await qe():(p(G=>({...G,[n]:U.errors})),ta(j,U.errors))}catch(E){console.error("Error during step validation:",E)}finally{x(!1)}},fe=async()=>{await Le(1e3);const E={...l};delete E[n],p(E),h(D=>new Set([...D,n])),r(D=>D+1),u(D=>{const B=new Set(D.values());return B.delete(n),B})},qe=async()=>{var D;const E=await S(n,j,We);if(E){let B=((D=E.data)==null?void 0:D.id_pendaftaran)||localStorage.getItem("id_pendaftaran");B&&localStorage.setItem("id_pendaftaran",JSON.stringify(B));const V={...l};delete V[n],p(V),h(Q=>new Set([...Q,n])),r(Q=>Q+1),u(Q=>{const Z=new Set(Q.values());return Z.delete(n),Z})}},Pe=async E=>{let D=!1;const B={};for(let V=0;V<we.length;V++){if(V===2)continue;const Q=Je[V],Z=we[V];if(Q)try{const U=Z.reduce((G,ue)=>(G[ue]=j.values[ue],G),{});await Q.validate(U,{abortEarly:!1})}catch(U){D=!0;const G={};U.inner&&U.inner.forEach(ue=>{G[ue.path]=ue.message}),B[V]=G}}if(console.log("allStepErrors",B),!D)j.setFieldValue("status",E),j.submitForm();else{p(B);const V={};Object.values(B).forEach(G=>{Object.assign(V,G)}),j.setErrors(V);const Z=we.flat().reduce((G,ue)=>(G[ue]=!0,G),{});j.setTouched(Z),s.customWarningMsg("Terdapat kesalahan pada form. Mohon periksa kembali.");const U=Object.keys(B)[1];U&&r(parseInt(U))}},Be=[{id:"1",label:"Boarding",component:e.jsx(jn,{formik:j,setActiveStep:r,label:a})},{id:"2",label:"Identitas Pemberi",stepNumber:"Langkah 1",component:e.jsx(Fn,{formik:j})},{id:"3",label:"Identitas Penerima",stepNumber:"Langkah 2",component:e.jsx(Bn,{formik:j,dataSource:y,onUpdateData:I})},{id:"4",label:"Informasi Jaminan",stepNumber:"Langkah 3",component:e.jsx(Jn,{formik:j,dataSource:y,onUpdateData:I})},{id:"5",label:"Obyek Jaminan",stepNumber:"Langkah 4",component:e.jsx(ri,{formik:j,dataSource:y,onUpdateData:I,aggrement:F,onAggrementChange:se})},{id:"6",label:"Konfirmasi Data",stepNumber:"Langkah 5",component:e.jsx(Gn,{formik:j,setActiveStep:r})},{id:"7",label:"Pembayaran",stepNumber:"Langkah 6",component:e.jsx(gi,{formik:j})}],Ve={"Permohonan Pendaftaran Fidusia":["1","2","3","4","5","6","7"]}[a]||[],q=Be.filter(E=>Ve.includes(E.id)),T=q.filter(E=>E.stepNumber),R=T.findIndex(E=>{var D;return E.id===((D=q[n])==null?void 0:D.id)}),$=()=>{if(r(E=>E-1),n===5)return se(!1)};return A||k?e.jsx(ia,{open:A||k}):e.jsxs(b,{className:"bg-white page-content mb-4",sx:{width:"100%"},children:[T.length>0&&R>=0&&e.jsx("h3",{className:" mb-4",style:{fontWeight:500,fontSize:24,color:"#262626"},children:"Formulir Pendaftaran"}),T.length>0&&R>=0&&e.jsx(Na,{activeStep:R,alternativeLabel:!0,sx:{"& .MuiStepConnector-root":{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},"& .MuiStepConnector-line":{borderTopStyle:"dashed",borderTopWidth:2,color:"#E7E7E7"}},children:T.map((E,D)=>(c(D)&&(stepProps.completed=!1),e.jsx(Fa,{children:e.jsx(Pa,{StepIconComponent:({active:B,completed:V})=>e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",border:"1px solid #E7E7E7",backgroundColor:B||V?"#041662":"#fff",display:"flex",alignItems:"center",justifyContent:"center",color:B||V?"#fff":"#041662",transition:"all 0.3s ease"},children:D+1}),children:e.jsx("span",{style:{fontFamily:"Poppins",fontWeight:400,fontSize:"12px",lineHeight:"18px",color:"#888888"},children:E.label})})},E.id)))}),e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-5 mb-3 px-2",children:e.jsxs(b,{sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:2},children:[((Y=q[n])==null?void 0:Y.component)||"Unknown step",n>=1&&e.jsxs(b,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",pt:2,px:2},children:[e.jsx(ve,{text:"Kembali",bgColor:"transparent",border:"1px solid #E7E7E7",textColor:"#041662",disabled:n===0,onClick:$}),e.jsx(ve,{text:"Simpan Draft",bgColor:"#f97316",border:"1px solid #E7E7E7",textColor:"#fff",hoverColor:"#ea580c",disabled:n===0,onClick:()=>Pe("draf")}),e.jsx(ve,{loading:k,onClick:()=>{n===q.length-1?Pe("submit"):ce()},text:n===q.length-1?"Selesai":"Selanjutnya",rightIcon:e.jsx(Ea,{fontSize:"14"})})]})]})})})]})}export{Fi as default};
