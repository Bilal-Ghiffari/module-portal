import{j as a,aG as T,bU as D,bV as Sa,bW as Na,bX as va,r as m,A as ma,bw as Ea,s as ua,b as _,c as r,bY as y,bZ as Ta,b_ as ga,b$ as Aa,h as oa,c0 as A,c1 as _a,c2 as na,c3 as Ia,c4 as Fa,c5 as Da,c6 as qa,c7 as sa,w as ra,x as ta,p as z,q as j,c8 as U,T as da,a as Ka,u as Ca,c9 as Ra,ca as La,cb as Wa,cc as Ba,cd as Va,ce as Ma,cf as Ua,cg as za,ch as Ha}from"./index-1205c25f.js";import{D as Oa}from"./Drafts-646cb459.js";import{C as $a}from"./CustomStepConnector-aa249293.js";import{A as Ga,p as Ja,S as Ya}from"./image 34-1d1c55d7.js";import{c as Za}from"./coupon-42650ed8.js";import{J as Xa,T as Qa}from"./master-802def31.js";import{F as N}from"./AutoComplete-27dc5bf6.js";import{a as ae,p as xa,b as ee,c as ne,g as pa,F as O,s as se,d as la,r as ka,R as ja,L as te,S as re}from"./Banner-63305c10.js";import{M as ie}from"./MessageBox-20683b0c.js";import{f as q}from"./changeTimeIndo-f11d9ea6.js";import{R as oe,C as ha}from"./Row-7a989374.js";import{p as $}from"./fileValidation-c17bae19.js";import"./DialogActions-4f943394.js";import"./Card-9ea032c2.js";import"./CardContent-ef5ecefa.js";const le=({handleSubmit:e,handleNext:s,handleBack:n,handleDraft:d,activeStep:l,isSubmitting:h=!1,postLoading:c=!1,patchLoading:p=!1})=>{const o=l===5,t=l>0&&![3,4,5].includes(l);return a.jsxs(T,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",gap:0,pt:2,px:2},children:[l>1&&a.jsx(D,{text:"Kembali",bgColor:"transparent",border:"1px solid #E7E7E7",textColor:"#041662",onClick:n}),t&&a.jsx(D,{text:"Draft",bgColor:"#f97316",border:"1px solid #E7E7E7",textColor:"#fff",hoverColor:"#ea580c",onClick:d,rightIcon:a.jsx(Oa,{fontSize:"14px"}),loading:c||p}),!o&&a.jsx(D,{onClick:s,text:"Selanjutnya",bgColor:"#041662",hoverColor:"#1e40af",loading:c||p}),o&&a.jsx(D,{onClick:e,text:"Buat Permohonan",bgColor:"#041662",hoverColor:"#1e40af",loading:h})]})},de=le,pe=({steps:e,activeStep:s,isStepSkipped:n,isStepValid:d,isStepHasError:l})=>{const h=(c,p,o)=>{let t="#fff",i="#041662",u="#E7E7E7";return(p||o)&&(t="#041662",i="#fff",u="#041662"),a.jsx("div",{style:{width:24,height:24,borderRadius:"50%",border:`1px solid ${u}`,backgroundColor:t,display:"flex",alignItems:"center",justifyContent:"center",color:i,transition:"all 0.3s ease"},children:c+1})};return a.jsx(Sa,{activeStep:s,alternativeLabel:!0,connector:a.jsx($a,{}),children:e.map((c,p)=>{const o={};return n(p)?o.completed=!1:p<s&&(o.completed=!0),a.jsx(Na,{...o,children:a.jsx(va,{StepIconComponent:({active:t,completed:i})=>h(p,t,i),children:a.jsx("span",{style:{fontFamily:"Poppins",fontWeight:400,fontSize:"12px",lineHeight:"18px",color:"#888888"},children:c.label})})},c.id)})})},ue=pe;function he(){const[e,s]=m.useState(!1),[n,d]=m.useState(1),l=()=>{s(!0),d(1)},h=()=>{s(!1),d(1)},c=[{label:"Pewarganegaraan berdasarkan perkawinan campuran",value:"Pewarganegaraan berdasarkan perkawinan campuran"}],p=ma({enableReinitialize:!0,initialValues:{jumlahPembelian:1,subLayanan:""},validationSchema:Za,onSubmit:i=>{d(2)}}),o=()=>n===1?a.jsx(ua,{onSubmit:p.handleSubmit,children:a.jsxs(_,{children:[a.jsx(r,{xs:"12",children:a.jsx(y,{formik:p,name:"jumlahPembelian",placeholder:"Tulis jumlah pembelian",required:!0,type:"number",readonly:!0})}),a.jsx(r,{xs:"12",children:a.jsx(Ta,{formik:p,name:"subLayanan",placeholder:"Pilih sub layanan jasa hukum",options:c,required:!0})})]})}):n===2?a.jsx(ua,{children:a.jsx(_,{children:a.jsx(r,{xs:"12",children:a.jsxs("div",{children:[a.jsx("img",{src:Ja,alt:"Panduan Pembayaran",style:{maxWidth:"100%",margin:"16px 0"}}),a.jsx(D,{onClick:p.handleSubmit,text:"Download",leftIcon:a.jsx(Ya,{}),textColor:"#041662",bgColor:"transparent",border:"1px solid #E7E7E7",hoverColor:"#041992"}),a.jsx("p",{style:{color:"#6D6D6D",fontFamily:"Poppins",fontWeight:400,fontSize:"14px"},children:'Apabila telah melakukan pembayaran tetapi status pembayaran "belum bayar", Anda dapat melakukan konfirmasi pembayaran pada menu konfirmasi pembayaran.'}),a.jsx("p",{style:{color:"#6D6D6D",fontFamily:"Poppins",fontWeight:400,fontSize:"14px"},children:"Apabila masih terdapat kendala terkait pembayaran PNBP, Anda dapat melakukan konsultasi pada menu Konsultasi Pembayaran."}),a.jsx("p",{style:{color:"#6D6D6D",fontFamily:"Poppins",fontWeight:400,fontSize:"14px"},children:"Untuk panduan cara pembayaran dapat diakses pada link berikut."})]})})})}):null,t=()=>{if(n===1)return a.jsxs(a.Fragment,{children:[a.jsx(D,{text:"Kembali",onClick:h,textColor:"#041662",bgColor:"transparent",border:"1px solid #E7E7E7"}),a.jsx(D,{text:"Selanjutnya",rightIcon:a.jsx(ga,{}),onClick:p.handleSubmit,bgColor:"#041662",textColor:"#fff",hoverColor:"#041992"})]});if(n===2)return a.jsxs(a.Fragment,{children:[a.jsx(D,{text:"Sebelumnya",onClick:()=>d(1),textColor:"#041662",bgColor:"transparent",border:"1px solid #E7E7E7",hoverColor:"#041992"}),a.jsx(D,{onClick:()=>h(),text:"Selanjutnya",rightIcon:a.jsx(Aa,{})})]})};return a.jsxs(a.Fragment,{children:[a.jsx(Ea,{style:{textDecoration:"underline",color:"#041662",fontWeight:500,fontSize:"14px",fontFamily:"Poppins",textTransform:"initial"},onClick:l,children:"Beli Voucher di SIMPADHU"}),a.jsx(Ga,{open:e,onClose:h,title:"Pembelian Voucher",description:n===1?"Silahkan pilih layanan yang anda inginkan":"Berikut adalah bukti pemesanan voucher anda",actions:t(),children:o()})]})}const ce=({formik:e,setActiveStep:s,label:n})=>{m.useState("");const[d,l]=m.useState(!1),h=()=>{l(!0),!e.errors.voucher&&e.values.voucher?setTimeout(()=>{s(c=>c+1)},2e3):(e.setFieldTouched("voucher",!0),l(!1))};return a.jsx("div",{className:"page-content d-flex justify-content-center align-items-center px-2 mb-3",style:{fontFamily:"Poppins"},children:a.jsxs("div",{className:"d-flex flex-column w-100",style:{maxWidth:800},children:[a.jsx(_,{className:"justify-content-center mb-2",children:a.jsxs(r,{lg:"10",children:[a.jsx("h4",{style:{color:"#041662",fontWeight:500,fontSize:"28px",lineHeight:"52px"},children:"Permohonan Tetap Sebagai Warga Negara Indonesia"}),a.jsx("hr",{})]})}),a.jsx(_,{className:"justify-content-center mb-2",children:a.jsx(r,{lg:"10",children:a.jsx("p",{style:{color:"#5D5D5D",fontSize:"14px",fontWeight:500,lineHeight:"26px"},children:"Anda akan memulai proses permohonan tetap sebagai WNI. Pastikan Anda telah menyiapkan dokumen dan informasi yang dibutuhkan sebelum melanjutkan."})})}),a.jsx(_,{className:"justify-content-center mb-2",children:a.jsxs(r,{lg:"10",children:[a.jsx("p",{style:{color:"#5D5D5D",fontSize:"14px",lineHeight:"26px",fontWeight:500},children:"Untuk melanjutkan, Anda perlu memasukkan kode voucher pendaftaran terlebih dahulu."}),a.jsx(y,{formik:e,type:"text",name:"voucher",placeholder:"Tulis Kode Voucher Anda Di Sini",className:"mt-2 form-field-input"})]})}),a.jsx(_,{className:"justify-content-center",children:a.jsxs(r,{lg:"10",children:[a.jsx("p",{style:{color:"#5D5D5D",fontSize:"14px",lineHeight:"26px",fontWeight:500},children:"Jika Anda belum memiliki kode voucher, silakan melakukan pembelian melalui layanan SIMPADHU pada tautan berikut:"}),a.jsx(he,{})]})}),a.jsx(_,{className:"justify-content-center",children:a.jsx(r,{lg:"10",children:a.jsx(D,{bgColor:"#041662",textColor:"#fff",hoverColor:"#041992",text:"Mulai Pendaftaran",rightIcon:a.jsx(ga,{}),onClick:h,loading:d})})})]})})},me=({formik:e})=>{const{agama:s,negara:n,provinsi:d,kotakab:l,pekerjaan:h,statusKawin:c}=oa(p=>p.master);return a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Informasi Pribadi"}),a.jsxs(T,{className:"form-horizontal",children:[a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"nama_lengkap_pemohon",placeholder:"Tulis nama lengkap",title:"Nama Lengkap",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"nik_pemohon",placeholder:"Tulis NIK/NIT",title:"NIK/NIT",type:"number",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"tgl_lahir_pemohon",type:"date",placeholder:"Tanggal Lahir",title:"Tanggal Lahir",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_negara_lahir_pemohon",placeholder:"Negara Kelahiran",title:"Negara Kelahiran",options:n.data,required:!0})})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"jenis_kelamin_pemohon",placeholder:"Jenis Kelamin",options:Xa,title:"Jenis Kelamin",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"status_kawin_pemohon",placeholder:"Status Perkawinan",title:"Status Perkawinan",required:!0,readonly:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_kewarganegaraan_asal_pemohon",placeholder:"Indonesia",options:[{value:76,label:"Indonesia"}],title:"Kewarganegaraan Asal",required:!0,readonly:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_pekerjaan_pemohon",placeholder:"Jenis pekerjaan saat ini",options:h.data,title:"Pekerjaan",required:!0})})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_provinsi_pemohon",placeholder:"Pilih Provinsi",title:"Provinsi Kelahiran",options:d.data,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_kab_kota_pemohon",placeholder:"Pilih Kabupaten/Kota",title:"Kabupaten/Kota Kelahiran",options:l.data,required:!0,isDisabled:!e.values.id_provinsi_pemohon})})]})]})]})},ge=(e,s={})=>Array.isArray(e)?e.map(n=>{const{valueKey:d="id",labelKey:l="nama",lowercaseValue:h=!1,useSameLabelAndValue:c=!1}=s,p=n[l],o=c?p:h?String(n[d]).toLowerCase():n[d];return{label:p,value:o,raw:n}}):[],_e=({formik:e})=>{const{values:s,setFieldValue:n}=e,[d,l]=m.useState([]),[h,c]=m.useState(!1),{negara:p,provinsi:o}=oa(x=>x.master),t=s.tempat_tinggal_pemohon==="Dalam Negeri",i=s.tempat_tinggal_pemohon==="Luar Negeri",u=async x=>{if(!x){l([]);return}c(!0);try{const w=await ae(x);if(Array.isArray(w.data)){const b=ge(w.data,{valueKey:"id",labelKey:"nama",lowercaseValue:!1,useSameLabelAndValue:!1});l(b)}else console.warn("Expected array in response.data, got:",w.data),l([])}catch(w){console.error("Error fetching kota/kab:",w),l([])}finally{c(!1)}};return m.useEffect(()=>{t?n("id_negara_tinggal_pemohon",""):i&&(n("id_provinsi_tinggal_pemohon",""),n("id_kab_kota_tinggal_pemohon","")),s.tempat_tinggal_pemohon||(n("id_negara_tinggal_pemohon",""),n("id_provinsi_tinggal_pemohon",""),n("id_kab_kota_tinggal_pemohon",""))},[s.tempat_tinggal_pemohon,n,t,i]),m.useEffect(()=>{const x=s.id_provinsi_tinggal_pemohon;t&&x?u(x):l([])},[s.id_provinsi_tinggal_pemohon,t,n]),a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Data Alamat"}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(N,{formik:e,name:"tempat_tinggal_pemohon",title:"Tempat tinggal",placeholder:"tempat tinggal",options:Qa,required:!0})}),i&&a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(N,{formik:e,name:"id_negara_tinggal_pemohon",title:"Negara Tinggal",placeholder:"negara tinggal",options:p.data,required:i})}),t&&a.jsxs(a.Fragment,{children:[a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(N,{formik:e,name:"id_provinsi_tinggal_pemohon",title:"Provinsi",placeholder:"provinsi domisili",options:o.data,required:t})}),a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(N,{formik:e,name:"id_kab_kota_tinggal_pemohon",title:"Kabupaten/Kota",placeholder:"kabupaten/kota domisili",options:d,required:t,loading:h})})]})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(y,{formik:e,name:"no_hp_pemohon",title:"Nomor HP",placeholder:"Tulis nomor handphone aktif",type:"tel",required:!0,leftIcon:a.jsx(_a,{})})}),a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(y,{formik:e,name:"no_telp_pemohon",title:"Nomor Telepon Rumah",type:"tel",placeholder:"Tulis nomor telepon"})}),a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"4",children:a.jsx(y,{formik:e,name:"email_pemohon",placeholder:"Tulis alamat email aktif",title:"Email",required:!0})})]}),a.jsx(_,{children:a.jsx(r,{xs:"12",md:"12",lg:"12",xl:"12",children:a.jsx(y,{formik:e,name:"alamat_tinggal_pemohon",placeholder:"Tulis alamat lengkap domisili saat ini",title:"Alamat tinggal",type:"textarea",maxLength:"255",required:!0})})})]})},xe=({formik:e})=>a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Dokumen Kependudukan"}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:a.jsx(y,{formik:e,name:"no_akta_lahir_pemohon",title:"Nomor akta/Bukti kelahiran",placeholder:"Tulis nomor akta",required:!0})}),a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:a.jsx(y,{formik:e,name:"tgl_akta_lahir_pemohon",title:"Tanggal akta/Bukti kelahiran",placeholder:"Masukkan tanggal akta",type:"date",required:!0})})]})]}),ke=({formik:e})=>a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Dokumen Perkawinan"}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:a.jsx(y,{formik:e,title:"Nomor Akta Perkawinan / Buku Nikah / Laporan Kawin",name:"no_akta_kawin_pemohon",placeholder:"Tulis nomor akta perkawinan",required:!0})}),a.jsx(r,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:a.jsx(y,{formik:e,title:"Tanggal Akta Perkawinan / Buku Nikah",name:"tgl_akta_kawin_pemohon",placeholder:"Masukkan tanggal akta perkawinan",type:"date",required:!0})})]})]}),je=({formik:e})=>{const{negara:s,provinsi:n}=oa(d=>d.master);return a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Dokumen Perjalanan"}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(y,{formik:e,title:"Nomor Paspor RI",name:"no_paspor_ri_pemohon",placeholder:"Tulis nomor paspor",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(N,{formik:e,title:"Wilayah Terbit Paspor RI",name:"wilayah_paspor_ri_pemohon",placeholder:"Tulis lokasi terbit paspor RI",options:n.data,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(y,{formik:e,title:"Tanggal Kedaluwarsa Paspor RI",name:"tgl_exp_paspor_ri_pemohon",placeholder:"Masukkan tanggal kedaluwarsa paspor RI",type:"date",required:!0})})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(y,{formik:e,title:"Nomor Paspor Kebangsaan",name:"no_paspor_kebangsaan_pemohon",placeholder:"Tulis nomor paspor",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(N,{formik:e,title:"Wilayah Terbit Paspor Kebangsaan",name:"wilayah_paspor_kebangsaan_pemohon",placeholder:"Indonesia",options:s.data,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"4",xl:"4",children:a.jsx(y,{formik:e,title:"Tanggal Kedaluwarsa Paspor Kebangsaan",name:"tgl_exp_paspor_kebangsaan_pemohon",placeholder:"Masukkan tanggal kedaluwarsa paspor RI",type:"date",required:!0})})]})]})},be=({formik:e})=>a.jsxs(T,{className:"mt-3 mb-3",sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:"24px"},children:[a.jsx(me,{formik:e}),a.jsx(na,{}),a.jsx(_e,{formik:e}),a.jsx(na,{}),a.jsx(xe,{formik:e}),a.jsx(na,{}),a.jsx(ke,{formik:e}),a.jsx(na,{}),a.jsx(je,{formik:e})]});function fe({formik:e}){const s=m.useRef(null),n=m.useRef(null),d=new Date,[l,h]=m.useState(!1);m.useEffect(()=>{const o=e.values.suratPermohonan==="1";h(o),n.current&&(n.current.checked=o)},[e.values.suratPermohonan]);const c=o=>{const t=o.target.checked,i=t?"1":"";h(t),e.setFieldValue("suratPermohonan",i),e.setFieldTouched("suratPermohonan",!0)},p=async()=>{if(s.current){const o=await Fa(s.current,{scale:2}),t=o.toDataURL("image/png"),i=new Da("p","mm","a4"),u=i.internal.pageSize.getWidth(),x=i.internal.pageSize.getHeight(),w=u,b=o.height*u/o.width;let S=b,v=0;for(i.addImage(t,"PNG",0,v,w,b),S-=x;S>0;)v=S-b,i.addPage(),i.addImage(t,"PNG",0,v,w,b),S-=x;i.save("SuratPermohonan.pdf")}};return a.jsx("div",{className:"mt-5 mb-3 px-2 ",children:a.jsx(T,{sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:2},children:a.jsx(oe,{children:a.jsxs(ha,{children:[a.jsx(T,{sx:{border:"1px solid #e0e0e0",borderRadius:2,mb:3,maxWidth:890,margin:"0 auto"},children:a.jsxs("div",{ref:s,style:{padding:50,fontFamily:"Times New Roman",fontSize:12,lineHeight:1.6},children:[a.jsx("div",{className:"text-center",style:{fontSize:16,fontWeight:600,letterSpacing:.5,textTransform:"uppercase"},children:"FORMULIR PERNYATAAN TETAP SEBAGAI WARGA NEGARA INDONESIA"}),a.jsxs("div",{style:{fontSize:12,marginTop:30,lineHeight:1.6},children:[a.jsx("div",{children:"Saya yang bertanda tangan dibawah ini :"}),a.jsx("table",{style:{width:"100%",marginTop:20,marginBottom:47},children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{width:"2%"},children:"Nama Lengkap"}),a.jsxs("td",{style:{width:"5%"},children:[": ",e.values.nama_lengkap_pemohon]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Tempat/Tanggal Lahir"}),a.jsxs("td",{children:[": ",e.values.kab_kota_pemohon_text,", 24 Juli 2025"]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Jenis Kelamin"}),a.jsxs("td",{children:[": ",e.values.jenis_kelamin_pemohon]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Alamat Tempat Tinggal"}),a.jsxs("td",{children:[": ",e.values.alamat_tinggal_pemohon]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Pekerjaan"}),a.jsxs("td",{children:[": ",e.values.pekerjaan_pemohon_text]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Kewarganegaraan Suami/Istri"}),a.jsxs("td",{children:[": ",e.values.kewarganegaraan_pasangan_text]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Status Perkawinan"}),a.jsx("td",{children:": KAWIN DENGAN WARGA NEGARA ASING"})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Nama Lengkap Suami/Istri"}),a.jsxs("td",{children:[": ",e.values.nama_lengkap_pasangan]})]}),a.jsxs("tr",{children:[a.jsx("td",{children:"Nomor Paspor"}),a.jsxs("td",{children:[a.jsxs("div",{children:["1. Paspor Republik Indonesia",a.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[a.jsxs("li",{children:["nomor : ",e.values.no_paspor_ri_pemohon]}),a.jsxs("li",{children:["diterbitkan di:"," ",e.values.wilayah_paspor_ri_pemohon_text]}),a.jsxs("li",{children:["berlaku sampai dengan :"," ",q(e.values.tgl_exp_paspor_ri_pemohon)]})]})]}),a.jsxs("div",{children:["2. Paspor Kebangsaan",a.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[a.jsxs("li",{children:["nomor :"," ",e.values.no_paspor_kebangsaan_pemohon]}),a.jsxs("li",{children:["diterbitkan di:"," ",e.values.wilayah_paspor_kebangsaan_pemohon_text]}),a.jsxs("li",{children:["berlaku sampai dengan :"," ",q(e.values.tgl_exp_paspor_kebangsaan_pemohon)]})]})]})]})]})]})}),a.jsx("div",{style:{marginBottom:10},children:"Terlebih dahulu diterangkan :"}),a.jsxs("div",{style:{marginBottom:10},children:["Bahwa diindonesia, pada tanggal"," ",q(d),", telah dilangsungkan perkawinan antara saya dengan"," ",e.values.nama_lengkap_pasangan,"."]}),a.jsxs("div",{style:{marginBottom:10},children:["Bahwa suami saya (",e.values.nama_lengkap_pasangan,") adalah kewarganegaraan"," ",e.values.kewarganegaraan_pasangan_text||"undefined",". Bahwa berdasarkan uraian tersebut, saya dengan ini menyatakan untuk tetap mempertahankan kewarganegaraan saya, yaitu Kewarganegaraan Republik Indonesia dan menolak Kewarganegaraan suami saya, yaitu Kewarganegaraan"," ",e.values.kewarganegaraan_pasangan_text||"undefined","."]}),a.jsx("div",{style:{marginBottom:10},children:"Demikian surat pernyataan ini saya buat dengan sebenarnya tanpa adanya paksaan dan tekanan dari pihak lain manapun juga sehingga segala akibat yang mungkin timbul kemudian hari karena dibuatnya surat pernyataan ini akan menjadi tanggung jawab saya sepenuhnya"}),a.jsx("div",{style:{marginTop:50,display:"flex",justifyContent:"flex-end"},children:a.jsxs("div",{children:[a.jsxs("div",{style:{textAlign:"center"},children:["Indonesia, ",q(d)]}),a.jsx("div",{style:{textAlign:"center"},children:"Yang menyatakan"}),a.jsx("div",{style:{height:40}}),a.jsx("div",{style:{textAlign:"center",fontSize:12,marginTop:50,fontWeight:"bold"},children:e.values.nama_lengkap_pemohon})]})})]})]})}),a.jsxs(T,{sx:{border:"none",mb:3,maxWidth:890,margin:"0 auto"},children:[a.jsx(ha,{xs:"12",className:"d-flex flex-row gap-2 px-4",style:{marginBottom:"32px",marginTop:"32px"},children:a.jsxs(T,{sx:{borderRadius:2,mb:3,maxWidth:890,margin:"0 auto"},xs:"12",className:"d-flex flex-row gap-2 px-4 justify-content-between",style:{marginBottom:"32px",marginTop:"32px"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("label",{style:{display:"flex",alignItems:"flex-start",cursor:"pointer",fontSize:"0.95rem",lineHeight:"1.5",padding:"8px",border:l?"2px solid #28a745":e.errors.suratPermohonan&&e.touched.suratPermohonan?"2px solid #dc3545":"",borderRadius:"8px",backgroundColor:l?"#d4edda":e.errors.suratPermohonan&&e.touched.suratPermohonan?"#f8d7da":"white",transition:"all 0.3s"},children:[a.jsx("input",{ref:n,type:"checkbox",onChange:c,style:{marginRight:"12px",marginTop:"4px",transform:"scale(1.3)",cursor:"pointer"}}),a.jsx("span",{children:"Pastikan pengisian data yang telah anda isi sudah benar dan lengkap"})]}),e.errors.suratPermohonan&&e.touched.suratPermohonan&&a.jsxs("div",{style:{color:"#dc3545",fontSize:"12px",marginTop:"8px",marginLeft:"",fontWeight:"500"},children:["âš ï¸ ",e.errors.suratPermohonan]})]}),a.jsx(D,{text:"Download",leftIcon:a.jsx(Ia,{}),textColor:"#041662",bgColor:"transparent",border:"1px solid #E7E7E7",onClick:p,sx:{height:"45px"}})]})}),a.jsxs(ie,{type:"warning",children:["Semua dokumen yang perlu untuk diunggah harus disiapkan sebelum anda mendaftar secara online. Verifikator tidak akan menerima dokumen unggah yang dikirimkan setelah anda mendaftar online.",a.jsx("br",{}),a.jsx("br",{}),"Surat pernyataan ini harus diisi dan ditandatangani di atas materai oleh pemohon dan dilampirkan pada saat pendaftaran Notaris. Apabila ada hal yang kurang jelas silakan menghubungi: Subdit Sertifikasi Notariat, Direktorat Perdata, Direktorat Jenderal Administrasi Hukum Umum, Gedung Kementerian Hukum dan HAM, Jl. H.R. Rasuna Said Kav 6-7 Kuningan, Jakarta Selatan 12940, Telp (021) 5202393, pada hari kerja Senin-Jumat pada jam pelayanan permohonan HPI."]})]})]})})})})}const X={getPermohonanDetail:"/kewarganegaraan/permohonan-tetap-wni",postPermohonan:"/kewarganegaraan/permohonan-tetap-wni",patchPermohonan:"/kewarganegaraan/permohonan-tetap-wni",uploadFile:"/kewarganegaraan/permohonan-tetap-wni/upload"},we=e=>qa(`${X.getPermohonanDetail}/${e}`),ye=e=>ee(X.postPermohonan,e),Pe=e=>xa(X.patchPermohonan,e),Se=e=>ne(X.uploadFile,e),Ne=e=>xa(X.patchPermohonan,e),G=(e,s)=>{var d;if(!e||!Array.isArray(e)||e.length===0)return null;const n=e.filter(l=>l.file_type===s).sort((l,h)=>new Date(h.uploaded_at)-new Date(l.uploaded_at));return n.length===0?null:((d=n[0])==null?void 0:d.url)||null},W={kutipanAktaLahirPemohon:1,kutipanAktaPerkawinanAtauBukuNikah:2,dokumenPernahWNI:3,ktpAtauNIT:4,suratPernyataanPenolakanWNA:5,pasFoto:6},ve=Object.fromEntries(Object.entries(W).map(([e,s])=>[s,e])),Ee=({formik:e})=>{const s=pa("tetapwni"),n=e.values.files||[];m.useEffect(()=>{n.forEach(h=>{const c=ve[h.file_type];if(c){const p=e.values[c];(!p||p!==h)&&(console.log(`âœ… Updating ${c} with file data`),e.setFieldValue(c,h))}else console.warn(`âŒ No field mapping found for file_type: ${h.file_type}`)}),console.log("=== END SYNC FILES ===")},[n,e]);const l={uploadFnc:async(h,c)=>{var o;if(!s){const t="ID Permohonan tidak ditemukan. Silakan simpan draft terlebih dahulu.";throw sa(t),new Error(t)}const p=W[c];if(!p){const t=`Tipe dokumen tidak valid untuk field: ${c}`;throw sa(t),new Error(t)}if(!h){const t="File tidak valid";throw sa(t),new Error(t)}try{const t=new FormData;t.append("file",h),t.append("id_permohonan",s),t.append("file_type",p),console.log(`ðŸš€ Uploading file: ${h.name} for field: ${c} (type: ${p})`);const i=await Se(t);if(console.log("âœ… Upload response:",i),i.message==="Success"&&i.data){const u=i.data;console.log("ðŸ“ Updating formik with uploaded file data:",u);const x=[...n.filter(w=>w.file_type!==p),u];return e.setFieldValue("files",x),e.setFieldValue(c,u),e.setFieldError(c,void 0),console.log("âœ… Successfully updated formik:",{fieldName:c,uploadedFileData:u,updatedFilesCount:x.length}),ra(`Dokumen ${c} berhasil diunggah`),u}else throw new Error(((o=i.data)==null?void 0:o.message)||"Upload response format tidak valid")}catch(t){console.error("âŒ Upload error:",t);let i="Gagal mengunggah dokumen";if(t.code==="ECONNABORTED")i="Upload timeout. Periksa koneksi internet dan coba lagi.";else if(t.response){const u=t.response.status,x=t.response.data;switch(u){case 400:i=(x==null?void 0:x.message)||"Request tidak valid";break;case 401:i="Unauthorized. Silakan login ulang.";break;case 413:i="File terlalu besar";break;case 415:i="Tipe file tidak didukung";break;case 500:i="Server error. Silakan coba lagi nanti.";break;default:i=(x==null?void 0:x.message)||`Server error: ${u}`}}else t.request&&(i="Gagal terhubung ke server. Periksa koneksi internet.");throw ta(i),new Error(i)}}};return a.jsxs(T,{className:"mt-3 mb-3",sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:"24px"},children:[a.jsx(A,{title:"Upload Dokumen"}),a.jsxs(_,{children:[a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"kutipanAktaLahirPemohon",label:"Kutipan akta kelahiran pemohon yang telah disahkan oleh Pejabat atau Perwakilan Republik Indonesia",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.kutipanAktaLahirPemohon),required:!0,...l})}),a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"kutipanAktaPerkawinanAtauBukuNikah",label:"Kutipan akta perkawinan atau buku nikah pemohon yang telah disahkan oleh Pejabat atau Perwakilan Republik Indonesia",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.kutipanAktaPerkawinanAtauBukuNikah),required:!0,...l})}),a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"dokumenPernahWNI",label:"Paspor Republik Indonesia, surat sejenis paspor, atau dokumen lain yang membuktikan bahwa pemohon pernah menjadi WNI",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.dokumenPernahWNI),required:!0,...l})}),a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"ktpAtauNIT",label:"Kartu Tanda Penduduk (KTP) atau surat penerbitan Nomor Identitas Tunggal (NIT)",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.ktpAtauNIT),required:!0,...l})}),a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"suratPernyataanPenolakanWNA",label:"Surat pernyataan penolakan menjadi warga negara asing, dibuat di atas kertas bermaterai yang telah disetujui oleh perwakilan negara asing yang berwenang.",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.suratPernyataanPenolakanWNA),required:!0,...l})}),a.jsx(r,{lg:"12",xl:"12",children:a.jsx(O,{formik:e,name:"pasFoto",label:"Pas foto terbaru ukuran 4x6 cm, berwarna, latar belakang merah, berpakaian rapi dan sopan.",acceptedFileTypes:["application/pdf"],maxFileSizeMB:10,documentUrl:G(n,W.pasFoto),required:!0,...l})})]})]})},Te=({formik:e})=>{const{negara:s,agama:n}=oa(d=>d.master);return m.useEffect(()=>{e.setFieldValue("status_kawin_pasangan","Kawin")},[]),console.log(e.values),a.jsxs(T,{className:"mt-3 mb-3",sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:"24px"},children:[a.jsx(A,{title:"Informasi Data Pasangan"}),a.jsxs(T,{className:"form-horizontal",children:[a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"nama_lengkap_pasangan",placeholder:"Tulis nama lengkap",title:"Nama Lengkap",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_kewarganegaraan_pasangan",placeholder:"kewarganegaraan",title:"Kewarganegaraan",options:s.data,isDisabled:s.data.length===0,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"email_pasangan",placeholder:"Tulis alamat email aktif",title:"Email",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"no_hp_pasangan",placeholder:"Tulis nomor handphone aktif",title:"Nomor HP (diikuti kode negara)",leftIcon:a.jsx(_a,{}),type:"number",required:!0})})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"id_negara_lahir_pasangan",placeholder:"tempat lahir",title:"Negara Tempat Lahir",options:s.data,isDisabled:s.data.length===0,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"tgl_lahir_pasangan",placeholder:"Pilih tanggal lahir",title:"Tanggal Lahir",type:"date",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"12",xl:"6",children:a.jsx(y,{formik:e,name:"alamat_tinggal_pasangan",placeholder:"Tulis alamat lengkap domisili saat ini",title:"Alamat tinggal",type:"textarea",required:!0})})]}),a.jsxs(_,{children:[a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"status_kawin_pasangan",placeholder:"Kawin",title:"Status Perkawinan",options:[{value:"Kawin",label:"Kawin"}],readonly:!0,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(N,{formik:e,name:"agama_pasangan",placeholder:"agama",title:"Agama",options:n.data,required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"no_paspor_asing_pasangan",placeholder:"Tulis nomor paspor",title:"Nomor Paspor Asing",required:!0})}),a.jsx(r,{xs:"12",md:"12",lg:"6",xl:"3",children:a.jsx(y,{formik:e,name:"tgl_exp_paspor_asing_pasangan",placeholder:"Masukkan tanggal kedaluarsa",title:"Tanggal Kedaluarse Paspor",type:"date",required:!0})})]})]})]})},ia={0:z({voucher:j().required("Voucher wajib diisi")}),1:z({nama_lengkap_pemohon:j().min(2,"Nama lengkap minimal 2 karakter").max(100,"Nama lengkap maksimal 100 karakter").required("Nama lengkap wajib diisi"),nik_pemohon:j().matches(/^[0-9]{16}$/,"NIK harus terdiri dari 16 digit angka").required("NIK wajib diisi"),id_provinsi_pemohon:j().required("Provinsi wajib diisi"),id_kab_kota_pemohon:j().required("Kabupaten/Kota wajib diisi"),id_negara_lahir_pemohon:j().required("Negara asal wajib diisi"),tgl_lahir_pemohon:U().max(new Date,"Tanggal lahir tidak boleh di masa depan").required("Tanggal lahir wajib diisi"),jenis_kelamin_pemohon:j().required("Jenis kelamin wajib diisi"),status_kawin_pemohon:j().notRequired(),id_kewarganegaraan_asal_pemohon:j().notRequired(),id_pekerjaan_pemohon:j().required("Pekerjaan wajib diisi"),tempat_tinggal_pemohon:j().required("Tempat tinggal wajib diisi"),id_negara_tinggal_pemohon:j().when("tempat_tinggal_pemohon",{is:"Luar Negeri",then:e=>e.required("Negara wajib diisi"),otherwise:e=>e.notRequired()}),id_provinsi_tinggal_pemohon:j().when("tempat_tinggal_pemohon",{is:"Dalam Negeri",then:e=>e.required("Provinsi wajib diisi"),otherwise:e=>e.notRequired()}),id_kab_kota_tinggal_pemohon:j().when("tempat_tinggal_pemohon",{is:"Dalam Negeri",then:e=>e.required("Kabupaten atau kota wajib diisi"),otherwise:e=>e.notRequired()}),alamat_tinggal_pemohon:j().required("Alamat wajib diisi"),no_hp_pemohon:j().matches(/^[0-9]+$/,"Nomor telepon harus angka").required("Nomor handphone wajib diisi"),no_telp_pemohon:j().matches(/^[0-9]+$/,"Nomor telepon harus angka").required("Nomor telepon wajib diisi"),email_pemohon:j().email("Format email tidak valid").required("Email wajib diisi"),no_akta_lahir_pemohon:j().matches(/^[A-Za-z0-9\/-]+$/,"Nomor akta hanya boleh huruf, angka, '/' atau '-'").required("Nomor akta wajib diisi"),tgl_akta_lahir_pemohon:U().required("Tanggal akta wajib diisi"),no_akta_kawin_pemohon:j().matches(/^[A-Za-z0-9./-]+$/,"Nomor akta perkawinan hanya boleh huruf, angka, '.', '/' atau '-'").required("Nomor akta perkawinan wajib diisi"),tgl_akta_kawin_pemohon:U().required("Tanggal akta perkawinan wajib diisi"),no_paspor_ri_pemohon:j().matches(/^[A-Za-z0-9]{9}$/,"Nomor Paspor RI harus 9 karakter, hanya huruf dan angka").required("Nomor Paspor RI wajib diisi"),wilayah_paspor_ri_pemohon:j().min(2,"Wilayah terbit paspor minimal 2 karakter").max(50,"Wilayah terbit paspor maksimal 50 karakter").required("Wilayah terbit paspor wajib diisi"),tgl_exp_paspor_ri_pemohon:U().required("Tanggal kedaluwarsa paspor wajib diisi"),no_paspor_kebangsaan_pemohon:j().matches(/^[A-Za-z0-9\s\/-]+$/,"Nomor Paspor Kebangsaan hanya boleh huruf, angka, spasi, '/' atau '-'").min(5,"Nomor Paspor Kebangsaan minimal 5 karakter").max(30,"Nomor Paspor Kebangsaan maksimal 30 karakter").required("Nomor Paspor Kebangsaan wajib diisi"),wilayah_paspor_kebangsaan_pemohon:j().required("Wilayah terbit paspor kebangsaan wajib diisi"),tgl_exp_paspor_kebangsaan_pemohon:U().required("Tanggal kedaluwarsa paspor kebangsaan wajib diisi")}),2:z({nama_lengkap_pasangan:j().matches(/^[A-Za-zÃ€-Ã¿' -]+$/,"Nama hanya boleh berisi huruf, apostrof ('), dan tanda hubung (-)").min(2,"Nama lengkap minimal 2 karakter").max(100,"Nama lengkap maksimal 100 karakter").required("Nama lengkap wajib diisi"),id_kewarganegaraan_pasangan:j().required("Kewarganegaraan pasangan wajib diisi"),email_pasangan:j().email("Email tidak valid").required("Email wajib diisi"),no_hp_pasangan:j().matches(/^[0-9]{10,15}$/,"Nomor telepon harus terdiri dari 10 sampai 15 angka").required("Nomor telepon wajib diisi"),id_negara_lahir_pasangan:j().required("Negara lahir wajib diisi"),tgl_lahir_pasangan:U().required("Tanggal lahir wajib diisi"),alamat_tinggal_pasangan:j().max(200,"Alamat tidak boleh lebih 200 karakter").required("Alamat tinggal wajib diisi"),status_kawin_pasangan:j().notRequired(),agama_pasangan:j().required("Agama wajib diisi"),no_paspor_asing_pasangan:j().required("Nomor paspor asing wajib diisi").matches(/^[A-Z0-9]{6,9}$/,"Nomor paspor harus terdiri dari 6 sampai 9 huruf kapital dan angka tanpa spasi atau simbol"),tgl_exp_paspor_asing_pasangan:U().required("Tanggal kedaluarsa paspor wajib diisi")}),3:z({suratPermohonan:j().required("Setujui bahwa data yang diisi sudah sesuai")}),4:z({kutipanAktaLahirPemohon:$,kutipanAktaPerkawinanAtauBukuNikah:$,dokumenPernahWNI:$,ktpAtauNIT:$,suratPernyataanPenolakanWNA:$,pasFoto:$})},ca={voucher:"11112233",nama_lengkap_pemohon:"",nik_pemohon:"",id_negara_lahir_pemohon:"",tgl_lahir_pemohon:"",jenis_kelamin_pemohon:"",status_kawin_pemohon:"Kawin",id_kewarganegaraan_asal_pemohon:76,id_pekerjaan_pemohon:"",tempat_tinggal_pemohon:"",id_negara_tinggal_pemohon:0,no_hp_pemohon:"",no_telp_pemohon:"",id_provinsi_tinggal_pemohon:"",id_kab_kota_tinggal_pemohon:"",email_pemohon:"",alamat_tinggal_pemohon:"",no_akta_lahir_pemohon:"",tgl_akta_lahir_pemohon:"",no_akta_kawin_pemohon:"",tgl_akta_kawin_pemohon:"",no_paspor_ri_pemohon:"",wilayah_paspor_ri_pemohon:"",tgl_exp_paspor_ri_pemohon:"",no_paspor_kebangsaan_pemohon:"",wilayah_paspor_kebangsaan_pemohon:"",tgl_exp_paspor_kebangsaan_pemohon:"",nama_lengkap_pasangan:"",id_kewarganegaraan_pasangan:"",email_pasangan:"",no_hp_pasangan:"",id_negara_lahir_pasangan:"",tgl_lahir_pasangan:"",alamat_tinggal_pasangan:"",status_kawin_pasangan:"Kawin",agama_pasangan:"",no_paspor_asing_pasangan:"",tgl_exp_paspor_asing_pasangan:"",suratPermohonan:"",kutipanAktaLahirPemohon:null,kutipanAktaPerkawinanAtauBukuNikah:null,dokumenPernahWNI:null,ktpAtauNIT:null,suratPernyataanPenolakanWNA:null,pasFoto:null};function Ae(e,s,n=!0){const[d,l]=m.useState(!1),[h,c]=m.useState(null),[p,o]=m.useState(null),u=s===1||s===3;return m.useEffect(()=>{if(!n||!e||!u)return;(async()=>{console.log("API GET RUN"),l(!0),c(null);try{const w=await we(e);console.log(w.data),o(w.data)}catch(w){c(w)}finally{l(!1)}})()},[e,n,s]),{data:p,loading:d,error:h}}const Ie=()=>{const[e,s]=m.useState(!1),[n,d]=m.useState(null),[l,h]=m.useState(null);return{postPermohonan:async p=>{var o;console.log("ðŸš€ usePostPermohonan - Starting POST request"),console.log("Data to post:",p),s(!0),d(null),h(null);try{const t=await ye(p);console.log("âœ… POST API Response:",t),console.log("Response status:",t.status),console.log("Response data:",t.data);let i;return t.data&&(i=t,se("tetapwni",t.data.id_permohonan)),i}catch(t){console.error("âŒ POST Permohonan Error:",t);let i={message:"Network error",status:null,data:null};t.response?(console.error("API Error Response:",t.response),i={message:((o=t.response.data)==null?void 0:o.message)||`HTTP ${t.response.status}`,status:t.response.status,data:t.response.data}):t.request?(console.error("Network Error:",t.request),i={message:"Network connection failed",status:null,data:null}):(console.error("Unexpected Error:",t.message),i={message:t.message,status:null,data:null}),d(i);const u=new Error(i.message);throw u.response=t.response,u.request=t.request,u.status=i.status,u}finally{s(!1),console.log("ðŸ usePostPermohonan - Request completed")}},loading:e,error:n,response:l}};function Fe(){return Math.floor(1e5+Math.random()*9e5)}function De(){const[e,s]=m.useState(!1),[n,d]=m.useState(null),[l,h]=m.useState(null),c=pa("tetapwni");return{patchPermohonan:async o=>{s(!0),d(null);try{const i={id_voucher:Fe(),id_permohonan:c,...o},u=await Pe(i);return console.log("Patch response",u),h(u),u}catch(t){throw d(t),t}finally{s(!1)}},loading:e,error:n,response:l}}const J=[["voucher"],["nama_lengkap_pemohon","nik_pemohon","id_provinsi_pemohon","id_kab_kota_pemohon","id_negara_lahir_pemohon","tgl_lahir_pemohon","jenis_kelamin_pemohon","status_kawin_pemohon","id_kewarganegaraan_asal_pemohon","id_pekerjaan_pemohon","tempat_tinggal_pemohon","id_negara_tinggal_pemohon","id_provinsi_tinggal_pemohon","id_kab_kota_tinggal_pemohon","alamat_tinggal_pemohon","no_hp_pemohon","no_telp_pemohon","email_pemohon","no_akta_lahir_pemohon","tgl_akta_lahir_pemohon","no_akta_kawin_pemohon","tgl_akta_kawin_pemohon","no_paspor_ri_pemohon","wilayah_paspor_ri_pemohon","tgl_exp_paspor_ri_pemohon","no_paspor_kebangsaan_pemohon","wilayah_paspor_kebangsaan_pemohon","tgl_exp_paspor_kebangsaan_pemohon"],["nama_lengkap_pasangan","id_kewarganegaraan_pasangan","email_pasangan","no_hp_pasangan","id_negara_lahir_pasangan","tgl_lahir_pasangan","alamat_tinggal_pasangan","status_kawin_pasangan","agama_pasangan","no_paspor_asing_pasangan","tgl_exp_paspor_asing_pasangan"],["suratPermohonan"],["kutipanAktaLahirPemohon","kutipanAktaPerkawinanAtauBukuNikah","dokumenPernahWNI","ktpAtauNIT","suratPernyataanPenolakanWNA","pasFoto"]],qe=(e,s)=>e.filter(n=>s.includes(n.id)),Ke=(e,s)=>e.findIndex(n=>n.id===(s==null?void 0:s.id)),Ce=e=>e!=null&&e!==""&&!(Array.isArray(e)&&e.length===0)&&!(typeof e=="object"&&e!==null&&Object.keys(e).length===0),Re=(e,s)=>s.reduce((n,d)=>{const l=e[d];return Ce(l)&&(n[d]=l),n},{}),Le=()=>{const e=m.useCallback(async(n,d)=>{const l=ia[n],h=J[n],c=Re(d.values,h);if(n===4&&(console.log("=== DEBUG STEP 4 VALIDATION ==="),console.log("Current step values:",c),console.log("All formik values:",d.values),h.forEach(o=>{const t=d.values[o];console.log(`${o}:`,{value:t,type:typeof t,isFile:t instanceof File,isObject:t&&typeof t=="object",hasId:t&&t.id,hasUrl:t&&t.url,hasFilePath:t&&t.file_path})})),!l)return{isValid:!0,errors:{}};const p={...d.touched};h.forEach(o=>{p[o]=!0}),d.setTouched(p);try{const o=h.reduce((i,u)=>(i[u]=d.values[u],i),{});await l.validate(o,{abortEarly:!1});const t={...d.errors};return h.forEach(i=>{delete t[i]}),d.setErrors(t),{isValid:!0,errors:{},step:n,data:c}}catch(o){console.log("Validation error for step",n,":",o);const t={};return o.inner&&o.inner.forEach(i=>{t[i.path]=i.message}),d.setErrors({...d.errors,...t}),{isValid:!1,errors:t,data:{}}}},[]),s=m.useCallback(async n=>{const d={};let l=!1;for(let h=0;h<J.length;h++){const c=ia[h],p=J[h];if(c)try{const o=p.reduce((t,i)=>(t[i]=n.values[i],t),{});await c.validate(o,{abortEarly:!1})}catch(o){l=!0;const t={};o.inner&&o.inner.forEach(i=>{t[i.path]=i.message}),d[h]=t}}return{hasErrors:l,allStepErrors:d}},[]);return{validateCurrentStep:e,validateAllSteps:s}},We=(e,s,n,d)=>{const l=new da,h=m.useCallback(async o=>{if(await l.customConfirmation("Apakah anda yakin akan menyimpan data ke draft?")){const i=d(o);console.log("Draft values for current step (processed):",i),console.log(e);try{let u;return e?(u=await n(i),u.message==="Success"&&ra("Berhasil memperbarui draft")):(u=await s(i),console.log("DRAFT RESPONSE =",u),u.message==="Success"&&ra("Berhasil menyimpan ke draft")),u}catch(u){throw console.error("Error saving draft:",u),l.customWarningMsg("Gagal menyimpan draft"),u}}return null},[e,s,n,d,l]),c=m.useCallback((o,t)=>{if(!o||!o.fields)return z({});const i={};return Object.keys(t).forEach(u=>{const x=t[u];x!==""&&x!==null&&x!==void 0&&o.fields[u]&&(i[u]=o.fields[u])}),z(i)},[]),p=m.useCallback(async(o,t,i)=>{const u=J[o],x=ia[o];let w=!1;const b=la(t.values,u),S=["status_kawin_pemohon","id_kewarganegaraan_asal_pemohon"],v=u.reduce((f,g)=>(f[g]=t.values[g],f),{}),P=Object.fromEntries(Object.entries(v).filter(([f])=>!S.includes(f)));if(console.log(Object.keys(la(P,u))),Object.keys(la(P,u)).length===0){l.customWarningMsg("Tidak ada data yang perlu disimpan pada langkah ini. Harap isi form jika ingin menyimpan ke draft.");return}try{if(x){const k=c(x,b);console.log("SELECTIVE SCHEMA",k),await k.validate(b,{abortEarly:!1})}const f={...t.errors};u.forEach(k=>{delete f[k]}),t.setErrors(f),i(k=>{const E={...k};return E[o]&&(u.forEach(F=>delete E[o][F]),Object.keys(E[o]).length===0&&delete E[o]),E}),console.log("EXECUTE TRY SAVEDRAFT");const g=await h(b);g?console.log("âœ… Draft saved successfully:",g):console.log("â„¹ï¸ User cancelled draft save")}catch(f){const g={};f.inner&&f.inner.forEach(k=>{u.includes(k.path)&&v[k.path]!==void 0&&v[k.path]!==null&&v[k.path]!==""&&(g[k.path]=k.message,w=!0)}),w&&(t.setErrors({...t.errors,...g}),i(k=>({...k,[o]:g})),l.customWarningMsg("Beberapa input yang diisi memiliki format yang tidak valid. Mohon periksa kembali."))}},[h,l]);return{saveDraft:h,handleDraft:p}},Be=(e,s,n,d)=>{const l=new da,h=m.useCallback(async(p,o,t,i,u,x,w)=>{const b=await x(p,w),S=J[p];if(!b.isValid){console.log("validation current step",b),l.customWarningMsg("harap melengkapi formulir sebelum ke langkah selanjutnya.");return}t(g=>{const k={...g};return delete k[p],k}),i(g=>new Set([...g,p]));const v=p===3,P=p===4;if(v){console.log("ðŸ“ Step 3 (Surat Permohonan): Skipping API call, moving to next step"),o(g=>g+1),u(g=>{const k=new Set(g);return k.delete(p),k});return}if(P){console.log("ðŸ“Ž Step 4 (Upload): upload step, preparing for submission"),o(g=>g+1),u(g=>{const k=new Set(g);return k.delete(p),k});return}const f=S.reduce((g,k)=>(g[k]=w.values[k],g),{});try{const g=d(f);let k;e?(console.log("Process data to API PATCH ===>>>",g),k=await n(g,e)):(console.log("Process data to API POST ===>>>",g),k=await s(g)),o(E=>E+1),u(E=>{const F=new Set(E);return F.delete(p),F})}catch(g){console.error("API Error:",g),l.customWarningMsg("Gagal menyimpan data. Silakan coba lagi.")}},[e,s,n,d,l]),c=m.useCallback(async(p,o,t)=>{p===1?await l.customConfirmation("Keluar pada formulir akan menghapus semua riwayat pengisian, harap simpan di draft jika akan melanjutkan nanti")&&(t(),ka("tetapwni"),o(0)):o(i=>i-1)},[l]);return{handleNext:h,handleBack:c}},Ve=(e,s,n)=>{const d=new da,l=Ka(),[h,c]=m.useState(!1);return{handleSubmit:m.useCallback(async(o,t,i,u,x)=>{var w;if(console.log("=== SUBMIT HANDLER ==="),console.log("Active Step:",o),console.log("Current Formik Values:",t.values),o!==5){console.log("âŒ Not on final step, cannot submit");return}try{console.log("ðŸ” Validating all steps before submission...");const{hasErrors:b,allStepErrors:S}=await i(t);if(console.log("Validation result:",{hasErrors:b,allStepErrors:S}),b){console.log("âŒ Form has validation errors:",S),u(S);const k={};Object.values(S).forEach(F=>{Object.assign(k,F)}),t.setErrors(k);const E=J.flat().reduce((F,K)=>(F[K]=!0,F),{});t.setTouched(E),sa("Harap melengkapi formulir sebelum melakukan submit");return}if(console.log("âœ… All validation passed, proceeding with submission..."),!await d.confirmationCreate()){console.log("â„¹ï¸ User cancelled submission");return}x(!0),console.log("ðŸš€ Submitting form...");const P=n(t.values);console.log("Payload di proses",P);const f={id_permohonan:e,status_permohonan:1,status_aktivitas:2};console.log("Final submission payload:",f);const g=await Ne(f);if(console.log("âœ… Submission response:",g),g&&g.message==="Success")ra("Berhasil Membuat Permohonan!, Mengalihkan..."),setTimeout(()=>{ka("tetapwni"),c(!0)},3e3),x(!1);else throw new Error((g==null?void 0:g.message)||"Submission failed")}catch(b){if(console.error("âŒ Submission error:",b),x(!1),b.response){const S=((w=b.response.data)==null?void 0:w.message)||"Terjadi kesalahan pada server";ta(S)}else b.request?ta("Gagal terhubung ke server. Periksa koneksi internet."):ta(b.message||"Terjadi kesalahan tidak terduga")}finally{x(!1),console.log("=== END SUBMIT HANDLER ===")}},[e,s,n,d,l]),successSubmit:h}},Me="Dalam Negeri",Ue="Luar Negeri",ze=(e,s)=>{const[n,d]=m.useState(s?1:0),[l,h]=m.useState(new Set),[c,p]=m.useState({}),[o,t]=m.useState(new Set),[i,u]=m.useState(!1),{loading:x,error:w,data:b}=Ae(s,n),{postPermohonan:S,response:v,loading:P,error:f}=Ie(),{patchPermohonan:g,response:k,loading:E,error:F}=De(),K=s,H=m.useMemo(()=>b&&b.id_permohonan===K?{...ca,...b,status_kawin_pasangan:b.status_kawin_pasangan||"Kawin"}:ca,[b,K]),L=m.useCallback(Z=>{const R={...Z};return R.tempat_tinggal_pemohon===Me?delete R.id_negara_tinggal_pemohon:R.tempat_tinggal_pemohon===Ue?(delete R.id_provinsi_tinggal_pemohon,delete R.id_kab_kota_tinggal_pemohon):(delete R.id_provinsi_tinggal_pemohon,delete R.id_kab_kota_tinggal_pemohon,delete R.id_negara_tinggal_pemohon),R},[]),{validateCurrentStep:B,validateAllSteps:V}=Le(),{handleDraft:Y}=We(K,S,g,L),{handleNext:Q,handleBack:aa}=Be(K,S,g,L),{handleSubmit:I,successSubmit:M}=Ve(K,g,L),C=ma({enableReinitialize:!0,validateOnChange:!0,validateOnBlur:!0,initialValues:H,validationSchema:ia[n],onSubmit:async Z=>{console.log("Formik onSubmit called with:",Z)}});m.useEffect(()=>{ea()},[e]);const ea=m.useCallback(()=>{d(s?1:0),C.resetForm(),p({}),t(new Set),h(new Set)},[C,s]),ba=m.useCallback(Z=>l.has(Z),[l]),fa=m.useCallback(()=>Q(n,d,p,t,h,B,C),[n,Q,B,C]),wa=m.useCallback(()=>aa(n,d,ea),[n,aa,ea]),ya=m.useCallback(()=>Y(n,C,p),[n,C,Y]),Pa=m.useCallback(()=>I(n,C,V,p,u),[n,C,I,V]);return{activeStep:n,setActiveStep:d,skipped:l,stepErrors:c,completedSteps:o,isSubmitting:i,formik:C,isStepSkipped:ba,handleNext:fa,handleBack:wa,handleDraft:ya,handleSubmit:Pa,resetForm:ea,dataPermohonan:b,loadingGet:x,postLoading:P,patchLoading:E,processPayloadBasedOnTempatLahir:L,successSubmit:M}},He=({formik:e})=>{const{values:s}=e,n=(d,l)=>ja(d,l||"-");return a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Informasi Pasangan"}),a.jsxs(T,{className:"form-horizontal border border-1 rounded-4 px-4 py-3",children:[a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Nama Lengkap",s.nama_lengkap_pasangan)}),a.jsx(r,{md:"6",children:n("Kewarganegaraan",s.kewarganegaraan_pasangan_text)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Email",s.email_pasangan)}),a.jsx(r,{md:"6",children:n("Nomor HP",s.no_hp_pasangan)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Negara Tempat Lahir",s.negara_lahir_pasangan_text)}),a.jsx(r,{md:"6",children:n("Tanggal Lahir",q(s.tgl_lahir_pasangan))})]}),a.jsx(_,{children:a.jsx(r,{md:"6",children:n("Alamat Tinggal",s.alamat_tinggal_pasangan)})}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Status Perkawinan",s.status_kawin_pasangan)}),a.jsx(r,{md:"6",children:n("Agama",s.agama_pasangan)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Nomor Paspor Asing",s.no_paspor_asing_pasangan)}),a.jsx(r,{md:"6",children:n("Tanggal Kedaluarsa Paspor",q(s.tgl_exp_paspor_asing_pasangan))})]})]})]})},Oe=({formik:e})=>{const{values:s}=e,n=(d,l)=>ja(d,l||"-");return a.jsxs(a.Fragment,{children:[a.jsx(A,{title:"Pratinjau Informasi Pemohon"}),a.jsxs(T,{className:"form-horizontal border border-1 rounded-4 px-4 py-3",children:[a.jsx(A,{title:"Informasi Pribadi"}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Nama Lengkap",s.nama_lengkap_pemohon)}),a.jsx(r,{md:"6",children:n("NIK/NIT",s.nik_pemohon)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Tanggal Lahir",q(s.tgl_lahir_pemohon))}),a.jsx(r,{md:"6",children:n("Negara Kelahiran",s.negara_lahir_pemohon_text)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Jenis Kelamin",s.jenis_kelamin_pemohon)}),a.jsx(r,{md:"6",children:n("Status Perkawinan",s.status_kawin_pemohon)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Kewarganegaraan Asal",s.kewarganegaraan_asal_pemohon_text||"")}),a.jsx(r,{md:"6",children:n("Pekerjaan",s.pekerjaan_pemohon_text)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Provinsi Kelahiran",s.provinsi_pemohon_text)}),a.jsx(r,{md:"6",children:n("Kab/Kota Kelahiran",s.kab_kota_pemohon_text)})]}),a.jsx(A,{title:"Alamat"}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Tempat Tinggal",s.tempat_tinggal_pemohon)}),s.tempat_tinggal_pemohon==="Luar Negeri"&&a.jsx(r,{md:"6",children:n("Negara Tinggal",s.negara_lahir_pemohon_text)}),s.tempat_tinggal_pemohon==="Dalam Negeri"&&a.jsxs(a.Fragment,{children:[a.jsx(r,{md:"6",children:n("Provinsi",s.provinsi_tinggal_pemohon_text)}),a.jsx(r,{md:"6",children:n("Kabupaten/Kota",s.kab_kota_tinggal_pemohon_text)})]})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Nomor HP",s.no_hp_pemohon)}),a.jsx(r,{md:"6",children:n("Nomor Telepon Rumah",s.no_telp_pemohon)})]}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("Email",s.email_pemohon)}),a.jsx(r,{md:"6",children:n("Alamat Tinggal",s.alamat_tinggal_pemohon)})]}),a.jsx(A,{title:"Dokumen Kependudukan"}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("No Akta Kelahiran",s.no_akta_lahir_pemohon)}),a.jsx(r,{md:"6",children:n("Tanggal Akta Kelahiran",q(s.tgl_akta_lahir_pemohon))})]}),a.jsx(A,{title:"Dokumen Perjalanan"}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("No Paspor RI",s.no_paspor_ri_pemohon)}),a.jsx(r,{md:"6",children:n("Wilayah Terbit Paspor RI",s.wilayah_paspor_ri_pemohon_text)})]}),a.jsx(_,{children:a.jsx(r,{md:"6",children:n("Tanggal Kedaluwarsa Paspor RI",q(s.tgl_exp_paspor_ri_pemohon))})}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("No Paspor Kebangsaan",s.no_paspor_kebangsaan_pemohon)}),a.jsx(r,{md:"6",children:n("Wilayah Terbit Paspor Kebangsaan",s.wilayah_paspor_kebangsaan_pemohon_text)})]}),a.jsx(_,{children:a.jsx(r,{md:"6",children:n("Tanggal Exp Paspor Kebangsaan",q(s.tgl_exp_paspor_kebangsaan_pemohon))})}),a.jsx(A,{title:"Dokumen Perkawinan"}),a.jsxs(_,{children:[a.jsx(r,{md:"6",children:n("No Akta Perkawinan",s.no_akta_kawin_pemohon)}),a.jsx(r,{md:"6",children:n("Tanggal Akta Perkawinan",q(s.tgl_akta_kawin_pemohon))})]})]})]})},$e=({formik:e})=>a.jsxs("div",{className:"mt-3",children:[a.jsx(Oe,{formik:e}),a.jsx(He,{formik:e})]});function pn({label:e="Formulir Permohonan"}){const s=pa("tetapwni"),{activeStep:n,setActiveStep:d,stepErrors:l,completedSteps:h,isSubmitting:c,formik:p,isStepSkipped:o,handleNext:t,handleBack:i,handleDraft:u,handleSubmit:x,loadingGet:w,postLoading:b,patchLoading:S,successSubmit:v}=ze(e,s),P=Ca(),{values:f,setFieldValue:g}=p,k=[{id:"1",label:"Boarding",component:a.jsx(ce,{formik:p,setActiveStep:d,label:e})},{id:"2",label:"Identitas Pemohon",stepNumber:"Langkah 1",component:a.jsx(be,{formik:p})},{id:"3",label:"Identitas Suami/Istri",stepNumber:"Langkah 2",component:a.jsx(Te,{formik:p})},{id:"4",label:"Surat Permohonan",stepNumber:"Langkah 3",component:a.jsx(fe,{formik:p})},{id:"5",label:"Unggah Dokumen",stepNumber:"Langkah 4",component:a.jsx(Ee,{formik:p})},{id:"6",label:"Pratinjau Formulir",stepNumber:"Langkah 5",component:a.jsx($e,{formik:p})}],E=s?k.filter(I=>I.id!=="1"):k,K={"Formulir Permohonan":s?["2","3","4","5","6"]:["1","2","3","4","5","6"]}[e]||[],H=qe(E,K),L=H.filter(I=>I.stepNumber),B=s?n-1:n,V=H[B<0?0:B]||s&&H[0],Y=Ke(L,H[B<0?0:B]),Q=I=>{const M=s?I+1:I;return!l[M]&&h.has(M)},aa=I=>{const M=s?I+1:I;return l[M]&&Object.keys(l[M]).length>0};return m.useEffect(()=>{P(Ra()),P(La()),P(Wa()),P(Ba()),P(Va())},[P]),m.useEffect(()=>{f.id_provinsi_pemohon&&P(Ma(f.id_provinsi_pemohon))},[f.id_provinsi_pemohon,P]),m.useEffect(()=>{f.id_provinsi_lahir_pasangan&&P(Ua(f.id_provinsi_lahir_pasangan))},[f.id_provinsi_lahir_pasangan]),m.useEffect(()=>{f.id_kab_kota_pemohon&&P(za(f.id_kab_kota_pemohon))},[f.id_kab_kota_pemohon,f.id_kab_kota_lahir_pasangan,P]),m.useEffect(()=>{f.id_kec_pemohon&&P(Ha(f.id_kec_pemohon))},[f.id_kec_pemohon,P,g]),a.jsxs(T,{className:"bg-white page-content mb-4",sx:{width:"100%"},children:[!v&&L.length>0&&Y>=0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"mb-4",style:{fontWeight:500,fontSize:24,color:"#262626"},children:"Formulir Pendaftaran"}),a.jsx(ue,{steps:L,activeStep:Y,isStepSkipped:o,isStepValid:Q,isStepHasError:aa})]}),w?a.jsx(te,{}):v?a.jsx(re,{title:"Pendaftaran Berhasil!",subTitle:"Verifikasi akan dilakukan setelah dokumen fisik diterima secara lengkap oleh Subdit Kewarganegaraan dalam waktu paling lama 3 (tiga) hari terhiitung sejak tanggal permohonan diterima.",redirectUrl:"/kewarganegaraan/pernyataan-wni/tetap-wni"}):a.jsxs(T,{children:[(V==null?void 0:V.component)||a.jsx(T,{sx:{p:2,textAlign:"center"},children:a.jsx("p",{children:"Step tidak ditemukan"})}),n>=1&&a.jsx(de,{handleSubmit:x,handleNext:t,handleBack:i,handleDraft:u,activeStep:n,stepsResult:V,isSubmitting:c,postLoading:b,patchLoading:S})]})]})}export{pn as default};
