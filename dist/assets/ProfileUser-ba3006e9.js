import{u as E,r as c,a as R,g as T,h as _,i as q,k as $,j as e,b as d,c as f,B as k,C as I,n as O,o as z,F as H,p as K,q as y,s as W,L as C,I as U,t as V,v as g,w as G,x as D,T as J}from"./index-d70a1868.js";import{T as Q}from"./TabContent-01c694f1.js";import{M as X}from"./Modals-43a7b6ce.js";const Y=[{link:"/",label:"Beranda"},{link:"#",label:"Profile User"}];function se(){var x,p;document.title="User Management | AHU RI";const h=E(),[v,P]=c.useState(""),[j,A]=c.useState(!1),m=R(),S=new J,{id:l}=T(),{detail_pengguna:n}=_(a=>a.Usman);c.useEffect(()=>{h(q(Y))},[]);const u=()=>{A(!j),document.body.classList.add("no_padding")},M=a=>{var b;const t=(b=a.jenisUsman)==null?void 0:b.map((i,o)=>{var N;return{[`r_roles_code[${o}]`]:((N=i.jenis_role)==null?void 0:N.code)||""}}),r={id:l,fullname:a==null?void 0:a.fullname,username:a==null?void 0:a.username,valid:1,deleted:0,...t.reduce((i,o)=>({...i,...o}),{})},s=Object.fromEntries(Object.entries(r).filter(([i,o])=>o));P(s),u()},w=async()=>{try{await g(v),G("Sukses Mengubah Data, Anda Diharuskan Login kembali untuk update Data"),m("/logout")}catch(a){D(a)}u()};c.useEffect(()=>{l&&h($({id:l}))},[l]);const B=c.useMemo(()=>{var t;const a=(t=n==null?void 0:n.data)==null?void 0:t.roles;if(Array.isArray(a)){const r=[...new Map(a.map(s=>[s.role_code,s])).values()];if(r.length)return r.map(s=>({jenis_role:{code:s==null?void 0:s.role_code,title:s==null?void 0:s.role},jenis_modul:{code:s==null?void 0:s.module_code,title:s==null?void 0:s.module}}))}return[{jenis_role:null,jenis_modul:null}]},[n==null?void 0:n.data]),F={fullname:((x=n==null?void 0:n.data)==null?void 0:x.fullname)||"",username:((p=n==null?void 0:n.data)==null?void 0:p.username)||"",jenisUsman:B},L=()=>{S.customConfirmation("Akun Anda Akan Dinonaktifkan, dan Hanya Bisa Diaktifkan Kembali Oleh Admin").then(a=>{if(a){const t={id:l,valid:0,deleted:0};try{g(t).then(r=>{r&&m("/logout")})}catch(r){D(r)}}})};return e.jsxs("div",{className:"page-content pt-4",children:[e.jsxs(d,{children:[e.jsx(f,{md:6,children:e.jsx("div",{className:"mb-3",children:e.jsx("h1",{className:"text-primary fs-4 fw-bold text-uppercase m-0",children:"Profile User"})})}),e.jsxs(f,{md:6,className:"d-flex justify-content-end column-gap-3",children:[e.jsx(k,{color:"primary",onClick:()=>m("/auth/ubah-pwd"),children:"Ubah Kata Sandi"}),e.jsx(k,{color:"danger",onClick:L,children:"Non Aktifkan Akun"})]})]}),e.jsx(I,{fluid:!0,children:e.jsx(d,{className:"mt-3",children:e.jsx(f,{lg:"12",children:e.jsx(O,{children:e.jsxs(z,{className:"px-4 py-3",children:[e.jsx("div",{className:"fw-semibold fs-4 mb-3",children:"Edit Data User"}),e.jsx("div",{className:"wizard clearfix",children:e.jsx("div",{className:"content clearfix",children:e.jsx(Q,{className:"body pt-0",children:e.jsx(H,{enableReinitialize:!0,initialValues:F,validationSchema:K({fullname:y().required("Nama Lengkap Wajib Diisi"),username:y().required("Username Wajib Diisi")}),onSubmit:a=>{M(a)},className:"needs-validation",children:a=>{var t,r;return e.jsxs(W,{className:"needs-validation mt-4",children:[e.jsxs(d,{className:"mb-3",children:[e.jsx(C,{htmlFor:"validationCustom01",className:"col-md-2 col-form-label",children:"Nama Lengkap"}),e.jsx("div",{className:"col-md-10",children:e.jsxs("div",{className:"d-flex flex-column align-items-start",children:[e.jsx(U,{name:"fullname",placeholder:"Nama Lengkap",type:"text",id:"validation1",onChange:a.handleChange,onBlur:a.handleBlur,value:((t=a.values)==null?void 0:t.fullname)||"",className:`form-control ${a.touched.fullname&&a.errors.fullname?"is-invalid":""}`}),a.touched.fullname&&a.errors.fullname?e.jsx(V,{type:"invalid",children:a.errors.fullname}):null]})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(C,{htmlFor:"validationCustom03",className:"col-md-2 col-form-label",children:"Username"}),e.jsx("div",{className:"col-md-10",children:e.jsx(U,{disabled:!0,name:"username",placeholder:"Username",value:((r=a.values)==null?void 0:r.username)||"",className:"select2-selection"})})]}),e.jsx("div",{className:"actions clearfix justify-content-end d-flex",children:e.jsx("button",{type:"submit",onClick:s=>{s.preventDefault(),a.handleSubmit()},className:"btn btn-primary",children:"Ubah Data"})})]})}})})})})]})})})})}),e.jsx(X,{modalBackdrop:j,modalPopup:u,approve:()=>w()})]})}export{se as default};
