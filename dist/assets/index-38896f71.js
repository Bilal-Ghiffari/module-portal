import{r as w,dd as Z,de as ae,df as O,j as e,b as $,c as l,dg as z,dh as ne,b_ as se,T as W,di as ee,dj as M,dk as le,dl as te,w as J,dm as V,x as U,dn as I,bY as y,dp as ie,L as G,ck as B,dq as de,bB as oe,cV as re,b4 as ce,dr as me,bD as ue,ds as E,aG as q,dt as pe,bn as xe,du as he,aH as _e,dv as je,dw as ge,dx as be,b8 as ye,U as Ne,a as ve,A as ke,bV as fe,bW as De,bX as we,R as Se,dy as Ce,bw as H,b$ as Fe,a2 as R,dz as Q,dA as Pe,dB as Te,dC as $e}from"./index-d70a1868.js";import{H as X}from"./Header-40ff2c65.js";const Le=({formik:a,setActiveStep:n,label:r})=>{var t,i;const[g,S]=w.useState({documents:[],negara:[]}),k=new W;function x(){n(d=>d+1)}w.useEffect(()=>{u()},[r]);const u=async()=>{k.showLoading();try{const[d,c]=await Promise.all([Z(),ae()]);S({documents:O(d==null?void 0:d.data,{value:"id_jenis_dokumen",label:"jenis_dokumen"}),negara:O(c==null?void 0:c.data,{value:"id_negara",label:"nama_negara",jenis_layanan:"jenis_layanan"})})}catch(d){console.log("err",d)}finally{k.close()}};return e.jsx("div",{className:"bg-white",children:e.jsx("div",{className:"d-flex flex-column w-100 py-4",children:e.jsxs($,{className:"w-100",style:{maxWidth:"800px",padding:"0px 50px"},children:[e.jsxs(l,{xs:"12",className:"mb-2",children:[e.jsx("h4",{className:"fw-bold",style:{color:"#041662"},children:r}),e.jsx("hr",{className:"mt-0 mb-3"})]}),e.jsx(l,{xs:"12",className:"mb-4",children:e.jsx("p",{style:{fontSize:"0.95rem",lineHeight:"1.6"},children:"Anda akan memulai proses pendaftaran permohonan legalisasi dokumen. Silakan pilih dokumen yang ingin dilegalisasi serta negara tujuan untuk proses selanjutnya."})}),e.jsx(l,{xs:"12",className:"mb-2",children:e.jsx(z,{formik:a,fieldName:"id_jenis_dokumen",data:g.documents,label:"Dokumen yang ingin dilegalisasi",required:!0,onChange:d=>{a.setFieldValue("id_jenis_dokumen",d.value),a.setFieldValue("document",d.label)}})}),e.jsx(l,{xs:"12",className:"mb-2",children:e.jsx(z,{id:"apostille",formik:a,fieldName:"id_negara",data:g.negara,label:"Negara tujuan legalisasi",required:!0})}),e.jsx(l,{xs:"12",children:((t=a.values)==null?void 0:t.jenis_layanan)&&e.jsxs("button",{className:"mb-4",style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#0d6efd",color:"#fff",border:"1px solid #0d6efd",padding:"8px 16px",borderRadius:"2px",fontSize:"14px",cursor:"pointer"},children:[e.jsx(ne,{size:14}),e.jsx("span",{className:"text-capitalize",children:(i=a.values)==null?void 0:i.jenis_layanan})]})}),e.jsx(l,{xs:"12",className:"mb-4",children:e.jsxs("button",{onClick:x,style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#041662",color:"#fff",border:"none",padding:"10px 16px",borderRadius:"6px",fontSize:"14px"},children:[e.jsx("span",{children:"Mulai Pendaftaran"})," ",e.jsx(se,{size:10})]})})]})})})},Y=(a,n,r)=>{const g=new W,S=x=>{const u=n,t=new FormData;t.append(u,x),M("/apostille/permohonan/upload",t).then(i=>{const d=i==null?void 0:i.data,c={id_berkas:d==null?void 0:d.id_berkas,jenis_berkas:d==null?void 0:d.jenis_berkas,s3_key:d==null?void 0:d.s3_key,name:d==null?void 0:d.original_name},f=[...r.values.berkas.filter(b=>b.jenis_berkas!==u),c];r.setFieldValue("berkas",f)})},k=()=>{const x=r.values.berkas.find(u=>u.jenis_berkas===n);console.log("fileToDelete",x),x!=null&&x.id_berkas&&g.confirmationDelete().then(u=>{u&&(g.showLoading(),le(`${te}/${x.id_berkas}`).then(()=>{J("success"),V.close()}).catch(t=>{U(t),console.log("err",t),V.close()}))})};return e.jsx(ee,{label:a,text:"Pilih file Anda",name:n,resFile:S,maxSizeMb:10,searchLatLon:!1,validType:"pdf",specified:!0,required:!0,fieldValue:r.values.berkas.find(x=>x.jenis_berkas===n)||null,handleDelete:k})},Ee=({formik:a,disabled:n,dropdown:r})=>e.jsxs($,{children:[e.jsx(l,{xs:"12",md:"12",lg:"12",className:"px-3",children:e.jsx(I,{label:"Informasi Pemohon"})}),e.jsx(l,{xs:"12",md:"12",lg:"12",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"fullname_pemohon",placeholder:"Nama Lengkap",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"nik_pemohon",type:"text",placeholder:"NIK",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"email_pemohon",type:"email",placeholder:"Email",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"no_hp_pemohon",type:"tel",placeholder:"Nomor Telepon",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(y,{formik:a,name:"tanggal_lahir_pemohon",type:"date",placeholder:"Tanggal Lahir",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(z,{formik:a,fieldName:"jenis_kelamin_pemohon",data:ie,label:"Jenis Kelamin",required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(z,{formik:a,fieldName:"id_negara_tinggal_pemohon",data:r.negara,label:"Negara Tempat Tinggal ",required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:"alamat_pemohon",type:"text",placeholder:"Alamat",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:Y("File Identitas Pemohon","ktp_pemohon",a)}),e.jsxs(l,{xs:"3",className:"px-3",children:[e.jsxs(G,{className:"mb-0",style:{fontSize:"12px"},children:["Tempat Lahir ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-5 mt-1",style:{padding:"0px 22px"},children:[e.jsx(B,{label:"Dalam Negeri",value:"dalam_negeri",fieldName:"tempat_lahir_pemohon",formik:a,type:"radio"},`dalam_negeri-${a.values.tempat_lahir_pemohon}`),e.jsx(B,{label:"Luar Negeri",value:"luar_negeri",fieldName:"tempat_lahir_pemohon",formik:a,type:"radio"},`luar_negeri-${a.values.tempat_lahir_pemohon}`)]})]}),e.jsx(l,{xs:"9",className:"px-3 mt-2",children:e.jsx(de,{formik:a,provinsiKey:"id_provinsi_lahir_pemohon",kabupatenKey:"id_kab_kota_lahir_pemohon",negaraKey:"id_negara_lahir_pemohon",showProvinsi:a.values.tempat_lahir_pemohon!="luar_negeri",showKabupaten:a.values.tempat_lahir_pemohon!="luar_negeri",showKecamatan:!1,showKelurahan:!1,showNegara:a.values.tempat_lahir_pemohon=="luar_negeri",required:!0})})]}),qe=({formik:a,disabled:n,dropdown:r})=>e.jsxs($,{children:[e.jsx(l,{xs:"12",md:"12",lg:"12",className:"px-3",children:e.jsx(I,{label:"Informasi Penerima Kuasa"})}),e.jsx(l,{xs:"12",md:"12",lg:"12",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"nama_penerima_kuasa",placeholder:"Nama Penerima Kuasa",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"nik_penerima_kuasa",type:"text",placeholder:"NIK Penerima Kuasa",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"email_penerima_kuasa",type:"email",placeholder:"Email Penerima Kuasa",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"3",className:"px-3",children:e.jsx(y,{formik:a,name:"no_hp_penerima_kuasa",type:"tel",placeholder:"No Telp Penerima Kuasa",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(y,{formik:a,name:"alamat_penerima_kuasa",type:"text",placeholder:"Alamat Penerima Kuasa",readonly:n,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:Y("File Identitas Penerima Surat Kuasa","ktp_penerima_kuasa",a)}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:Y("File Surat Kuasa Bermaterai","surat_kuasa",a)})]}),Ae=({formik:a,open:n,setOpen:r,setDataDocuments:g,dataDocuments:S,dropdown:k})=>{const x=()=>r(!1),u=()=>{const t=S[0],i=a.values.data_document[t],c=[...a.values.data_document.filter((h,C)=>{var D;return C!==t&&h&&((D=h.nama_dokumen)==null?void 0:D.trim())!==""}),i],f={tipe_dokumen:"Konvensional",nomor_dokumen:"",nama_dokumen:"",nama_tercantum:"",jumlah_halaman:"",tanggal_dokumen:"",tempat_cetak:"",instansi:"",nama_pejabat:"",jabatan_pejabat:"",berkas:[]},b={...i,jumlah_halaman:Number(i.jumlah_halaman),id_kanwil:Number(i.id_kanwil),id_jenis_dokumen:Number(a.values.id_jenis_dokumen),id_spesimen_pejabat:Number(i.id_spesimen_pejabat||1)};M("/apostille/permohonan/dokumen",b).then(h=>{var D;const C=(D=h==null?void 0:h.data)==null?void 0:D.id_data_dokumen;C&&a.setFieldValue("data_dokumen",[...a.values.data_dokumen||[],{id_data_dokumen:C}]),a.setFieldValue("data_document",[...c,f]),r(!1)}).catch(h=>{console.log("err",h)}),g([c.length])};return e.jsxs("div",{children:[e.jsx("button",{className:"px-2 py-2 border-0 text-primary d-flex align-items-center gap-1 px-3",onClick:()=>{const t=a.values.data_document.length;g([t]),r(!0)},style:{backgroundColor:"#E7E7E7",borderRadius:"6px"},children:"+ Tambah"}),e.jsxs(oe,{open:n,onClose:x,maxWidth:"md",fullWidth:!0,children:[e.jsxs(re,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[e.jsx(X,{label:"Data Dokumen"}),e.jsx(ce,{edge:"end",color:"inherit",onClick:x,"aria-label":"close",children:e.jsx(me,{})})]}),e.jsxs(ue,{children:[S.map((t,i)=>{var d,c,f;return e.jsxs("div",{className:"border rounded-2 mb-3 p-3",children:[e.jsxs($,{children:[e.jsxs(G,{children:["Tipe Dokumen"," ",E((d=a.values)==null?void 0:d.document,"Dokumen"),e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(l,{xs:"12",style:{padding:"0px 40px"},className:"d-flex gap-5 mb-3",children:[e.jsx(B,{label:`Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")} Konvensional`,value:"Konvensional",fieldName:`data_document[${t}].tipe_dokumen`,formik:a,type:"radio"}),e.jsx(B,{label:`Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")} Elektronik`,value:"Elektronik",fieldName:`data_document[${t}].tipe_dokumen`,formik:a,type:"radio"})]})]}),e.jsxs($,{children:[e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:"document",type:"text",placeholder:"Jenis Dokumen",required:!0,readonly:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].nama_dokumen`,type:"text",placeholder:`Nama Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")}`,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].nomor_dokumen`,type:"text",placeholder:`Nomor Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")}`,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].nama_tercantum`,type:"text",placeholder:`Nama Tercantum di Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")}`,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].jumlah_halaman`,type:"number",maks:50,title:"Jumlah Halaman pada Dokumen",placeholder:`Jumlah Halaman pada Dokumen (maks 50) ${E((a==null?void 0:a.values.document)||"","Dokumen")}`,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].tanggal_dokumen`,type:"date",placeholder:`Tanggal Dokumen ${E((a==null?void 0:a.values.document)||"","Dokumen")}`,required:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"6",className:"px-3",children:e.jsx(z,{formik:a,fieldName:`data_document[${t}].id_kanwil`,data:k.kanwill,label:"Tempat Cetak Sticker Legalisasi",required:!0})})]}),e.jsxs(l,{xs:"12",className:"px-3 border p-2 rounded-2 mt-3",children:[e.jsxs(G,{children:["Lampiran Dokumen"," ",E(a==null?void 0:a.values.document,"Dokumen")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx($,{children:Array.from({length:Number((f=(c=a.values.data_document)==null?void 0:c[t])==null?void 0:f.jumlah_halaman)||1}).map((b,h)=>{var C,D,j,m;return e.jsx($,{className:"mt-2",children:e.jsx(l,{xs:"8",children:e.jsx(ee,{text:`Pilih file Anda ${h+1}`,name:`data_document[${t}].berkas[${h}]`,fieldValue:((m=(j=(D=(C=a.values)==null?void 0:C.data_document)==null?void 0:D[t])==null?void 0:j.berkas)==null?void 0:m[h])||null,resFile:v=>{const P="dokumen",F=new FormData;F.append(P,v),M("/apostille/permohonan/upload",F).then(A=>{const s=A==null?void 0:A.data,_={id_berkas:s==null?void 0:s.id_berkas,jenis_berkas:s==null?void 0:s.jenis_berkas,s3_key:s==null?void 0:s.s3_key,name:s==null?void 0:s.original_name},N=[...a.values.data_document];N[t]||(N[t]={tipe_dokumen:"Konvensional",nama_dokumen:"",nama_tercantum:"",jumlah_halaman:"",tanggal_dokumen:"",tempat_cetak:"",berkas:[],instansi:"",nama_pejabat:"",jabatan_pejabat:""});const o=Array.isArray(N[t].berkas)?[...N[t].berkas]:[];for(;o.length<=h;)o.push(null);o[h]=_,N[t].berkas=o,a.setFieldValue("data_document",N)})},maxSizeMb:10,validType:"pdf",specified:!0,required:!0})})},h)})})]}),e.jsx(l,{xs:"12",className:"mt-4",children:e.jsx(X,{label:"Data Pejabat"})}),e.jsxs($,{children:[e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(z,{formik:a,fieldName:`data_document[${t}].id_spesimen_pejabat`,data:k.pejabat,label:"Nama Pejabat Publik",onChange:b=>{a.setFieldValue(`data_document[${t}].id_spesimen_pejabat`,b.value),a.setFieldValue(`data_document[${t}].nama_pejabat`,b.label),a.setFieldValue(`data_document[${t}].instansi`,b.instansi),a.setFieldValue(`data_document[${t}].jabatan_pejabat`,b.jabatan_pejabat)},required:!0,useLabel:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].instansi`,type:"text",placeholder:"Onstansi",readonly:!0})}),e.jsx(l,{xs:"12",md:"6",lg:"4",xl:"4",className:"px-3",children:e.jsx(y,{formik:a,name:`data_document[${t}].jabatan_pejabat`,type:"text",placeholder:"Jabatan",readonly:!0})})]})]},i)}),e.jsx(q,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(pe,{onClick:u,label:"Simpan"})})]})]})]})},Ke=({data:a=[],formik:n,showSelect:r=!0,setOpen:g,setDataDocuments:S})=>{var C,D;const[k,x]=w.useState({page:1,limit:10}),[u,t]=w.useState(""),i=new W,d=j=>{const m=n.values.data_document||[];let P=m.some(F=>F.id===j.id)?m.filter(F=>F.id!==j.id):[...m,j];n.setFieldValue("data_document",P)},c=(j,m)=>{switch(j){case"edit":S([m]),g(!0);break;case"delete":i.confirmationDelete().then(v=>{if(v){const P=n.values.data_document.filter((F,A)=>A!==m).filter(F=>F!=null);n.setFieldValue("data_document",P)}});break}},f=[...r?[{id:"pilih",label:"Pilih",width:"5%",cell:j=>{var m,v;return e.jsx(_e,{color:"primary",checked:(v=(m=n.values)==null?void 0:m.data_dokumen)==null?void 0:v.some(P=>P.id===j.id),onChange:()=>d(j)})}}]:[],{id:"tipe_dokumen",label:"Tipe Dokumen",align:"left"},{id:"nama_dokumen",label:"Nama Dokumen",align:"left"},{id:"nama_tercantum",label:"Nama Tercantum",align:"left"},{id:"nomor_dokumen",label:"Nomor Dokumen",align:"left"},{id:"jumlah_halaman",label:"Jumlah Dokumen",align:"left"},{id:"tanggal_dokumen",label:"Tanggal Dokumen",align:"left"},{id:"nama_pejabat",label:"Nama Pejabat",align:"left"},{id:"jabatan_pejabat",label:"Jabatan",align:"left"},{id:"instansi",label:"Instansi",align:"left",width:"180px"},{id:"aksi",label:"Aksi",align:"left",width:"100px",isNotSticky:!0,cell:(j,m)=>e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{onClick:()=>c("edit",m),className:"action-item d-flex align-items-center m-0 p-0",children:e.jsx("i",{className:"bx bx-pencil fs-4"})}),e.jsx("div",{onClick:()=>c("delete",m),className:"action-item d-flex align-items-center m-0 p-0",children:e.jsx("i",{className:"bx bx-trash-alt fs-4"})})]})}],b=w.useMemo(()=>{if(!u)return a;const j=u.toLowerCase();return a.filter(m=>Object.values(m).some(v=>v==null?void 0:v.toString().toLowerCase().includes(j)))},[a,u]),h=j=>{x(m=>({...m,page:j}))};return e.jsxs(e.Fragment,{children:[r&&e.jsxs("div",{className:"px-2 d-flex align-items-center justify-content-between",children:[e.jsx(xe,{size:"small",placeholder:"Cari...",value:u,onChange:j=>t(j.target.value),sx:{mb:2},className:"w-50"}),e.jsxs(q,{sx:{mb:2},children:[e.jsx("strong",{children:"Selected:"})," ",((D=(C=n.values)==null?void 0:C.data_document)==null?void 0:D.length)||0]})]}),e.jsx(q,{sx:{borderRadius:"8px",overflow:"hidden",border:"1px solid #e0e0e0"},children:e.jsx(he,{data:b,totalData:b.length,column:f,isServerSide:!0,onPageChange:h,limit:k.limit})})]})},Oe=({formik:a,disabled:n=!1})=>{var i,d;const[r,g]=w.useState(!1),[S,k]=w.useState([0]),[x,u]=w.useState({negara:[],kanwill:[],pejabat:[],documents:[]});w.useEffect(()=>{t()},[]);const t=async()=>{try{const[c,f,b,h]=await Promise.all([je(),ge(),be(),Z()]);u({negara:O(c==null?void 0:c.data,{value:"id_negara",label:"nama_negara"}),kanwill:O(f==null?void 0:f.data,{value:"id_kanwil",label:"nama_kanwil"}),pejabat:O(b==null?void 0:b.data,{value:"id_spesimen_pejabat",label:"nama_pejabat",instansi:"instansi",jabatan_pejabat:"jabatan_pejabat"}),documents:O(h==null?void 0:h.data,{value:"id_jenis_dokumen",label:"jenis_dokumen"})})}catch(c){console.log("err",c)}};return e.jsx("div",{className:"mt-5 mb-3 px-2 ",children:e.jsxs(q,{sx:{border:"1px solid #E7E7E7",borderRadius:5,padding:2},children:[e.jsxs($,{children:[e.jsx(l,{xs:"12",md:"12",children:e.jsx(I,{label:"Jenis Pemohon",disabled:n})}),e.jsxs(l,{xs:"12",style:{padding:"0px 40px"},className:"d-flex align-items-center gap-5 mb-3",children:[e.jsx(B,{label:"Diri Sendiri",value:"diri_sendiri",fieldName:"jenis_permohonan",formik:a,type:"radio"},`diri_sendiri-${a.values.jenis_permohonan}`),e.jsx(B,{label:"Orang Lain",value:"orang_lain",fieldName:"jenis_permohonan",formik:a,type:"radio"},`orang_lain-${a.values.jenis_permohonan}`)]}),e.jsxs(l,{xs:"12",children:[a.values.jenis_permohonan=="orang_lain"&&e.jsx(qe,{formik:a,disabled:n,country:x.negara,dropdown:x}),e.jsx(Ee,{formik:a,disabled:n,dropdown:x})]})]}),e.jsxs($,{className:"mt-4",children:[e.jsx(l,{xs:"12",md:"12",children:e.jsxs(q,{className:"d-flex align-items-center justify-content-between",sx:{backgroundColor:"#EFF7FF",padding:1,borderRadius:2,mb:2},children:[e.jsx(ye,{sx:{color:"#041662",fontSize:"14px",px:0,fontFamily:"Poppins"},className:"fw-semibold",children:"Data Dokumen"}),!n&&e.jsx(Ae,{formik:a,open:r,setOpen:g,setDataDocuments:k,dataDocuments:S,dropdown:x})]})}),e.jsx(l,{xs:"12",md:"12",lg:"12",xl:"12",className:"px-3",children:e.jsx(Ke,{data:(d=(i=a.values)==null?void 0:i.data_document)==null?void 0:d.filter(c=>(c==null?void 0:c.nomor_dokumen)&&c.nomor_dokumen.trim()!==""),formik:a,showSelect:!1,setOpen:g,setDataDocuments:k})})]})]})})},Ve=[["nama_perseroan","voucher"],["checked"],["checked"],["checked"],["checked"]],Re=({label:a="Pendaftaran Pendirian"})=>{var A;const{state:n}=Ne(),[r,g]=w.useState(0),[S,k]=w.useState(new Set),x=s=>S.has(s),u=new W,t=ve(),i=ke({initialValues:{data_document:[{tipe_dokumen:"dokumen_konvesional",nomor_dokumen:"",nama_dokumen:"",nama_tercantum:"",jumlah_halaman:"",tanggal_dokumen:"",tempat_cetak:"",instansi:"",nama_pejabat:"",jabatan_pejabat:"",berkas:[]}],berkas:[],jenis_permohonan:"",tempat_lahir_pemohon:"dalam_negeri"},enableReinitialize:!0,onSubmit:s=>{d(s)}}),d=s=>{u.confirmationCreate().then(_=>{if(_){u.showLoading();const{data_document:N,...o}=s,p={...o,id_jenis_dokumen:Number(o.id_jenis_dokumen),id_kab_kota_lahir_pemohon:Number(o.id_kab_kota_lahir_pemohon),id_negara:Number(o.id_negara),id_negara_lahir_pemohon:Number(o.id_negara_lahir_pemohon),id_provinsi_lahir_pemohon:Number(o.id_provinsi_lahir_pemohon)},L=Object.fromEntries(Object.entries(p).filter(([T])=>!T.startsWith("rules")&&!T.endsWith("_nama")));console.log("filteredPayload",R(L)),M(Q,R(L)).then(()=>{J("success"),V.close(),t("/apostille")}).catch(T=>{U(T),console.log("err",T),V.close()})}})},c=s=>{u.confirmationUpdate().then(_=>{if(_){u.showLoading();const{data_document:N,id_permohonan:o,...p}=s,L={...p,id_jenis_dokumen:Number(p.id_jenis_dokumen),id_kab_kota_lahir_pemohon:Number(p.id_kab_kota_lahir_pemohon),id_negara:Number(p.id_negara),id_negara_lahir_pemohon:Number(p.id_negara_lahir_pemohon),id_provinsi_lahir_pemohon:Number(p.id_provinsi_lahir_pemohon)},T=Object.fromEntries(Object.entries(L).filter(([K])=>!K.startsWith("rules")&&!K.endsWith("_nama")));console.log("filteredPayload",R(T)),$e(`${Q}/${n==null?void 0:n.id}`,R(T)).then(()=>{J("success"),V.close(),t("/apostille")}).catch(K=>{U(K),console.log("err",K),V.close()})}})};w.useEffect(()=>{g(0),i.resetForm()},[a]);const f=()=>{const s=Ve[r];i.validateForm().then(_=>{const N=s.reduce((o,p)=>(_[p]&&(o[p]=_[p]),o),{});Object.keys(N).length===0?(g(o=>o+1),k(o=>{const p=new Set(o.values());return p.delete(r),p})):i.setTouched({...i.touched,...s.reduce((o,p)=>(o[p]=!0,o),{})})})},b=async(s,_)=>{if(_){const{id_voucher:o,created_by:p,updated_by:L,...T}=i.values,K={...T,status_permohonan:s};(n==null?void 0:n.type)=="update"?c(K):d(K),console.log("Submit draft tanpa validasi");return}const N=await i.validateForm();if(Object.keys(N).length===0)if((n==null?void 0:n.type)=="update"){const o={...i.values,status_permohonan:s};c(o)}else await i.setFieldValue("status_permohonan",s),await i.submitForm(),console.log("Submit final");else{const o=Object.keys(N).reduce((p,L)=>(p[L]=!0,p),{});i.setTouched(o,!0)}},h=[{id:"1",label:"Boarding",component:e.jsx(Le,{formik:i,setActiveStep:g,label:"Pendaftaran Permohonan Legalisasi Dokumen"})},{id:"2",label:"Identitas Diri",stepNumber:"Langkah 1",component:e.jsx(Oe,{formik:i,label:a})},{id:"3",label:"Konfirmasi Data",stepNumber:"Langkah 2"}],C={"Pendaftaran Pendirian":["1","2","3","4","5","6"]};console.log("formik",i.values);const D=()=>{Pe(n==null?void 0:n.id).then(s=>{const _=s.data,{no_permohonan:N,data_dokumen:o,tanggal_lahir_pemohon:p,...L}=_;i.setValues({...L,data_document:_.data_dokumen,tanggal_lahir_pemohon:Te(_==null?void 0:_.tanggal_lahir_pemohon,"YYYY-MM-DD")}),u.close()}).catch(s=>{(s==null?void 0:s.status)==500?u.info(s==null?void 0:s.message):(console.log("err",s),u.close())})};w.useEffect(()=>{n!=null&&n.id&&(n==null?void 0:n.type)=="update"&&(g(1),D())},[n==null?void 0:n.id,n==null?void 0:n.type]);const j=C[a]||[],m=h.filter(s=>j.includes(s.id)),v=m.filter(s=>s.stepNumber),P=v.findIndex(s=>{var _;return s.id===((_=m[r])==null?void 0:_.id)}),F=()=>{g(s=>s-1)};return e.jsxs(q,{className:"bg-white page-content mb-4",sx:{width:"100%"},children:[v.length>0&&P>=0&&e.jsx(fe,{activeStep:P,children:v.map((s,_)=>{const N={};return x(_)&&(N.completed=!1),e.jsx(De,{...N,children:e.jsx(we,{StepIconComponent:({active:o,completed:p})=>e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",border:"1px solid #E7E7E7",backgroundColor:o||p?"#041662":"#fff",display:"flex",alignItems:"center",justifyContent:"center",color:o||p?"#fff":"#041662"},children:_+1}),children:e.jsx("span",{style:{fontFamily:"Poppins",fontWeight:400,fontSize:"12px",lineHeight:"18px",color:"#888888"},children:s.label})})},s.id)})}),e.jsxs(Se.Fragment,{children:[r==m.length-1?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{formik:i})," "]}):e.jsx(q,{sx:{mt:2},children:((A=m[r])==null?void 0:A.component)||"Unknown step"}),r>=1&&e.jsxs(q,{sx:{display:"flex",flexDirection:"row",pt:2,px:2},children:[e.jsx(H,{disabled:r===0||(n==null?void 0:n.type)=="update",onClick:F,sx:{mr:1,backgroundColor:"#e5e7eb",color:"#000",px:2,py:1,textTransform:"initial",fontFamily:"Poppins","&:hover":{backgroundColor:"#d1d5db",color:"#000"}},children:"Kembali"}),e.jsx(q,{sx:{flex:"1 1 auto"}}),e.jsxs("div",{className:"d-flex gap-2",children:[a!=="Pembubaran Data"&&e.jsx(H,{onClick:()=>b("Draft",!0),sx:{backgroundColor:"#f97316",color:"#fff",px:2,py:1,fontFamily:"Poppins",textTransform:"initial","&:hover":{backgroundColor:"#ea580c",color:"#fff"}},children:"Draft"}),e.jsxs(H,{onClick:()=>{r===m.length-1?b("Dikirim"):f()},sx:{mr:1,backgroundColor:"#041662",color:"#fff",border:"1px solid grey",px:2,py:1,fontFamily:"Poppins","&:hover":{backgroundColor:"#041992",color:"#fff"},textTransform:"initial"},children:[r===m.length-1?"Selesai":"Selanjutnya",e.jsx(Fe,{fontSize:"14"})]})]})]})]})]})};export{Re as default};
