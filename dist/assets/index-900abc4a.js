import{j as e,aG as f,b8 as C,r as l,c6 as J,a as U,bQ as G,bn as H,bf as O,cy as W,cz as q,cA as K,cB as Q,aw as Z,ax as V,ay as k,az as B,aA as X,cC as Y,T as ee,C as ae,b as M,c as T}from"./index-d70a1868.js";import{C as A}from"./Card-14c6cb3a.js";import{C as R}from"./CardContent-c04a0e6c.js";import{C as N}from"./auto-f5c48c80.js";const te=({title:a,value:t,color:r})=>e.jsx(A,{sx:{width:"100%",height:"100%",border:"1px solid #E7E7E7",borderRadius:"8px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(R,{children:e.jsx(f,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{borderLeft:`3px solid ${r}`},children:e.jsxs(f,{sx:{width:"100%",paddingLeft:3},children:[e.jsx(C,{variant:"subtitle2",color:"",sx:{fontSize:"16px",fontWeight:500,fontFamily:"Poppins",borderBottom:"2px solid #E7E7E7",paddingBottom:1,color:"#262626"},children:a}),e.jsx(C,{variant:"h5",sx:{fontWeight:400,color:"#262626",mt:1,fontFamily:"Poppins",fontSize:"24px"},children:t})]})})})}),re=({fragments:a})=>e.jsx(f,{sx:{display:"flex",gap:2,flexWrap:"wrap",mb:3},children:a.map((t,r)=>e.jsx(f,{sx:{width:{xs:"100%",sm:"45%",md:"45%",lg:"23%"}},children:e.jsx(te,{...t})},r))}),ne=[{title:"Total Permohonan",value:"4.680",color:"#60AAFA"},{title:"Total Belum Verifikasi",value:"4.680",color:"#F2933D"},{title:"Total Disetujui",value:"4.680",color:"#51B67D"},{title:"Total Ditolak",value:"4.680",color:"#EE7D7B"}],$={labels:["Jan","Feb","Mar","Apr","May","Jun"],data:[12e3,19e3,15e3,18e3,21e3,24e3]},I={labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Okt","Nov","Des"],datasets:[{label:"Disetujui",data:[50,100,150,200,150,50,100,200,100,150,300,100],borderColor:"#1F7C4D",backgroundColor:"#fff",tension:.4},{label:"Ditolak",data:[10,20,50,60,100,50,200,150,75,90,10,100,20],borderColor:"#CF3533",backgroundColor:"#FDF3F3",tension:.4}]},se=[{id:"no",label:"No"},{id:"nama_lengkap",label:"Nama Lengkap"},{id:"negara_asal",label:"Negara Asal"},{id:"tanggal_permohonan",label:"Tanggal Permohonan"}],oe=({title:a,data:t,labels:r,backgroundColor:h="rgba(54, 162, 235, 0.6)",borderColor:p="rgba(54, 162, 235, 1)",borderWidth:x=1,maintainAspectRatio:s=!0,aspectRatio:c=2})=>{const u=l.useRef(null),o=l.useRef(null);return l.useEffect(()=>{if(u.current){o.current&&o.current.destroy();const n=u.current.getContext("2d");o.current=new N(n,{type:"bar",data:{labels:r,datasets:[{label:a,data:t,backgroundColor:h,borderColor:p,borderWidth:x}]},options:{responsive:!0,maintainAspectRatio:s,aspectRatio:c,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(g){return`${g.dataset.label}: ${g.raw}`}}}},scales:{y:{beginAtZero:!0,grid:{drawBorder:!1,color:"rgba(0, 0, 0, 0.05)"},ticks:{stepSize:Math.ceil(Math.max(...t)/5)}},x:{grid:{display:!1,drawBorder:!1}}}}})}return()=>{o.current&&o.current.destroy()}},[t,r,a,h,p,x,s,c]),e.jsx(A,{sx:{width:"100%",height:"100%",border:"1px solid #E7E7E7",borderRadius:"8px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.05)",p:2},children:e.jsxs(R,{children:[e.jsx(f,{sx:{borderBottom:"1px solid #E7E7E7",marginBottom:3},children:e.jsx(C,{variant:"h6",gutterBottom:!0,sx:{color:"#202020",fontFamily:"Poppins",fontSize:"16px"},children:a})}),e.jsx("div",{style:{position:"relative",height:"300px"},children:e.jsx("canvas",{ref:u})})]})})},le=({title:a,data:t,labels:r,datasets:h=null,backgroundColor:p="rgba(54, 162, 235, 0.2)",borderColor:x="rgba(54, 162, 235, 1)",borderWidth:s=2,pointBackgroundColor:c="rgba(54, 162, 235, 1)",pointRadius:u=4,pointHoverRadius:o=6,fill:n=!1,tension:g=.4,maintainAspectRatio:m=!0,aspectRatio:i=2,showLegend:y=!1,yAxisTitle:b="",xAxisTitle:P=""})=>{const D=l.useRef(null),j=l.useRef(null);return l.useEffect(()=>{if(D.current){j.current&&j.current.destroy();const F=D.current.getContext("2d"),S=h||[{label:a,data:t,backgroundColor:p,borderColor:x,borderWidth:s,pointBackgroundColor:c,pointRadius:u,pointHoverRadius:o,fill:n,tension:g}];j.current=new N(F,{type:"line",data:{labels:r,datasets:S},options:{responsive:!0,maintainAspectRatio:m,aspectRatio:i,plugins:{legend:{display:y,position:"bottom"},tooltip:{callbacks:{label:function(v){return`${v.dataset.label}: ${v.raw}`}}},title:{display:!1}},scales:{y:{beginAtZero:!1,title:{display:!!b,text:b},grid:{drawBorder:!1,color:"rgba(0, 0, 0, 0.05)"}},x:{title:{display:!!P,text:P},grid:{display:!1,drawBorder:!1}}},interaction:{intersect:!1,mode:"index"}}})}return()=>{j.current&&j.current.destroy()}},[t,r,a,p,x,s,c,u,o,n,g,m,i,y,b,P,h]),e.jsx(A,{sx:{width:"100%",height:"100%",border:"1px solid #E7E7E7",borderRadius:"8px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.05)",p:2},children:e.jsxs(R,{children:[e.jsx(f,{sx:{borderBottom:"1px solid #E7E7E7",marginBottom:3},children:e.jsx(C,{variant:"h6",gutterBottom:!0,sx:{color:"#202020",fontFamily:"Poppins",fontSize:"16px"},children:a})}),e.jsx("div",{style:{position:"relative",height:"auto",width:"100%"},children:e.jsx("canvas",{ref:D})})]})})},ie={riwayatPermohonan:"/pewarganegaraan/permohonan/riwayat",detailPermohonan:"/pewarganegaraan/permohonan/",skPermohonan:"/pewarganegaraan/permohonan/sk"},de=a=>{if(!a||typeof a!="object")return"";const t=Object.keys(a).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(a[r])}`).join("&");return t?`?${t}`:""},ce=(a={page:1,limit:10})=>{const t=de(a);return J(`${ie.riwayatPermohonan}${t}`)},z={currentPage:1,totalPage:1,totalData:0},pe=(a={page:1,limit:10})=>{const[t,r]=l.useState([]),[h,p]=l.useState(!0),[x,s]=l.useState(null),[c,u]=l.useState(z);return l.useEffect(()=>{const o=new AbortController;return(async()=>{p(!0),s(null);try{const n=await ce(a,{signal:o.signal});r((n==null?void 0:n.data)||[]),u((n==null?void 0:n.pagination)||z)}catch(n){n.name!=="AbortError"&&(s(n),r([]))}finally{p(!1)}})(),()=>o.abort()},[a.page,a.limit]),{data:t,loading:h,error:x,pagination:c,totalItems:c.totalData}},xe=({title:a,columns:t,data:r=[],totalItems:h=0,currentPage:p=1,itemsPerPage:x=10,enableSearch:s=!0,searchPlaceholder:c="Cari...",searchKeys:u=[],enablePagination:o=!0,emptyMessage:n="Tidak ada data yang ditemukan.",url:g="",topBarAction:m,onPageChange:i,onSearch:y,loading:b=!1})=>{const P=U(),[D,j]=l.useState(""),F=new ee,S=(d,E)=>{i==null||i(E)},v=d=>{const E=d.target.value;j(E),y==null||y(E)},_=Math.ceil(h/x);return e.jsxs(f,{sx:{p:3,border:"1px solid #E7E7E7",borderRadius:"8px"},children:[a&&e.jsx(C,{sx:{fontWeight:500,fontSize:"18px",lineHeight:"24px",color:"#202020",fontFamily:"Poppins"},children:a}),e.jsx(G,{sx:{my:2,color:"#E7E7E7"}}),(s||m)&&e.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[s&&e.jsx(H,{placeholder:c,value:D,onChange:v,disabled:b,InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(W,{sx:{color:"#9E9E9E"}})}),sx:{height:38,width:300,borderRadius:"8px","& fieldset":{borderColor:"#E7E7E7"},"&:hover fieldset":{borderColor:"#E7E7E7"},"&.Mui-focused fieldset":{borderColor:"#E7E7E7"}}},sx:{"& .MuiInputBase-input":{fontFamily:"Poppins",fontSize:"14px"}}}),m&&e.jsx(f,{children:m})]}),e.jsxs(q,{sx:{border:"1px solid #E7E7E7",borderRadius:"8px",position:"relative",minHeight:200},children:[b&&e.jsxs(K,{sx:{position:"absolute",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1,borderRadius:"8px",display:"flex",flexDirection:"column",gap:1},open:b,children:[e.jsx(Q,{color:"primary"}),e.jsx(C,{variant:"body2",color:"text.secondary",children:"Memuat data..."})]}),e.jsxs(Z,{children:[e.jsx(V,{sx:{backgroundColor:"#F7F7F7"},children:e.jsx(k,{children:t.map(d=>e.jsx(B,{align:d.align||"left",sx:{fontWeight:500,fontFamily:"Poppins",fontSize:"14px",color:"#5D5D5D",lineHeight:"22px",padding:2},children:d.label},d.id))})}),e.jsx(X,{children:r.length>0?r.map((d,E)=>e.jsx(k,{sx:{cursor:"pointer","&:hover":{backgroundColor:"#FAFAFA"}},children:t.map(w=>e.jsx(B,{onClick:L=>{console.log(g),!L.target.closest("button")&&(console.log(d),g?P(`${g}/${d.id_permohonan}`):F.info("URL Tidak ada"))},align:w.align||"left",sx:{fontFamily:"Poppins",fontSize:"12px",color:"#4F4F4F"},children:w.renderCell?w.renderCell(d[w.id],d):d[w.id]},`${d.id||E}-${w.id}`))},d.id||E)):e.jsx(k,{children:e.jsx(B,{colSpan:t.length,sx:{textAlign:"center",py:4},children:e.jsx(C,{variant:"body2",color:"text.secondary",children:!b&&n})})})})]})]}),o&&_>1&&e.jsx(f,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(Y,{count:_,page:p,onChange:S,color:"primary",disabled:b})})]})},me=()=>{const[a,t]=l.useState(1),[r,h]=l.useState(5),[p,x]=l.useState(""),{data:s,loading:c,error:u,pagination:o}=pe({page:a,limit:r});console.log(s);const n=(s==null?void 0:s.map((i,y)=>({no:(a-1)*r+y+1,nama_lengkap:i.nama_lengkap_pemohon,negara_asal:i.kewarganegaraan_asal_pemohon_text||"-",tanggal_permohonan:new Date(i.created_at).toLocaleDateString("id-ID")})))||[],g=i=>{t(i)},m=i=>{x(i),t(1)};return e.jsxs(ae,{className:"page-content bg-white",fluid:!0,children:[e.jsx(re,{fragments:ne}),e.jsxs(M,{style:{marginTop:"20px"},children:[e.jsx(T,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:e.jsx(oe,{title:"Monthly Sales",data:$.data,labels:$.labels,backgroundColor:"#93C9FD"})}),e.jsx(T,{xs:"12",sm:"12",md:"12",lg:"6",xl:"6",children:e.jsx(xe,{data:n,totalItems:o.totalData,currentPage:a,itemsPerPage:r,title:"Riwayat Permohonan",columns:se,enableSearch:!0,searchKeys:["nama_lengkap","negara_asal"],enablePagination:!0,emptyMessage:"Tidak ada permohonan yang cocok dengan pencarian Anda.",onPageChange:g,onSearch:m,loading:c})})]}),e.jsx(M,{style:{marginTop:"20px"},children:e.jsx(T,{xs:12,children:e.jsx(le,{title:"Grafik Permohonan",labels:I.labels,datasets:I.datasets,showLegend:!0,yAxisTitle:"Number of Users"})})})]})};export{me as default};
